Significance: minor
Type: other

Refactored to improve testability. No functionality is affected.
