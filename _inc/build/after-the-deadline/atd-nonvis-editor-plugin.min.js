/* Do not modify this file directly. It is compiled from other files. */
/* jshint devel: true, onevar: false, smarttabs: true */
/* global AtD, QTags, AtD_l10n_r0ar, edButtons, edButton, switchEditors, AtD_unbind_proofreader_listeners */
/* exported AtD_unbind_proofreader_listeners */
var AtD_qtbutton,autosave;function AtD_restore_text_area(){var t;jQuery("#atd-content").get(0)?(AtD.remove("atd-content"),t=jQuery("#atd-content").html()):(AtD.remove("content"),t=jQuery("#content").html()),"Microsoft Internet Explorer"===navigator.appName&&(t=t.replace(/<BR.*?class.*?atd_remove_me.*?>/gi,"\n")),void 0!==window.twemoji&&(t=t.replace(/<img [^>]+>/g,function(t){if(-1!==t.indexOf("emoji")){var e=t.match(/alt="([^"]+)"/);if(e&&e[1]&&window.twemoji.test(e[1]))return e[1]}return t})),jQuery("#content").val(t.replace(/\&lt\;/g,"<").replace(/\&gt\;/g,">").replace(/\&amp;/g,"&")).height(AtD.height).show(),jQuery("#atd-content").remove(),AtD_qtbutton&&(jQuery(AtD_qtbutton).val(AtD.getLang("button_proofread","proofread")),jQuery(AtD_qtbutton).css({color:"#464646"}),jQuery(AtD_qtbutton).siblings("input").andSelf().attr("disabled",!1)),void 0!==AtD.autosave&&(window.wp&&window.wp.autosave&&window.wp.autosave.server?(window.wp.autosave.local.resume&&window.wp.autosave.local.resume(),window.wp.autosave.server.resume&&window.wp.autosave.server.resume()):autosave=AtD.autosave)}function AtD_restore_if_proofreading(){AtD_qtbutton&&jQuery(AtD_qtbutton).val()===AtD.getLang("button_edit_text","edit text")&&AtD_restore_text_area()}function AtD_unbind_proofreader_listeners(){jQuery("#save-post, #post-preview, #publish, #edButtonPreview").unbind("focus",AtD_restore_if_proofreading),jQuery("#add_poll, #add_image, #add_video, #add_audio, #add_media").unbind("click",AtD_restore_if_proofreading),jQuery("#post").unbind("submit",AtD_restore_if_proofreading)}function AtD_bind_proofreader_listeners(){jQuery("#save-post, #post-preview, #publish, #edButtonPreview").focus(AtD_restore_if_proofreading),jQuery("#add_poll, #add_image, #add_video, #add_audio, #add_media").click(AtD_restore_if_proofreading),jQuery("#post").submit(AtD_restore_if_proofreading)}function AtD_check(t){var e,o;if(jQuery.isFunction(t)?(e=t,AtD_qtbutton||(AtD_qtbutton=jQuery("#qt_content_AtD, #ed_AtD").get(0))):(t.id||(t=t[0]),AtD_qtbutton=t),!jQuery("#content").length)return void 0!==e&&e(0),void AtD_restore_if_proofreading();if(jQuery(AtD_qtbutton).val()===AtD.getLang("button_edit_text","edit text"))AtD_restore_text_area();else{window.editorExpand&&jQuery("#postdivrich").hasClass("wp-editor-expand")?AtD.wpEditorExpand=!0:AtD.wpEditorExpand=!1,AtD.height?AtD.height=jQuery("#content").height():(AtD.height=jQuery("#content").height(),AtD_bind_proofreader_listeners(),jQuery("#edButtonPreview").attr("onclick",null).click(function(){AtD_restore_if_proofreading(),switchEditors.go("content","tinymce")}),AtD.content_canvas=jQuery("#content"),AtD.autosave=autosave),jQuery(AtD_qtbutton).css({color:"red"}).val(AtD.getLang("button_edit_text","edit text")).attr("disabled",!0);var r,n=jQuery("#content"),a=n.val().replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/\>/g,"&gt;"),i=n.css("font-family"),d=n.css("font-size"),u=n.css("line-height");"Microsoft Internet Explorer"===navigator.appName&&(a=a.replace(/[\n\r\f]/gm,'<BR class="atd_remove_me">')),r=jQuery('<div class="input" id="atd-content">'+a+"</div>"),n.after(r).hide(),(o=AtD.height)<200?o=200:o>1e3&&(o=1e3);var s=jQuery("#ed_toolbar").height();r.css({overflow:"auto","background-color":"white",color:"black","white-space":"pre-wrap",padding:"10px","font-family":i||"Consolas, Monaco, monospace","font-size":d||"13px","line-height":u||"1.5",height:o,"margin-top":s+7+"px"}),window.wp&&window.wp.autosave&&window.wp.autosave.server?(window.wp.autosave.local.suspend&&window.wp.autosave.local.suspend(),window.wp.autosave.server.suspend&&window.wp.autosave.server.suspend()):autosave=function(){},jQuery(AtD_qtbutton).siblings("input").andSelf().attr("disabled",!0),AtD.check("atd-content",{success:function(t){0===Number(t)&&"function"!=typeof e&&alert(AtD.getLang("message_no_errors_found","No writing errors were found")),AtD_restore_if_proofreading()},ready:function(t){jQuery(AtD_qtbutton).attr("disabled",!1),"function"==typeof e&&e(t)},error:function(){jQuery(AtD_qtbutton).attr("disabled",!1),"function"==typeof e?e(-1):alert(AtD.getLang("message_server_error","There was a problem communicating with the Proofreading service. Try again in one minute.")),AtD_restore_if_proofreading()},editSelection:function(t){var e=prompt(AtD.getLang("dialog_replace_selection","Replace selection with:"),t.text());null!=e&&t.replaceWith(e)},explain:function(t){var e=screen.width/2-240,o=screen.height/2-190;window.open(t,"","width=480,height=380,toolbar=0,status=0,resizable=0,location=0,menuBar=0,left="+e+",top="+o).focus()},ignore:function(t){jQuery.ajax({type:"GET",url:AtD.rpc_ignore+encodeURI(t).replace(/&/g,"%26"),format:"raw",error:function(t,e,o){void 0!==AtD.callback_f&&void 0!==AtD.callback_f.error&&AtD.callback_f.error(e+": "+o)}})}})}}"undefined"!=typeof QTags&&QTags.addButton?jQuery(document).ready(function(){QTags.addButton("AtD",AtD_l10n_r0ar.button_proofread,AtD_check)}):(edButtons[edButtons.length]=new edButton("ed_AtD","AtD","","",""),jQuery(document).ready(function(t){t("#ed_AtD").replaceWith('<input type="button" id="ed_AtD" accesskey="" class="ed_button" onclick="AtD_check(this);" value="'+AtD_l10n_r0ar.button_proofread+'" />')}));