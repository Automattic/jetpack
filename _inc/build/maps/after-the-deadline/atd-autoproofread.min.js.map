{"version":3,"sources":["after-the-deadline/atd-autoproofread.js"],"names":["AtD_submit_check","e","AtD_proofread_click_count","stopImmediatePropagation","preventDefault","tinyMCE","activeEditor","isHidden","execCommand","AtD_submit_check_callback","AtD_restore_if_proofreading","AtD_check","count","Number","AtD_unbind_proofreader_listeners","AtD_update_post","alert","AtD","getLang","message","original_post_status","jQuery","val","confirm","AtD_bind_proofreader_listeners","AtD_kill_autoproofread","removeClass","hide","unbind","click","document","ready","$","orig_status","AtD_check_when","length","onpublish","onupdate","bind"],"mappings":";;;;;AAUA,QAASA,kBAAkBC,GAEtBC,0BAA4B,IAKhCD,EAAEE,2BACFF,EAAEG,iBAGuB,mBAAd,UAA6BC,QAAQC,eAAiBD,QAAQC,aAAaC,WAErFF,QAAQC,aAAaE,YAAY,4BAA6BC,4BAG9DC,8BACAC,UAAWF,6BAKb,QAASA,2BAA0BG,GAIlC,GAHAA,EAAQC,OAAQD,GAAS,GACzBE,mCAEK,IAAMF,GAAS,EAAIV,0BAEvBa,sBACM,KAAM,IAAMH,EAElBI,MAAOC,IAAIC,QAAQ,uBAAwB,8FAC3CH,sBACM,CACN,GAGII,GAHAC,EAAuBC,OAAO,yBAAyBC,KAK1DH,GAD6B,YAAzBC,EACMH,IAAIC,QAAQ,8BAA+B,+KAE3CD,IAAIC,QAAQ,6BAA8B,6KAGhDK,QAASJ,GACbJ,mBAEAS,iCACAC,0BAIDJ,OAAO,YAAYK,YAAY,2BAC/BL,OAAO,iBAAiBM,QAK1B,QAASF,0BACRJ,OAAO,YAAYO,OAAO,0BAI3B,QAASb,mBAEiB,mBAAd,UAA8BV,QAAQC,eAAgBD,QAAQC,aAAaC,YACrFG,8BAGDW,OAAO,YAAYO,OAAO,0BAA0BC,QAxErD,GAAI3B,2BAA4B,CA4EhCmB,QAAQS,UAAWC,MAAO,SAASC,GAClC,GAAIC,GAAcD,EAAE,yBAAyBV,KAGd,oBAAnBY,iBAAkCF,EAAE,YAAYG,SACvC,YAAhBF,GAA6BC,eAAeE,YAC5B,YAAhBH,GAA6C,aAAhBA,IAAgCC,eAAeG,WAC/EL,EAAE,YAAYM,KAAM,yBAA0BtC","file":"../../after-the-deadline/atd-autoproofread.min.js","sourcesContent":["/* Do not modify this file directly. It is compiled from other files. */\n/* jshint devel: true, onevar: false */\n/* global tinyMCE, AtD_restore_if_proofreading, AtD_check, AtD_unbind_proofreader_listeners,\n          AtD, AtD_bind_proofreader_listeners, AtD_check_when\n */\n\n/* the AtD/jQuery and AtD/TinyMCE plugins check if this variable exists and increment it when a proofread check happens */\nvar AtD_proofread_click_count = 0;\n\n/* This is function called when the publish/update button is pressed */\nfunction AtD_submit_check( e ) {\n\t/* User has already checked their document... no need to hold up their submit */\n\tif (AtD_proofread_click_count > 0) {\n\t\treturn;\n\t}\n\n\t/* Let's not submit the form, shall we? */\n\te.stopImmediatePropagation();\n\te.preventDefault();\n\n\t/* We'll call the AtD function based on which editor is currently active */\n\tif ( typeof(tinyMCE) !== 'undefined' && tinyMCE.activeEditor && !tinyMCE.activeEditor.isHidden() ) {\n\t\t/* Woo! We're running tinyMCE! */\n\t\ttinyMCE.activeEditor.execCommand('mceWritingImprovementTool', AtD_submit_check_callback);\n\t} else {\n\t\t/* Go Go HTML editor! */\n\t\tAtD_restore_if_proofreading();\n\t\tAtD_check( AtD_submit_check_callback );\n\t}\n}\n\n/* This is the callback function that runs after the publish/update button is pressed */\nfunction AtD_submit_check_callback(count) {\n\tcount = Number( count || 0 );\n\tAtD_unbind_proofreader_listeners();\n\n\tif ( 0 === count || 1 < AtD_proofread_click_count ) {\n\t\t/* if no errors were found, submit form */\n\t\tAtD_update_post();\n\t} else if ( -1 === count ) {\n\t\t/* If there was an error, alert the user and submit form */\n\t\talert( AtD.getLang('message_server_error', 'There was a problem communicating with the Proofreading service. Try again in one minute.') );\n\t\tAtD_update_post();\n\t} else {\n\t\tvar original_post_status = jQuery('#original_post_status').val();\n\n\t\t/* Okay, the user has tried to publish/update already but there are still errors. Ask them what to do */\n\t\tvar message;\n\t\tif ( original_post_status === 'publish' ) {\n\t\t\tmessage = AtD.getLang('dialog_confirm_post_publish', 'The proofreader has suggestions for this post. Are you sure you want to publish it?\\n\\nPress OK to publish your post, or Cancel to view the suggestions and edit your post.');\n\t\t} else {\n\t\t\tmessage = AtD.getLang('dialog_confirm_post_update', 'The proofreader has suggestions for this post. Are you sure you want to update it?\\n\\nPress OK to update your post, or Cancel to view the suggestions and edit your post.');\n\t\t}\n\n\t\tif ( confirm( message ) ) {\n\t\t\tAtD_update_post();\n\t\t} else {\n\t\t\tAtD_bind_proofreader_listeners();\n\t\t\tAtD_kill_autoproofread();\n\t\t}\n\n\t\t/* Let's do some interface clean-up */\n\t\tjQuery('#publish').removeClass('button-primary-disabled');\n\t\tjQuery('#ajax-loading').hide();\n\t}\n}\n\n/* Stop the proofreader from doing its auto proofread thing (activated when the proofread button is clicked) */\nfunction AtD_kill_autoproofread() {\n\tjQuery('#publish').unbind('click.AtD_submit_check');\n}\n\n/* a function to force the post to be submitted */\nfunction AtD_update_post() {\n\n\tif ( typeof(tinyMCE) === 'undefined' || !tinyMCE.activeEditor || tinyMCE.activeEditor.isHidden() ) {\n\t\tAtD_restore_if_proofreading();\n\t}\n\n\tjQuery('#publish').unbind('click.AtD_submit_check').click();\n}\n\n/* init the autoproofread options */\njQuery( document ).ready( function($){\n\tvar orig_status = $('#original_post_status').val();\n\n\t/* check if auto-check is enabled && if #content exists */\n\tif ( typeof AtD_check_when !== 'undefined' && $('#content').length &&\n\t\t( ( orig_status !== 'publish' && AtD_check_when.onpublish ) ||\n\t\t( ( orig_status === 'publish' || orig_status === 'schedule' ) && AtD_check_when.onupdate ) ) ) {\n\t\t\t$('#publish').bind( 'click.AtD_submit_check', AtD_submit_check );\n\t}\n});\n\n"]}