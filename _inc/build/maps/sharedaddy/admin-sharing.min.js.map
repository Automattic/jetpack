{"version":3,"sources":["sharedaddy/admin-sharing.js"],"names":["$","document","ready","enable_share_button","unbind","hover","this","data","item","original","parents","timer","setTimeout","css","left","position","top","height","slideDown","mouseleave","handler_item_leave","mouseenter","handler_item_enter","handler_original_leave","handler_original_enter","click","close_it","clearTimeout","slideUp","update_preview","button_style","val","remove","append","clone","each","hasClass","service","attr","parent","removeClass","html","addClass","find","showExtraOptions","jQuery","backgroundColor","fadeIn","hideExtraOptions","fadeOut","save_services","show","length","hide","visible","hidden","join","ajaxSubmit","keyboardChangeOrder","$this","dir","thisService","thisParent","thisParentsChildren","thisPosition","index","totalChildren","prevSibling","prev","detach","before","focus","nextSibling","next","after","keyboardDragDrop","dropzone","prepend","window","sharing_option_changed","sharing_loading_icon","response","indexOf","button","substring","preview","is","replaceWith","removeAttr","sortable","receive","stop","enableSelection","over","out","helper","event","ui","start","disableSelection","placeholder","opacity","delay","forcePlaceholderSize","items","connectWith","cancel","cursor","on","e","keyCode","preventDefault","toggle","ajaxForm","beforeSubmit","prop","success","location","reload","change","blur","text","form"],"mappings":"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","file":"../../sharedaddy/admin-sharing.min.js","sourcesContent":["/* Do not modify this file directly. It is compiled from other files. */\n/* jshint onevar: false, smarttabs: true */\n/* global sharing_loading_icon */\n\n(function($) {\n\t$( document ).ready(function() {\n\t\tfunction enable_share_button() {\n\t\t\t$( '.preview a.sharing-anchor' ).unbind( 'mouseenter mouseenter' ).hover( function() {\n\t\t\t\tif ( $( this ).data( 'hasappeared' ) !== true ) {\n\t\t\t\t\tvar item     = $( '.sharing-hidden .inner' );\n\t\t\t\t\tvar original = $( this ).parents( 'li' );\n\n\t\t\t\t\t// Create a timer to make the area appear if the mouse hovers for a period\n\t\t\t\t\tvar timer = setTimeout( function() {\n\t\t\t\t\t\t$( item ).css( {\n\t\t\t\t\t\t\tleft: $( original ).position().left + 'px',\n\t\t\t\t\t\t\ttop: $( original ).position().top + $( original ).height() + 3 + 'px'\n\t\t\t\t\t\t} ).slideDown( 200, function() {\n\t\t\t\t\t\t\t// Mark the item as have being appeared by the hover\n\t\t\t\t\t\t\t$( original ).data( 'hasappeared', true ).data( 'hasoriginal', true ).data( 'hasitem', false );\n\n\t\t\t\t\t\t\t// Remove all special handlers\n\t\t\t\t\t\t\t$( item ).mouseleave( handler_item_leave ).mouseenter( handler_item_enter );\n\t\t\t\t\t\t\t$( original ).mouseleave( handler_original_leave ).mouseenter( handler_original_enter );\n\n\t\t\t\t\t\t\t// Add a special handler to quickly close the item\n\t\t\t\t\t\t\t$( original ).click( close_it );\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t// The following handlers take care of the mouseenter/mouseleave for the share button and the share area - if both are left then we close the share area\n\t\t\t\t\t\tvar handler_item_leave = function() {\n\t\t\t\t\t\t\t$( original ).data( 'hasitem', false );\n\n\t\t\t\t\t\t\tif ( $( original ).data( 'hasoriginal' ) === false ) {\n\t\t\t\t\t\t\t\tvar timer = setTimeout( close_it, 800 );\n\t\t\t\t\t\t\t\t$( original ).data( 'timer2', timer );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tvar handler_item_enter = function() {\n\t\t\t\t\t\t\t$( original ).data( 'hasitem', true );\n\t\t\t\t\t\t\tclearTimeout( $( original ).data( 'timer2' ) );\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tvar handler_original_leave = function() {\n\t\t\t\t\t\t\t$( original ).data( 'hasoriginal', false );\n\n\t\t\t\t\t\t\tif ( $( original ).data( 'hasitem' ) === false ) {\n\t\t\t\t\t\t\t\tvar timer = setTimeout( close_it, 800 );\n\t\t\t\t\t\t\t\t$( original ).data( 'timer2', timer );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tvar handler_original_enter = function() {\n\t\t\t\t\t\t\t$( original ).data( 'hasoriginal', true );\n\t\t\t\t\t\t\tclearTimeout( $( original ).data( 'timer2' ) );\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tvar close_it = function() {\n\t\t\t\t\t\t\titem.slideUp( 200 );\n\n\t\t\t\t\t\t\t// Clear all hooks\n\t\t\t\t\t\t\t$( original ).unbind( 'mouseleave', handler_original_leave ).unbind( 'mouseenter', handler_original_enter );\n\t\t\t\t\t\t\t$( item ).unbind( 'mouseleave', handler_item_leave ).unbind( 'mouseenter', handler_item_leave );\n\t\t\t\t\t\t\t$( original ).data( 'hasappeared', false );\n\t\t\t\t\t\t\t$( original ).unbind( 'click', close_it );\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t};\n\t\t\t\t\t}, 200 );\n\n\t\t\t\t\t// Remember the timer so we can detect it on the mouseout\n\t\t\t\t\t$( this ).data( 'timer', timer );\n\t\t\t\t}\n\t\t\t}, function() {\n\t\t\t\t// Mouse out - remove any timer\n\t\t\t\tclearTimeout( $( this ).data( 'timer' ) );\n\t\t\t\t$( this ).data( 'timer', false );\n\t\t\t} );\n\t\t}\n\n\t\tfunction update_preview() {\n\t\t\tvar button_style = $( '#button_style' ).val();\n\n\t\t\t// Clear the live preview\n\t\t\t$( '#live-preview ul.preview li' ).remove();\n\n\t\t\t// Add label\n\t\t\tif ( $( '#save-enabled-shares input[name=visible]' ).val() || $( '#save-enabled-shares input[name=hidden]' ).val() ) {\n\t\t\t\t$( '#live-preview ul.preview' ).append( $( '#live-preview ul.archive .sharing-label' ).clone() );\n\t\t\t}\n\n\t\t\t// Re-insert all the enabled items\n\t\t\t$( 'ul.services-enabled li' ).each( function() {\n\t\t\t\tif ( $( this ).hasClass( 'service' ) ) {\n\t\t\t\t\tvar service = $( this ).attr( 'id' );\n\t\t\t\t\t$( '#live-preview ul.preview' ).append( $( '#live-preview ul.archive li.preview-' + service ).clone() );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t// Add any hidden items\n\t\t\tif ( $( '#save-enabled-shares input[name=hidden]' ).val() ) {\n\t\t\t\t// Add share button\n\t\t\t\t$( '#live-preview ul.preview' ).append( $( '#live-preview ul.archive .share-more' ).parent().clone() );\n\n\t\t\t\t$( '.sharing-hidden ul li' ).remove();\n\n\t\t\t\t// Add hidden items into the inner panel\n\t\t\t\t$( 'ul.services-hidden li' ).each( function( /*pos, item*/ ) {\n\t\t\t\t\tif ( $( this ).hasClass( 'service' ) ) {\n\t\t\t\t\t\tvar service = $( this ).attr( 'id' );\n\t\t\t\t\t\t$( '.sharing-hidden .inner ul' ).append( $( '#live-preview ul.archive .preview-' + service ).clone() );\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t\tenable_share_button();\n\t\t\t}\n\n\t\t\t$( '#live-preview div.sharedaddy' ).removeClass( 'sd-social-icon' );\n\t\t\t$( '#live-preview li.advanced' ).removeClass( 'no-icon' );\n\n\t\t\t// Button style\n\t\t\tif ( 'icon' === button_style ) {\n\t\t\t\t$( '#live-preview ul.preview div span, .sharing-hidden .inner ul div span' ).html( '&nbsp;' ).parent().addClass( 'no-text' );\n\t\t\t\t$( '#live-preview div.sharedaddy' ).addClass( 'sd-social-icon' );\n\t\t\t} else if ( 'official' === button_style ) {\n\t\t\t\t$( '#live-preview ul.preview .advanced, .sharing-hidden .inner ul .advanced' ).each( function( /*i*/ ) {\n\t\t\t\t\tif ( !$( this ).hasClass( 'preview-press-this' ) &&\n\t\t\t\t\t\t!$( this ).hasClass( 'preview-email' ) &&\n\t\t\t\t\t\t!$( this ).hasClass( 'preview-print' ) &&\n\t\t\t\t\t\t!$( this ).hasClass( 'preview-telegram' ) &&\n\t\t\t\t\t\t!$( this ).hasClass( 'preview-jetpack-whatsapp' ) &&\n\t\t\t\t\t\t!$( this ).hasClass( 'share-custom' ) ) {\n\t\t\t\t\t\t$( this ).find( '.option a span' ).html( '' ).parent().removeClass( 'sd-button' ).parent().attr( 'class', 'option option-smart-on' );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} else if ( 'text' === button_style ) {\n\t\t\t\t$( '#live-preview li.advanced' ).addClass( 'no-icon' );\n\t\t\t}\n\n\t\t}\n\n\t\twindow.sharing_option_changed = function() {\n\t\t\tvar item = this;\n\n\t\t\t// Loading icon\n\t\t\t$( this ).parents( 'li:first' ).css( 'backgroundImage', 'url(\"' + sharing_loading_icon + '\")' );\n\n\t\t\t// Save\n\t\t\t$( this ).parents( 'form' ).ajaxSubmit( function( response ) {\n\t\t\t\tif ( response.indexOf( '<!---' ) >= 0 ) {\n\t\t\t\t\tvar button = response.substring( 0, response.indexOf( '<!--->' ) );\n\t\t\t\t\tvar preview = response.substring( response.indexOf( '<!--->' ) + 6 );\n\n\t\t\t\t\tif ( $( item ).is( ':submit' ) === true ) {\n\t\t\t\t\t\t// Update the DOM using a bit of cut/paste technology\n\n\t\t\t\t\t\t$( item ).parents( 'li:first' ).replaceWith( button );\n\t\t\t\t\t}\n\n\t\t\t\t\t$( '#live-preview ul.archive li.preview-' + $( item ).parents( 'form' ).find( 'input[name=service]' ).val() ).replaceWith( preview );\n\t\t\t\t}\n\n\t\t\t\t// Update preview\n\t\t\t\tupdate_preview();\n\n\t\t\t\t// Restore the icon\n\t\t\t\t$( item ).parents( 'li:first' ).removeAttr( 'style' );\n\t\t\t} );\n\n\t\t\tif ( $( item ).is( ':submit' ) === true ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t};\n\n\t\tfunction showExtraOptions( service ) {\n\t\t\tjQuery( '.' + service + '-extra-options' ).css( { backgroundColor: '#ffffcc' } ).fadeIn();\n\t\t}\n\n\t\tfunction hideExtraOptions( service ) {\n\t\t\tjQuery( '.' + service + '-extra-options' ).fadeOut( 'slow' );\n\t\t}\n\n\t\tfunction save_services() {\n\t\t\t$( '#enabled-services h3 img' ).show();\n\n\t\t\t// Toggle various dividers/help texts\n\t\t\tif ( $( '#enabled-services ul.services-enabled li.service' ).length > 0 ) {\n\t\t\t\t$( '#drag-instructions' ).hide();\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$( '#drag-instructions' ).show();\n\t\t\t}\n\n\t\t\tif ( $( '#enabled-services li.service' ).length > 0 ) {\n\t\t\t\t$( '#live-preview .services h2' ).hide();\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$( '#live-preview .services h2' ).show();\n\t\t\t}\n\n\t\t\t// Gather the modules\n\t\t\tvar visible = [], hidden = [];\n\n\t\t\t$( 'ul.services-enabled li' ).each( function() {\n\t\t\t\tif ( $( this ).hasClass( 'service' ) ) {\n\t\t\t\t\t// Ready for saving\n\t\t\t\t\tvisible[visible.length] = $( this ).attr( 'id' );\n\t\t\t\t\tshowExtraOptions( $( this ).attr( 'id' ) );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t$( 'ul.services-available li' ).each( function() {\n\t\t\t\tif ( $( this ).hasClass( 'service' ) ) {\n\t\t\t\t\thideExtraOptions( $( this ).attr( 'id' ) );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t$( 'ul.services-hidden li' ).each( function() {\n\t\t\t\tif ( $( this ).hasClass( 'service' ) ) {\n\t\t\t\t\t// Ready for saving\n\t\t\t\t\thidden[hidden.length] = $( this ).attr( 'id' );\n\t\t\t\t\tshowExtraOptions( $( this ).attr( 'id' ) );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t// Set the hidden element values\n\t\t\t$( '#save-enabled-shares input[name=visible]' ).val( visible.join( ',' ) );\n\t\t\t$( '#save-enabled-shares input[name=hidden]' ).val( hidden.join( ',' ) );\n\n\t\t\tupdate_preview();\n\n\t\t\t// Save it\n\t\t\t$( '#save-enabled-shares' ).ajaxSubmit( function() {\n\t\t\t\t$( '#enabled-services h3 img' ).hide();\n\t\t\t} );\n\t\t}\n\n\t\t$( '#enabled-services .services ul' ).sortable( {\n\t\t\treceive: function( /*event, ui*/ ) {\n\t\t\t\tsave_services();\n\t\t\t},\n\t\t\tstop: function() {\n\t\t\t\tsave_services();\n\t\t\t\t$( 'li.service' ).enableSelection();   // Fixes a problem with Chrome\n\t\t\t},\n\t\t\tover: function( /*event, ui*/ ) {\n\t\t\t\t$( this ).find( 'ul' ).addClass( 'dropping' );\n\n\t\t\t\t// Ensure the 'end-fix' is at the end\n\t\t\t\t$( '#enabled-services li.end-fix' ).remove();\n\t\t\t\t$( '#enabled-services ul' ).append( '<li class=\"end-fix\"></li>' );\n\t\t\t},\n\t\t\tout: function( /*event, ui*/ ) {\n\t\t\t\t$( this ).find( 'ul' ).removeClass( 'dropping' );\n\n\t\t\t\t// Ensure the 'end-fix' is at the end\n\t\t\t\t$( '#enabled-services li.end-fix' ).remove();\n\t\t\t\t$( '#enabled-services ul' ).append( '<li class=\"end-fix\"></li>' );\n\t\t\t},\n\t\t\thelper: function( event, ui ) {\n\t\t\t\tui.find( '.advanced-form' ).hide();\n\n\t\t\t\treturn ui.clone();\n\t\t\t},\n\t\t\tstart: function( /*event, ui*/ ) {\n\t\t\t\t// Make sure that the advanced section is closed\n\t\t\t\t$( '.advanced-form' ).hide();\n\t\t\t\t$( 'li.service' ).disableSelection();   // Fixes a problem with Chrome\n\t\t\t},\n\t\t\tplaceholder: 'dropzone',\n\t\t\topacity: 0.8,\n\t\t\tdelay: 150,\n\t\t\tforcePlaceholderSize: true,\n\t\t\titems: 'li',\n\t\t\tconnectWith: '#available-services ul, #enabled-services .services ul',\n\t\t\tcancel: '.advanced-form'\n\t\t} );\n\n\t\t$( '#available-services ul' ).sortable( {\n\t\t\topacity: 0.8,\n\t\t\tdelay: 150,\n\t\t\tcursor: 'move',\n\t\t\tconnectWith: '#enabled-services .services ul',\n\t\t\tplaceholder: 'dropzone',\n\t\t\tforcePlaceholderSize: true,\n\t\t\tstart: function() {\n\t\t\t\t$( '.advanced-form' ).hide();\n\t\t\t}\n\t\t} );\n\n\t\t// Accessibility keyboard shortcurts\n\t\t$( '.service' ).on( 'keydown', function ( e ) {\n\n\t\t\t// Reposition if one of the directional keys is pressed\n\t\t\tswitch ( e.keyCode ) {\n\t\t\t\tcase 13: keyboardDragDrop( $( this ) ); break; // Enter\n\t\t\t\tcase 32: keyboardDragDrop( $( this ) ); break; // Space\n\t\t\t\tcase 37: keyboardChangeOrder( $( this ), 'left' ); break; // Left\n\t\t\t\tcase 39: keyboardChangeOrder( $( this ), 'right' ); break; // Right\n\t\t\t\tdefault: return true; // Exit and bubble\n\t\t\t}\n\n\t\t\te.preventDefault();\n\t\t});\n\n\t\tfunction keyboardChangeOrder( $this, dir ) {\n\n\t\t\tvar thisParent = $this.parent(),\n\t\t\t\tthisParentsChildren = thisParent.find( 'li' ),\n\t\t\t\tthisPosition = thisParentsChildren.index( $this ) + 1,\n\t\t\t\ttotalChildren = thisParentsChildren.length - 1,\n\t\t\t\tthisService;\n\n\t\t\t// No need to be able to sort order for the \"Available Services\" section\n\t\t\tif ( thisParent.hasClass( 'services-available' ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( 'left' === dir ) {\n\t\t\t\tif ( 1 === thisPosition ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Find service to left\n\t\t\t\tvar prevSibling = $this.prev();\n\n\t\t\t\t// Detach this service from DOM\n\t\t\t\tthisService = $this.detach();\n\n\t\t\t\t// Move it to the appropriate area and add focus back to service\n\t\t\t\tprevSibling.before( thisService );\n\n\t\t\t\t// Add focus\n\t\t\t\tprevSibling.prev().focus();\n\t\t\t}\n\n\t\t\tif ( 'right' === dir ) {\n\t\t\t\tif ( thisPosition === totalChildren ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Find service to left\n\t\t\t\tvar nextSibling = $this.next();\n\n\t\t\t\t// Detach this service from DOM\n\t\t\t\tthisService = $this.detach();\n\n\t\t\t\t// Move it to the appropriate area and add focus back to service\n\t\t\t\tnextSibling.after( thisService );\n\n\t\t\t\t// Add focus\n\t\t\t\tnextSibling.next().focus();\n\t\t\t}\n\n\t\t\t//Save changes\n\t\t\tsave_services();\n\t\t}\n\n\t\tfunction keyboardDragDrop( $this ) {\n\n\t\t\tvar dropzone,\n\t\t\t\tthisParent = $this.parent();\n\n\t\t\t// Rotate through 3 available dropzones\n\t\t\tif ( thisParent.hasClass( 'services-available' ) ) {\n\t\t\t\tdropzone = 'services-enabled';\n\t\t\t} else if ( thisParent.hasClass( 'services-enabled' ) ) {\n\t\t\t\tdropzone = 'services-hidden';\n\t\t\t} else {\n\t\t\t\tdropzone = 'services-available';\n\t\t\t}\n\n\t\t\t// Detach this service from DOM\n\t\t\tvar thisService = $this.detach();\n\n\t\t\t// Move it to the appropriate area and add focus back to service\n\t\t\t$( '.' + dropzone ).prepend( thisService ).find( 'li:first-child' ).focus();\n\n\t\t\t//Save changes\n\t\t\tsave_services();\n\t\t}\n\n\t\t// Live preview 'hidden' button\n\t\t$( '.preview-hidden a' ).click( function() {\n\t\t\t$( this ).parent().find( '.preview' ).toggle();\n\t\t\treturn false;\n\t\t} );\n\n\t\t// Add service\n\t\t$( '#new-service form' ).ajaxForm( {\n\t\t\t\tbeforeSubmit: function() {\n\t\t\t\t\t$( '#new-service-form .error' ).hide();\n\t\t\t\t\t$( '#new-service-form img' ).show();\n\t\t\t\t\t$( '#new-service-form input[type=submit]' ).prop( 'disabled', true );\n\t\t\t\t},\n\t\t\t\tsuccess: function( response ) {\n\t\t\t\t\t$( '#new-service-form img' ).hide();\n\n\t\t\t\t\tif ( ( '' + response ) === '1' ) {\n\t\t\t\t\t\t$( '#new-service-form .inerror' ).removeClass( 'inerror' ).addClass( 'error' );\n\t\t\t\t\t\t$( '#new-service-form .error' ).show();\n\t\t\t\t\t\t$( '#new-service-form input[type=submit]' ).prop( 'disabled', false );\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tdocument.location.reload();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tfunction init_handlers() {\n\t\t\t$( '#services-config a.remove' ).unbind( 'click' ).click( function() {\n\t\t\t\tvar form = $( this ).parent().next();\n\n\t\t\t\t// Loading icon\n\t\t\t\t$( this ).parents( 'li:first' ).css( 'backgroundImage', 'url(\"' + sharing_loading_icon + '\")' );\n\n\t\t\t\t// Save\n\t\t\t\tform.ajaxSubmit( function( /*response*/ ) {\n\t\t\t\t\t// Remove the item\n\t\t\t\t\tform.parents( 'li:first' ).fadeOut( function() {\n\t\t\t\t\t\t$( this ).remove();\n\n\t\t\t\t\t\t// Update preview\n\t\t\t\t\t\tupdate_preview();\n\t\t\t\t\t} );\n\t\t\t\t} );\n\n\t\t\t\treturn false;\n\t\t\t} );\n\t\t}\n\n\t\t$( '#button_style' ).change( function() {\n\t\t\tupdate_preview();\n\t\t\treturn true;\n\t\t} ).change();\n\n\t\t$( 'input[name=sharing_label]' ).blur( function() {\n\t\t\t$('#live-preview h3.sd-title').text( $( '<div/>' ).text( $( this ).val() ).html() );\n\t\t} );\n\n\t\tinit_handlers();\n\t\tenable_share_button();\n\t} );\n})( jQuery );\n"]}