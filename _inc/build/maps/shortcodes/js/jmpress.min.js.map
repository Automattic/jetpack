{"version":3,"sources":["shortcodes/js/jmpress.js"],"names":["$","document","window","undefined","mapProperty","name","index","substr","search","toLowerCase","addComma","attribute","ifNotEmpty","el","length","init","args","doStepInit","element","idx","data","dataset","step","oldStyle","attr","callbackData","stepData","callCallback","call","this","delegate","doStepDeinit","doStepReapply","deinit","active","reason","current","jmpressClass","jmpress","removeClass","settings","stepSelector","each","container","fullscreen","area","canvas","children","append","remove","callbackName","eventData","parents","getStepParents","result","callback","value","parentsUntil","not","filter","reselect","type","select","substep","activeSubstep","isPlainObject","find","first","scrollFix","cancelSelect","cancel","target","delegated","near","activeDelegated","delegatedFrom","nextStep","nextSubstep","nextStepData","prevStep","prevSubstep","prevStepData","addClass","jmpressDelegatedClass","extend","beforeActive","idleTimeout","clearTimeout","setTimeout","Math","max","transitionDuration","fix","check","scrollTop","scrollLeft","tagName","scrollTo","e","goTo","next","prev","home","end","canvasMod","props","css","getActive","fire","callbacks","error","callbackArgs","isFunction","defaults","Array","prototype","push","apply","nextIdNumber","reapply","ua","navigator","userAgent","notSupportedClass","steps","overflow","height","position","containerClass","areaClass","canvasClass","documentElement","style","animation","top","left","perspective","initClass","getDefaults","register","func","methods","key","pkey","cssObj","hasOwnProperty","pfx","toCamelcase","str","split","i","toUpperCase","join","returnDataset","attrs","attributes","nodeName","nodeValue","initialized","createElement","prefixes","memory","prop","ucProp","charAt","transformOrigin","transitionProperty","transitionDelay","transitionTimingFunction","transformStyle","beforeChange","beforeInitStep","initStep","beforeInit","afterInit","beforeDeinit","afterDeinit","applyStep","unapplyStep","setInactive","setActive","selectInitialStep","selectPrev","selectNext","selectHome","selectEnd","idle","applyTarget","fn","method","f","jmpressmethods","slice","arguments","jQuery","checkAndGo","elements","selector","backwards","is","findNextInChildren","item","get","reverse","findNextInSiblings","findNextInParents","array","toCssNumber","number","round","engines","3","transform","coord","order","2","1","anitarget","animate","engine","reasonableAnimation","pf","parseFloat","x","y","z","r","phi","rotate","rotateX","rotateY","rotateZ","revertRotate","scale","scaleX","scaleY","scaleZ","nil","perspectiveScale","maxNestedDepth","nestedSteps","sd","sin","PI","cos","tf","lowRotate","cur","tar","curmod","tarmod","diff","zoomin","zoomout","lastScale","oldLastScale","extracted","$jmpress","activeClassSetting","nestedActiveClassSettings","firstSlide","prevOrNext","closest","exclude","indexOf","last","start","routeFunc","route","from","to","selectPrevOrNext","unidirectional","reversedRoute","loadStep","ajaxLoadedClass","src","srcLoaded","href","load","response","status","xhr","add","randomString","random","getElementFromUrl","location","hash","replace","setHash","stepid","shouldBeHash","history","pushState","use","update","bindChange","hashSettings","hashNamespace","bind","event","urlItem","preventDefault","on","stopPropagation","off","unbind","hashtimeout","stopEvent","keyboard","keys","33","37","38","9","jmpressNext","32","34","39","40","36","35","ignore","INPUT","TEXTAREA","SELECT","tabSelector","keyboardSettings","ignoreKeyboardSettings","keyboardNamespace","which","eventTarget","nextFocus","reverseSelect","shiftKey","focus","action","maxAbs","range","min","zoom","direction","userZoom","zoomableSteps","viewPortZoomable","viewPort","zoomable","halfWidth","innerWidth","halfHeight","innerHeight","userTranslateX","zoomOriginWindowScale","userTranslateY","browser","exec","width","maxScale","minScale","zoomBindMove","zoomBindWheel","resize","variable","viewPortHeight","viewPortWidth","viewPortMinScale","viewPortMaxScale","viewPortNamespace","delta","originalEvent","wheelDelta","detail","abs","userTranslating","clientX","clientY","stopImmediatePropagation","windowScaleY","windowScaleX","windowScale","mouse","clickSelects","clickableStepsNamespace","clickedStep","mobileNamespace","touches","pageX","pageY","addUndefined","values","prefix","targetName","applyChildrenTemplates","templateChildren","isArray","child","tmpl","templateFromParentIdent","applyTemplate","template","applyTemplateData","templates","templateFromAttr","templateFromApply","templateFromParent","dataTemplate","parent","triggerHandler","parseSubstepInfo","arr","className","config","willClass","doClass","hasClass","state","s","warn","match","delay","after","addOn","list","_on","customAnimationDataAttribute","animationTimeouts","animationCleanupWaiting","findNextFunc","_after","substepsData","listOfSubsteps","info","other","startStep","startSubstep","substepsInOrder","substepList","activeSubsteps","timeout","applyHas","applyDo","applyIt","cleanupAnimation","initial","keyCode","exchangeIf","childStepData","condition","secondary","tmp","normal","grandchildrenFunc","duration","defaultValue","defaultAction","barSelector","barProperty","barPropertyStart","barPropertyEnd","parseInt","durationAction","durationSettings","durationTimeout","bars","detach","insertBefore","dur","PREFIX","presentationMode","url","notesUrl","transferredValues","selectMessageListeners","addEventListener","json","JSON","parse","test","targetId","source","presentationPopupTimeout","postMessage","stringify","stepId","listener","msg","trySend","popup","open"],"mappings":"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","file":"../../../shortcodes/js/jmpress.min.js","sourcesContent":["/* Do not modify this file directly. It is compiled from other files. */\n/**\n * jmpress.js v0.4.5\n * http://jmpressjs.github.com/jmpress.js\n *\n * A jQuery plugin to build a website on the infinite canvas.\n *\n * Copyright 2013 Kyle Robinson Young @shama & Tobias Koppers @sokra\n * Licensed MIT\n * http://www.opensource.org/licenses/mit-license.php\n *\n * Based on the foundation laid by Bartek Szopka @bartaz\n *//*\n * core.js\n * The core of jmpress.js\n */\n(function( $, document, window, undefined ) {\n\n\t'use strict';\n\n\t/**\n\t * Set supported prefixes\n\t *\n\t * @access protected\n\t * @return Function to get prefixed property\n\t */\n\tvar pfx = (function () {\n\t\tvar style = document.createElement('dummy').style,\n\t\t\tprefixes = 'Webkit Moz O ms Khtml'.split(' '),\n\t\t\tmemory = {};\n\t\treturn function ( prop ) {\n\t\t\tif ( typeof memory[ prop ] === \"undefined\" ) {\n\t\t\t\tvar ucProp  = prop.charAt(0).toUpperCase() + prop.substr(1),\n\t\t\t\t\tprops   = (prop + ' ' + prefixes.join(ucProp + ' ') + ucProp).split(' ');\n\t\t\t\tmemory[ prop ] = null;\n\t\t\t\tfor ( var i in props ) {\n\t\t\t\t\tif ( style[ props[i] ] !== undefined ) {\n\t\t\t\t\t\tmemory[ prop ] = props[i];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn memory[ prop ];\n\t\t};\n\t}());\n\n\t/**\n\t * map ex. \"WebkitTransform\" to \"-webkit-transform\"\n\t */\n\tfunction mapProperty( name ) {\n\t\tif(!name) {\n\t\t\treturn;\n\t\t}\n\t\tvar index = 1 + name.substr(1).search(/[A-Z]/);\n\t\tvar prefix = name.substr(0, index).toLowerCase();\n\t\tvar postfix = name.substr(index).toLowerCase();\n\t\treturn \"-\" + prefix + \"-\" + postfix;\n\t}\n\tfunction addComma( attribute ) {\n\t\tif(!attribute) {\n\t\t\treturn \"\";\n\t\t}\n\t\treturn attribute + \",\";\n\t}\n\t/**\n\t * Return an jquery object only if it's not empty\n\t */\n\tfunction ifNotEmpty(el) {\n\t\tif(el.length > 0) {\n\t\t\treturn el;\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t * Default Settings\n\t */\n\tvar defaults = {\n\t\t/* CLASSES */\n\t\tstepSelector: '.step'\n\t\t,containerClass: ''\n\t\t,canvasClass: ''\n\t\t,areaClass: ''\n\t\t,notSupportedClass: 'not-supported'\n\n\t\t/* CONFIG */\n\t\t,fullscreen: true\n\n\t\t/* ANIMATION */\n\t\t,animation: {\n\t\t\ttransformOrigin: 'top left'\n\t\t\t,transitionProperty: addComma(mapProperty(pfx('transform'))) + addComma(mapProperty(pfx('perspective'))) + 'opacity'\n\t\t\t,transitionDuration: '1s'\n\t\t\t,transitionDelay: '500ms'\n\t\t\t,transitionTimingFunction: 'ease-in-out'\n\t\t\t,transformStyle: \"preserve-3d\"\n\t\t}\n\t\t,transitionDuration: 1500\n\t};\n\tvar callbacks = {\n\t\t'beforeChange': 1\n\t\t,'beforeInitStep': 1\n\t\t,'initStep': 1\n\t\t,'beforeInit': 1\n\t\t,'afterInit': 1\n\t\t,'beforeDeinit': 1\n\t\t,'afterDeinit': 1\n\t\t,'applyStep': 1\n\t\t,'unapplyStep': 1\n\t\t,'setInactive': 1\n\t\t,'beforeActive': 1\n\t\t,'setActive': 1\n\t\t,'selectInitialStep': 1\n\t\t,'selectPrev': 1\n\t\t,'selectNext': 1\n\t\t,'selectHome': 1\n\t\t,'selectEnd': 1\n\t\t,'idle': 1\n\t\t,'applyTarget': 1\n\t};\n\tfor(var callbackName in callbacks) {\n\t\tdefaults[callbackName] = [];\n\t}\n\n\n\t/**\n\t * Initialize jmpress\n\t */\n\tfunction init( args ) {\n\t\targs = $.extend(true, {}, args || {});\n\n\t\t// accept functions and arrays of functions as callbacks\n\t\tvar callbackArgs = {};\n\t\tvar callbackName = null;\n\t\tfor (callbackName in callbacks) {\n\t\t\tcallbackArgs[callbackName] = $.isFunction( args[callbackName] ) ?\n\t\t\t\t[ args[callbackName] ] :\n\t\t\t\targs[callbackName];\n\t\t\targs[callbackName] = [];\n\t\t}\n\n\t\t// MERGE SETTINGS\n\t\tvar settings = $.extend(true, {}, defaults, args);\n\n\t\tfor (callbackName in callbacks) {\n\t\t\tif (callbackArgs[callbackName]) {\n\t\t\t\tArray.prototype.push.apply(settings[callbackName], callbackArgs[callbackName]);\n\t\t\t}\n\t\t}\n\n\t\t/*** MEMBER VARS ***/\n\n\t\tvar jmpress = $( this )\n\t\t\t,container = null\n\t\t\t,area = null\n\t\t\t,oldStyle = {\n\t\t\t\tcontainer: \"\"\n\t\t\t\t,area: \"\"\n\t\t\t}\n\t\t\t,canvas = null\n\t\t\t,current = null\n\t\t\t,active = false\n\t\t\t,activeSubstep = null\n\t\t\t,activeDelegated = false;\n\n\n\t\t/*** MEMBER FUNCTIONS ***/\n\t\t// functions have to be called with this\n\n\t\t/**\n\t\t * Init a single step\n\t\t *\n\t\t * @param element the element of the step\n\t\t * @param idx number of step\n\t\t */\n\t\tfunction doStepInit( element, idx ) {\n\t\t\tvar data = dataset( element );\n\t\t\tvar step = {\n\t\t\t\toldStyle: $(element).attr(\"style\") || \"\"\n\t\t\t};\n\n\t\t\tvar callbackData = {\n\t\t\t\tdata: data\n\t\t\t\t,stepData: step\n\t\t\t};\n\t\t\tcallCallback.call(this, 'beforeInitStep', $(element), callbackData);\n\t\t\tstep.delegate = data.delegate;\n\t\t\tcallCallback.call(this, 'initStep', $(element), callbackData);\n\n\t\t\t$(element).data('stepData', step);\n\n\t\t\tif ( !$(element).attr('id') ) {\n\t\t\t\t$(element).attr('id', 'step-' + (idx + 1));\n\t\t\t}\n\n\t\t\tcallCallback.call(this, 'applyStep', $(element), callbackData);\n\t\t}\n\t\t/**\n\t\t * Deinit a single step\n\t\t *\n\t\t * @param element the element of the step\n\t\t */\n\t\tfunction doStepDeinit( element ) {\n\t\t\tvar stepData = $(element).data('stepData');\n\n\t\t\t$(element).attr(\"style\", stepData.oldStyle);\n\n\t\t\tcallCallback.call(this, 'unapplyStep', $(element), {\n\t\t\t\tstepData: stepData\n\t\t\t});\n\t\t}\n\t\t/**\n\t\t * Reapplies stepData to the element\n\t\t *\n\t\t * @param element\n\t\t */\n\t\tfunction doStepReapply( element ) {\n\t\t\tcallCallback.call(this, 'unapplyStep', $(element), {\n\t\t\t\tstepData: element.data(\"stepData\")\n\t\t\t});\n\n\t\t\tcallCallback.call(this, 'applyStep', $(element), {\n\t\t\t\tstepData: element.data(\"stepData\")\n\t\t\t});\n\t\t}\n\t\t/**\n\t\t * Completly deinit jmpress\n\t\t *\n\t\t */\n\t\tfunction deinit() {\n\t\t\tif ( active ) {\n\t\t\t\tcallCallback.call(this, 'setInactive', active, {\n\t\t\t\t\tstepData: $(active).data('stepData')\n\t\t\t\t\t,reason: \"deinit\"\n\t\t\t\t} );\n\t\t\t}\n\t\t\tif (current.jmpressClass) {\n\t\t\t\t$(jmpress).removeClass(current.jmpressClass);\n\t\t\t}\n\n\t\t\tcallCallback.call(this, 'beforeDeinit', $(this), {});\n\n\t\t\t$(settings.stepSelector, jmpress).each(function( idx ) {\n\t\t\t\tdoStepDeinit.call(jmpress, this );\n\t\t\t});\n\n\t\t\tcontainer.attr(\"style\", oldStyle.container);\n\t\t\tif(settings.fullscreen) {\n\t\t\t\t$(\"html\").attr(\"style\", \"\");\n\t\t\t}\n\t\t\tarea.attr(\"style\", oldStyle.area);\n\t\t\t$(canvas).children().each(function() {\n\t\t\t\tjmpress.append( $( this ) );\n\t\t\t});\n\t\t\tif( settings.fullscreen ) {\n\t\t\t\tcanvas.remove();\n\t\t\t} else {\n\t\t\t\tcanvas.remove();\n\t\t\t\tarea.remove();\n\t\t\t}\n\n\t\t\tcallCallback.call(this, 'afterDeinit', $(this), {});\n\n\t\t\t$(jmpress).data(\"jmpressmethods\", false);\n\t\t}\n\t\t/**\n\t\t * Call a callback\n\t\t *\n\t\t * @param callbackName String callback which should be called\n\t\t * @param element some arguments to the callback\n\t\t * @param eventData\n\t\t */\n\t\tfunction callCallback( callbackName, element, eventData ) {\n\t\t\teventData.settings = settings;\n\t\t\teventData.current = current;\n\t\t\teventData.container = container;\n\t\t\teventData.parents = element ? getStepParents(element) : null;\n\t\t\teventData.current = current;\n\t\t\teventData.jmpress = this;\n\t\t\tvar result = {};\n\t\t\t$.each( settings[callbackName], function(idx, callback) {\n\t\t\t\tresult.value = callback.call( jmpress, element, eventData ) || result.value;\n\t\t\t});\n\t\t\treturn result.value;\n\t\t}\n\t\t/**\n\t\t *\n\t\t */\n\t\tfunction getStepParents( el ) {\n\t\t\treturn $(el).parentsUntil(jmpress).not(jmpress).filter(settings.stepSelector);\n\t\t}\n\t\t/**\n\t\t * Reselect the active step\n\t\t *\n\t\t * @param String type reason of reselecting step\n\t\t */\n\t\tfunction reselect( type ) {\n\t\t\treturn select( { step: active, substep: activeSubstep }, type);\n\t\t}\n\t\t/**\n\t\t * Select a given step\n\t\t *\n\t\t * @param el element to select\n\t\t * @param type reason of changing step\n\t\t * @return Object element selected\n\t\t */\n\t\tfunction select( el, type ) {\n\t\t\tvar substep;\n\t\t\tif ( $.isPlainObject( el ) ) {\n\t\t\t\tsubstep = el.substep;\n\t\t\t\tel = el.step;\n\t\t\t}\n\t\t\tif ( typeof el === 'string') {\n\t\t\t\tel = jmpress.find( el ).first();\n\t\t\t}\n\t\t\tif ( !el || !$(el).data('stepData') ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tscrollFix.call(this);\n\n\t\t\tvar step = $(el).data('stepData');\n\n\t\t\tvar cancelSelect = false;\n\t\t\tcallCallback.call(this, \"beforeChange\", el, {\n\t\t\t\tstepData: step\n\t\t\t\t,reason: type\n\t\t\t\t,cancel: function() {\n\t\t\t\t\tcancelSelect = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (cancelSelect) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tvar target = {};\n\n\t\t\tvar delegated = el;\n\t\t\tif($(el).data(\"stepData\").delegate) {\n\t\t\t\tdelegated = ifNotEmpty($(el).parentsUntil(jmpress).filter(settings.stepSelector).filter(step.delegate)) ||\n\t\t\t\t\tifNotEmpty($(el).near(step.delegate)) ||\n\t\t\t\t\tifNotEmpty($(el).near(step.delegate, true)) ||\n\t\t\t\t\tifNotEmpty($(step.delegate, jmpress));\n\t\t\t\tif(delegated) {\n\t\t\t\t\tstep = delegated.data(\"stepData\");\n\t\t\t\t} else {\n\t\t\t\t\t// Do not delegate if expression not found\n\t\t\t\t\tdelegated = el;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( activeDelegated ) {\n\t\t\t\tcallCallback.call(this, 'setInactive', activeDelegated, {\n\t\t\t\t\tstepData: $(activeDelegated).data('stepData')\n\t\t\t\t\t,delegatedFrom: active\n\t\t\t\t\t,reason: type\n\t\t\t\t\t,target: target\n\t\t\t\t\t,nextStep: delegated\n\t\t\t\t\t,nextSubstep: substep\n\t\t\t\t\t,nextStepData: step\n\t\t\t\t} );\n\t\t\t}\n\t\t\tvar callbackData = {\n\t\t\t\tstepData: step\n\t\t\t\t,delegatedFrom: el\n\t\t\t\t,reason: type\n\t\t\t\t,target: target\n\t\t\t\t,substep: substep\n\t\t\t\t,prevStep: activeDelegated\n\t\t\t\t,prevSubstep: activeSubstep\n\t\t\t\t,prevStepData: activeDelegated && $(activeDelegated).data('stepData')\n\t\t\t};\n\t\t\tcallCallback.call(this, 'beforeActive', delegated, callbackData);\n\t\t\tcallCallback.call(this, 'setActive', delegated, callbackData);\n\n\t\t\t// Set on step class on root element\n\t\t\tif (current.jmpressClass) {\n\t\t\t\t$(jmpress).removeClass(current.jmpressClass);\n\t\t\t}\n\t\t\t$(jmpress).addClass(current.jmpressClass = 'step-' + $(delegated).attr('id') );\n\t\t\tif (current.jmpressDelegatedClass) {\n\t\t\t\t$(jmpress).removeClass(current.jmpressDelegatedClass);\n\t\t\t}\n\t\t\t$(jmpress).addClass(current.jmpressDelegatedClass = 'delegating-step-' + $(el).attr('id') );\n\n\t\t\tcallCallback.call(this, \"applyTarget\", delegated, $.extend({\n\t\t\t\tcanvas: canvas\n\t\t\t\t,area: area\n\t\t\t\t,beforeActive: activeDelegated\n\t\t\t}, callbackData));\n\n\t\t\tactive = el;\n\t\t\tactiveSubstep = callbackData.substep;\n\t\t\tactiveDelegated = delegated;\n\n\t\t\tif(current.idleTimeout) {\n\t\t\t\tclearTimeout(current.idleTimeout);\n\t\t\t}\n\t\t\tcurrent.idleTimeout = setTimeout(function() {\n\t\t\t\tcallCallback.call(this, 'idle', delegated, callbackData);\n\t\t\t}, Math.max(1, settings.transitionDuration - 100));\n\n\t\t\treturn delegated;\n\t\t}\n\t\t/**\n\t\t * This should fix ANY kind of buggy scrolling\n\t\t */\n\t\tfunction scrollFix() {\n\t\t\t(function fix() {\n\t\t\t\tif ($(container)[0].tagName === \"BODY\") {\n\t\t\t\t\ttry {\n\t\t\t\t\t\twindow.scrollTo(0, 0);\n\t\t\t\t\t} catch(e) {}\n\t\t\t\t}\n\t\t\t\t$(container).scrollTop(0);\n\t\t\t\t$(container).scrollLeft(0);\n\t\t\t\tfunction check() {\n\t\t\t\t\tif ($(container).scrollTop() !== 0 ||\n\t\t\t\t\t\t$(container).scrollLeft() !== 0) {\n\t\t\t\t\t\t\tfix();\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tsetTimeout(check, 1);\n\t\t\t\tsetTimeout(check, 10);\n\t\t\t\tsetTimeout(check, 100);\n\t\t\t\tsetTimeout(check, 200);\n\t\t\t\tsetTimeout(check, 400);\n\t\t\t}());\n\t\t}\n\t\t/**\n\t\t * Alias for select\n\t\t */\n\t\tfunction goTo( el ) {\n\t\t\treturn select.call(this, el, \"jump\" );\n\t\t}\n\t\t/**\n\t\t * Goto Next Slide\n\t\t *\n\t\t * @return Object newly active slide\n\t\t */\n\t\tfunction next() {\n\t\t\treturn select.call(this, callCallback.call(this, 'selectNext', active, {\n\t\t\t\tstepData: $(active).data('stepData')\n\t\t\t\t,substep: activeSubstep\n\t\t\t}), \"next\" );\n\t\t}\n\t\t/**\n\t\t * Goto Previous Slide\n\t\t *\n\t\t * @return Object newly active slide\n\t\t */\n\t\tfunction prev() {\n\t\t\treturn select.call(this, callCallback.call(this, 'selectPrev', active, {\n\t\t\t\tstepData: $(active).data('stepData')\n\t\t\t\t,substep: activeSubstep\n\t\t\t}), \"prev\" );\n\t\t}\n\t\t/**\n\t\t * Goto First Slide\n\t\t *\n\t\t * @return Object newly active slide\n\t\t */\n\t\tfunction home() {\n\t\t\treturn select.call(this, callCallback.call(this, 'selectHome', active, {\n\t\t\t\tstepData: $(active).data('stepData')\n\t\t\t}), \"home\" );\n\t\t}\n\t\t/**\n\t\t * Goto Last Slide\n\t\t *\n\t\t * @return Object newly active slide\n\t\t */\n\t\tfunction end() {\n\t\t\treturn select.call(this,   callCallback.call(this, 'selectEnd', active, {\n\t\t\t\tstepData: $(active).data('stepData')\n\t\t\t}), \"end\" );\n\t\t}\n\t\t/**\n\t\t * Manipulate the canvas\n\t\t *\n\t\t * @param props\n\t\t * @return Object\n\t\t */\n\t\tfunction canvasMod( props ) {\n\t\t\tcss(canvas, props || {});\n\t\t\treturn $(canvas);\n\t\t}\n\t\t/**\n\t\t * Return current step\n\t\t *\n\t\t * @return Object\n\t\t */\n\t\tfunction getActive() {\n\t\t\treturn activeDelegated && $(activeDelegated);\n\t\t}\n\t\t/**\n\t\t * fire a callback\n\t\t *\n\t\t * @param callbackName\n\t\t * @param element\n\t\t * @param eventData\n\t\t * @return void\n\t\t */\n\t\tfunction fire( callbackName, element, eventData ) {\n\t\t\tif( !callbacks[callbackName] ) {\n\t\t\t\t$.error( \"callback \" + callbackName + \" is not registered.\" );\n\t\t\t} else {\n\t\t\t\treturn callCallback.call(this, callbackName, element, eventData);\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * PUBLIC METHODS LIST\n\t\t */\n\t\tjmpress.data(\"jmpressmethods\", {\n\t\t\tselect: select\n\t\t\t,reselect: reselect\n\t\t\t,scrollFix: scrollFix\n\t\t\t,goTo: goTo\n\t\t\t,next: next\n\t\t\t,prev: prev\n\t\t\t,home: home\n\t\t\t,end: end\n\t\t\t,canvas: canvasMod\n\t\t\t,container: function() { return container; }\n\t\t\t,settings: function() { return settings; }\n\t\t\t,active: getActive\n\t\t\t,current: function() { return current; }\n\t\t\t,fire: fire\n\t\t\t,init: function(step) {\n\t\t\t\tdoStepInit.call(this, $(step), current.nextIdNumber++);\n\t\t\t}\n\t\t\t,deinit: function(step) {\n\t\t\t\tif(step) {\n\t\t\t\t\tdoStepDeinit.call(this, $(step));\n\t\t\t\t} else {\n\t\t\t\t\tdeinit.call(this);\n\t\t\t\t}\n\t\t\t}\n\t\t\t,reapply: doStepReapply\n\t\t});\n\n\t\t/**\n\t\t * Check for support\n\t\t * This will be removed in near future, when support is coming\n\t\t *\n\t\t * @access protected\n\t\t * @return void\n\t\t */\n\t\tfunction checkSupport() {\n\t\t\tvar ua = navigator.userAgent.toLowerCase();\n\t\t\treturn (ua.search(/(iphone)|(ipod)|(android)/) === -1) || (ua.search(/(chrome)/) !== -1);\n\t\t}\n\n\t\t// BEGIN INIT\n\n\t\t// CHECK FOR SUPPORT\n\t\tif (checkSupport() === false) {\n\t\t\tif (settings.notSupportedClass) {\n\t\t\t\tjmpress.addClass(settings.notSupportedClass);\n\t\t\t}\n\t\t\treturn;\n\t\t} else {\n\t\t\tif (settings.notSupportedClass) {\n\t\t\t\tjmpress.removeClass(settings.notSupportedClass);\n\t\t\t}\n\t\t}\n\n\t\t// grabbing all steps\n\t\tvar steps = $(settings.stepSelector, jmpress);\n\n\t\t// GERNERAL INIT OF FRAME\n\t\tcontainer = jmpress;\n\t\tarea = $('<div />');\n\t\tcanvas = $('<div />');\n\t\t$(jmpress).children().filter(steps).each(function() {\n\t\t\tcanvas.append( $( this ) );\n\t\t});\n\t\tif(settings.fullscreen) {\n\t\t\tcontainer = $('body');\n\t\t\t$(\"html\").css({\n\t\t\t\toverflow: 'hidden'\n\t\t\t});\n\t\t\tarea = jmpress;\n\t\t}\n\t\toldStyle.area = area.attr(\"style\") || \"\";\n\t\toldStyle.container = container.attr(\"style\") || \"\";\n\t\tif(settings.fullscreen) {\n\t\t\tcontainer.css({\n\t\t\t\theight: '100%'\n\t\t\t});\n\t\t\tjmpress.append( canvas );\n\t\t} else {\n\t\t\tcontainer.css({\n\t\t\t\tposition: \"relative\"\n\t\t\t});\n\t\t\tarea.append( canvas );\n\t\t\tjmpress.append( area );\n\t\t}\n\n\t\t$(container).addClass(settings.containerClass);\n\t\t$(area).addClass(settings.areaClass);\n\t\t$(canvas).addClass(settings.canvasClass);\n\n\t\tdocument.documentElement.style.height = \"100%\";\n\t\tcontainer.css({\n\t\t\toverflow: 'hidden'\n\t\t});\n\n\t\tvar props = {\n\t\t\tposition: \"absolute\"\n\t\t\t,transitionDuration: '0s'\n\t\t};\n\t\tprops = $.extend({}, settings.animation, props);\n\t\tcss(area, props);\n\t\tcss(area, {\n\t\t\ttop: '50%'\n\t\t\t,left: '50%'\n\t\t\t,perspective: '1000px'\n\t\t});\n\t\tcss(canvas, props);\n\n\t\tcurrent = {};\n\n\t\tcallCallback.call(this, 'beforeInit', null, {});\n\n\t\t// INITIALIZE EACH STEP\n\t\tsteps.each(function( idx ) {\n\t\t\tdoStepInit.call(jmpress, this, idx );\n\t\t});\n\t\tcurrent.nextIdNumber = steps.length;\n\n\t\tcallCallback.call(this, 'afterInit', null, {});\n\n\t\t// START\n\t\tselect.call(this,  callCallback.call(this, 'selectInitialStep', \"init\", {}) );\n\n\t\tif (settings.initClass) {\n\t\t\t$(steps).removeClass(settings.initClass);\n\t\t}\n\t}\n\t/**\n\t * Return default settings\n\t *\n\t * @return Object\n\t */\n\tfunction getDefaults() {\n\t\treturn defaults;\n\t}\n\t/**\n\t * Register a callback or a jmpress function\n\t *\n\t * @access public\n\t * @param name String the name of the callback or function\n\t * @param func Function? the function to be added\n\t */\n\tfunction register(name, func) {\n\t\tif( $.isFunction(func) ) {\n\t\t\tif( methods[name] ) {\n\t\t\t\t$.error( \"function \" + name + \" is already registered.\" );\n\t\t\t} else {\n\t\t\t\tmethods[name] = func;\n\t\t\t}\n\t\t} else {\n\t\t\tif( callbacks[name] ) {\n\t\t\t\t$.error( \"callback \" + name + \" is already registered.\" );\n\t\t\t} else {\n\t\t\t\tcallbacks[name] = 1;\n\t\t\t\tdefaults[name] = [];\n\t\t\t}\n\t\t}\n\t}\n\t/**\n\t * Set CSS on element w/ prefixes\n\t *\n\t * @return Object element which properties were set\n\t *\n\t * TODO: Consider bypassing pfx and blindly set as jQuery\n\t * already checks for support\n\t */\n\tfunction css( el, props ) {\n\t\tvar key, pkey, cssObj = {};\n\t\tfor ( key in props ) {\n\t\t\tif ( props.hasOwnProperty(key) ) {\n\t\t\t\tpkey = pfx(key);\n\t\t\t\tif ( pkey !== null ) {\n\t\t\t\t\tcssObj[pkey] = props[key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t$(el).css(cssObj);\n\t\treturn el;\n\t}\n\t/**\n\t * Return dataset for element\n\t *\n\t * @param el element\n\t * @return Object\n\t */\n\tfunction dataset( el ) {\n\t\tif ( $(el)[0].dataset ) {\n\t\t\treturn $.extend({}, $(el)[0].dataset);\n\t\t}\n\t\tfunction toCamelcase( str ) {\n\t\t\tstr = str.split( '-' );\n\t\t\tfor( var i = 1; i < str.length; i++ ) {\n\t\t\t\tstr[i] = str[i].substr(0, 1).toUpperCase() + str[i].substr(1);\n\t\t\t}\n\t\t\treturn str.join( '' );\n\t\t}\n\t\tvar returnDataset = {};\n\t\tvar attrs = $(el)[0].attributes;\n\t\t$.each(attrs, function ( idx, attr ) {\n\t\t\tif ( attr.nodeName.substr(0, 5) === \"data-\" ) {\n\t\t\t\treturnDataset[ toCamelcase(attr.nodeName.substr(5)) ] = attr.nodeValue;\n\t\t\t}\n\t\t});\n\t\treturn returnDataset;\n\t}\n\t/**\n\t * Returns true, if jmpress is initialized\n\t *\n\t * @return bool\n\t */\n\tfunction initialized() {\n\t\treturn !!$(this).data(\"jmpressmethods\");\n\t}\n\n\n\t/**\n\t * PUBLIC STATIC METHODS LIST\n\t */\n\tvar methods = {\n\t\tinit: init\n\t\t,initialized: initialized\n\t\t,deinit: function() {}\n\t\t,css: css\n\t\t,pfx: pfx\n\t\t,defaults: getDefaults\n\t\t,register: register\n\t\t,dataset: dataset\n\t};\n\n\t/**\n\t * $.jmpress()\n\t */\n\t$.fn.jmpress = function( method ) {\n\t\tfunction f() {\n\t\t\tvar jmpressmethods = $(this).data(\"jmpressmethods\");\n\t\t\tif ( jmpressmethods && jmpressmethods[method] ) {\n\t\t\t\treturn jmpressmethods[method].apply( this, Array.prototype.slice.call( arguments, 1 ));\n\t\t\t} else if ( methods[method] ) {\n\t\t\t\treturn methods[method].apply( this, Array.prototype.slice.call( arguments, 1 ));\n\t\t\t} else if ( callbacks[method] && jmpressmethods ) {\n\t\t\t\tvar settings = jmpressmethods.settings();\n\t\t\t\tvar func = Array.prototype.slice.call( arguments, 1 )[0];\n\t\t\t\tif ($.isFunction( func )) {\n\t\t\t\t\tsettings[method] = settings[method] || [];\n\t\t\t\t\tsettings[method].push(func);\n\t\t\t\t}\n\t\t\t} else if ( typeof method === 'object' || ! method ) {\n\t\t\t\treturn init.apply( this, arguments );\n\t\t\t} else {\n\t\t\t\t$.error( 'Method ' +  method + ' does not exist on jQuery.jmpress' );\n\t\t\t}\n\t\t\t// to allow chaining\n\t\t\treturn this;\n\t\t}\n\t\tvar args = arguments;\n\t\tvar result;\n\t\t$(this).each(function(idx, element) {\n\t\t\tresult = f.apply(element, args);\n\t\t});\n\t\treturn result;\n\t};\n\t$.extend({\n\t\tjmpress: function( method ) {\n\t\t\tif ( methods[method] ) {\n\t\t\t\treturn methods[method].apply( this, Array.prototype.slice.call( arguments, 1 ));\n\t\t\t} else if ( callbacks[method] ) {\n\t\t\t\t// plugin interface\n\t\t\t\tvar func = Array.prototype.slice.call( arguments, 1 )[0];\n\t\t\t\tif ($.isFunction( func )) {\n\t\t\t\t\tdefaults[method].push(func);\n\t\t\t\t} else {\n\t\t\t\t\t$.error( 'Second parameter should be a function: $.jmpress( callbackName, callbackFunction )' );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t$.error( 'Method ' +  method + ' does not exist on jQuery.jmpress' );\n\t\t\t}\n\t\t}\n\t});\n\n}(jQuery, document, window));\n\n/*\n * near.js\n * Find steps near each other\n */\n(function( $, document, window, undefined ) {\n\n\t'use strict';\n\n\t// add near( selector, backwards = false) to jquery\n\n\n\tfunction checkAndGo( elements, func, selector, backwards ) {\n\t\tvar next;\n\t\telements.each(function(idx, element) {\n\t\t\tif(backwards) {\n\t\t\t\tnext = func(element, selector, backwards);\n\t\t\t\tif (next) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( $(element).is(selector) ) {\n\t\t\t\tnext = element;\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif(!backwards) {\n\t\t\t\tnext = func(element, selector, backwards);\n\t\t\t\tif (next) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\treturn next;\n\t}\n\tfunction findNextInChildren(item, selector, backwards) {\n\t\tvar children = $(item).children();\n\t\tif(backwards) {\n\t\t\tchildren = $(children.get().reverse());\n\t\t}\n\t\treturn checkAndGo( children, findNextInChildren, selector, backwards );\n\t}\n\tfunction findNextInSiblings(item, selector, backwards) {\n\t\treturn checkAndGo(\n\t\t\t$(item)[backwards ? \"prevAll\" : \"nextAll\"](),\n\t\t\tfindNextInChildren, selector, backwards );\n\t}\n\tfunction findNextInParents(item, selector, backwards) {\n\t\tvar next;\n\t\tvar parents = $(item).parents();\n\t\tparents = $(parents.get());\n\t\t$.each(parents.get(), function(idx, element) {\n\t\t\tif( backwards && $(element).is(selector) ) {\n\t\t\t\tnext = element;\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tnext = findNextInSiblings(element, selector, backwards);\n\t\t\tif(next) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t\treturn next;\n\t}\n\n\t$.fn.near = function( selector, backwards ) {\n\t\tvar array = [];\n\t\t$(this).each(function(idx, element) {\n\t\t\tvar near = (backwards ?\n\t\t\t\t\tfalse :\n\t\t\t\t\tfindNextInChildren( element, selector, backwards )) ||\n\t\t\t\tfindNextInSiblings( element, selector, backwards ) ||\n\t\t\t\tfindNextInParents( element, selector, backwards );\n\t\t\tif( near ) {\n\t\t\t\tarray.push(near);\n\t\t\t}\n\t\t});\n\t\treturn $(array);\n\t};\n}(jQuery, document, window));\n/*\n * transform.js\n * The engine that powers the transforms or falls back to other methods\n */\n(function( $, document, window, undefined ) {\n\n\t'use strict';\n\n\t/* FUNCTIONS */\n\tfunction toCssNumber(number) {\n\t\treturn (Math.round(10000*number)/10000)+\"\";\n\t}\n\n\t/**\n\t * 3D and 2D engines\n\t */\n\tvar engines = {\n\t\t3: {\n\t\t\ttransform: function( el, data ) {\n\t\t\t\tvar transform = 'translate(-50%,-50%)';\n\t\t\t\t$.each(data, function(idx, item) {\n\t\t\t\t\tvar coord = [\"X\", \"Y\", \"Z\"];\n\t\t\t\t\tvar i;\n\t\t\t\t\tif(item[0] === \"translate\") { // [\"translate\", x, y, z]\n\t\t\t\t\t\ttransform += \" translate3d(\" + toCssNumber(item[1] || 0) + \"px,\" + toCssNumber(item[2] || 0) + \"px,\" + toCssNumber(item[3] || 0) + \"px)\";\n\t\t\t\t\t} else if(item[0] === \"rotate\") {\n\t\t\t\t\t\tvar order = item[4] ? [1, 2, 3] : [3, 2, 1];\n\t\t\t\t\t\tfor(i = 0; i < 3; i++) {\n\t\t\t\t\t\t\ttransform += \" rotate\" + coord[order[i]-1] + \"(\" + toCssNumber(item[order[i]] || 0) + \"deg)\";\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if(item[0] === \"scale\") {\n\t\t\t\t\t\tfor(i = 0; i < 3; i++) {\n\t\t\t\t\t\t\ttransform += \" scale\" + coord[i] + \"(\" + toCssNumber(item[i+1] || 1) + \")\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t$.jmpress(\"css\", el, $.extend({}, { transform: transform }));\n\t\t\t}\n\t\t}\n\t\t,2: {\n\t\t\ttransform: function( el, data ) {\n\t\t\t\tvar transform = 'translate(-50%,-50%)';\n\t\t\t\t$.each(data, function(idx, item) {\n\t\t\t\t\tvar coord = [\"X\", \"Y\"];\n\t\t\t\t\tif(item[0] === \"translate\") { // [\"translate\", x, y, z]\n\t\t\t\t\t\ttransform += \" translate(\" + toCssNumber(item[1] || 0) + \"px,\" + toCssNumber(item[2] || 0) + \"px)\";\n\t\t\t\t\t} else if(item[0] === \"rotate\") {\n\t\t\t\t\t\ttransform += \" rotate(\" + toCssNumber(item[3] || 0) + \"deg)\";\n\t\t\t\t\t} else if(item[0] === \"scale\") {\n\t\t\t\t\t\tfor(var i = 0; i < 2; i++) {\n\t\t\t\t\t\t\ttransform += \" scale\" + coord[i] + \"(\" + toCssNumber(item[i+1] || 1) + \")\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t$.jmpress(\"css\", el, $.extend({}, { transform: transform }));\n\t\t\t}\n\t\t}\n\t\t,1: {\n\t\t\t// CHECK IF SUPPORT IS REALLY NEEDED?\n\t\t\t// this not even work without scaling...\n\t\t\t// it may better to display the normal view\n\t\t\ttransform: function( el, data ) {\n\t\t\t\tvar anitarget = { top: 0, left: 0 };\n\t\t\t\t$.each(data, function(idx, item) {\n\t\t\t\t\tvar coord = [\"X\", \"Y\"];\n\t\t\t\t\tif(item[0] === \"translate\") { // [\"translate\", x, y, z]\n\t\t\t\t\t\tanitarget.left = Math.round(item[1] || 0) + \"px\";\n\t\t\t\t\t\tanitarget.top = Math.round(item[2] || 0) + \"px\";\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tel.animate(anitarget, 1000); // TODO: Use animation duration\n\t\t\t}\n\t\t}\n\t};\n\n\t/**\n\t * Engine to power cross-browser translate, scale and rotate.\n\t */\n\tvar engine = (function() {\n\t\tif ($.jmpress(\"pfx\", \"perspective\")) {\n\t\t\treturn engines[3];\n\t\t} else if ($.jmpress(\"pfx\", \"transform\")) {\n\t\t\treturn engines[2];\n\t\t} else {\n\t\t\t// CHECK IF SUPPORT IS REALLY NEEDED?\n\t\t\treturn engines[1];\n\t\t}\n\t}());\n\n\t$.jmpress(\"defaults\").reasonableAnimation = {};\n\t$.jmpress(\"initStep\", function( step, eventData ) {\n\t\tvar data = eventData.data;\n\t\tvar stepData = eventData.stepData;\n\t\tvar pf = parseFloat;\n\t\t$.extend(stepData, {\n\t\t\tx: pf(data.x) || 0\n\t\t\t,y: pf(data.y) || 0\n\t\t\t,z: pf(data.z) || 0\n\t\t\t,r: pf(data.r) || 0\n\t\t\t,phi: pf(data.phi) || 0\n\t\t\t,rotate: pf(data.rotate) || 0\n\t\t\t,rotateX: pf(data.rotateX) || 0\n\t\t\t,rotateY: pf(data.rotateY) || 0\n\t\t\t,rotateZ: pf(data.rotateZ) || 0\n\t\t\t,revertRotate: false\n\t\t\t,scale: pf(data.scale) || 1\n\t\t\t,scaleX: pf(data.scaleX) || false\n\t\t\t,scaleY: pf(data.scaleY) || false\n\t\t\t,scaleZ: pf(data.scaleZ) || 1\n\t\t});\n\t});\n\t$.jmpress(\"afterInit\", function( nil, eventData ) {\n\t\tvar stepSelector = eventData.settings.stepSelector,\n\t\t\tcurrent = eventData.current;\n\t\tcurrent.perspectiveScale = 1;\n\t\tcurrent.maxNestedDepth = 0;\n\t\tvar nestedSteps = $(eventData.jmpress).find(stepSelector).children(stepSelector);\n\t\twhile(nestedSteps.length) {\n\t\t\tcurrent.maxNestedDepth++;\n\t\t\tnestedSteps = nestedSteps.children(stepSelector);\n\t\t}\n\t});\n\t$.jmpress(\"applyStep\", function( step, eventData ) {\n\t\t$.jmpress(\"css\", $(step), {\n\t\t\tposition: \"absolute\"\n\t\t\t,transformStyle: \"preserve-3d\"\n\t\t});\n\t\tif ( eventData.parents.length > 0 ) {\n\t\t\t$.jmpress(\"css\", $(step), {\n\t\t\t\ttop: \"50%\"\n\t\t\t\t,left: \"50%\"\n\t\t\t});\n\t\t}\n\t\tvar sd = eventData.stepData;\n\t\tvar transform = [\n\t\t\t[\"translate\",\n\t\t\t\tsd.x || (sd.r * Math.sin(sd.phi*Math.PI/180)),\n\t\t\t\tsd.y || (-sd.r * Math.cos(sd.phi*Math.PI/180)),\n\t\t\t\tsd.z],\n\t\t\t[\"rotate\",\n\t\t\t\tsd.rotateX,\n\t\t\t\tsd.rotateY,\n\t\t\t\tsd.rotateZ || sd.rotate,\n\t\t\t\ttrue],\n\t\t\t[\"scale\",\n\t\t\t\tsd.scaleX || sd.scale,\n\t\t\t\tsd.scaleY || sd.scale,\n\t\t\t\tsd.scaleZ || sd.scale]\n\t\t];\n\t\tengine.transform( step, transform );\n\t});\n\t$.jmpress(\"setActive\", function( element, eventData ) {\n\t\tvar target = eventData.target;\n\t\tvar step = eventData.stepData;\n\t\tvar tf = target.transform = [];\n\t\ttarget.perspectiveScale = 1;\n\n\t\tfor(var i = eventData.current.maxNestedDepth; i > (eventData.parents.length || 0); i--) {\n\t\t\ttf.push([\"scale\"], [\"rotate\"], [\"translate\"]);\n\t\t}\n\n\t\ttf.push([\"scale\",\n\t\t\t1 / (step.scaleX || step.scale),\n\t\t\t1 / (step.scaleY || step.scale),\n\t\t\t1 / (step.scaleZ)]);\n\t\ttf.push([\"rotate\",\n\t\t\t-step.rotateX,\n\t\t\t-step.rotateY,\n\t\t\t-(step.rotateZ || step.rotate)]);\n\t\ttf.push([\"translate\",\n\t\t\t-(step.x || (step.r * Math.sin(step.phi*Math.PI/180))),\n\t\t\t-(step.y || (-step.r * Math.cos(step.phi*Math.PI/180))),\n\t\t\t-step.z]);\n\t\ttarget.perspectiveScale *= (step.scaleX || step.scale);\n\n\t\t$.each(eventData.parents, function(idx, element) {\n\t\t\tvar step = $(element).data(\"stepData\");\n\t\t\ttf.push([\"scale\",\n\t\t\t\t1 / (step.scaleX || step.scale),\n\t\t\t\t1 / (step.scaleY || step.scale),\n\t\t\t\t1 / (step.scaleZ)]);\n\t\t\ttf.push([\"rotate\",\n\t\t\t\t-step.rotateX,\n\t\t\t\t-step.rotateY,\n\t\t\t\t-(step.rotateZ || step.rotate)]);\n\t\t\ttf.push([\"translate\",\n\t\t\t\t-(step.x || (step.r * Math.sin(step.phi*Math.PI/180))),\n\t\t\t\t-(step.y || (-step.r * Math.cos(step.phi*Math.PI/180))),\n\t\t\t\t-step.z]);\n\t\t\ttarget.perspectiveScale *= (step.scaleX || step.scale);\n\t\t});\n\n\t\t$.each(tf, function(idx, item) {\n\t\t\tif(item[0] !== \"rotate\") {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tfunction lowRotate(name) {\n\t\t\t\tif(eventData.current[\"rotate\"+name+\"-\"+idx] === undefined) {\n\t\t\t\t\teventData.current[\"rotate\"+name+\"-\"+idx] = item[name] || 0;\n\t\t\t\t}\n\t\t\t\tvar cur = eventData.current[\"rotate\"+name+\"-\"+idx], tar = item[name] || 0,\n\t\t\t\t\tcurmod = cur % 360, tarmod = tar % 360;\n\t\t\t\tif(curmod < 0) {\n\t\t\t\t\tcurmod += 360;\n\t\t\t\t}\n\t\t\t\tif(tarmod < 0) {\n\t\t\t\t\ttarmod += 360;\n\t\t\t\t}\n\t\t\t\tvar diff = tarmod - curmod;\n\t\t\t\tif(diff < -180) {\n\t\t\t\t\tdiff += 360;\n\t\t\t\t} else if(diff > 180) {\n\t\t\t\t\tdiff -= 360;\n\t\t\t\t}\n\t\t\t\teventData.current[\"rotate\"+name+\"-\"+idx] = item[name] = cur + diff;\n\t\t\t}\n\t\t\tlowRotate(1);\n\t\t\tlowRotate(2);\n\t\t\tlowRotate(3);\n\t\t});\n\t});\n\t$.jmpress(\"applyTarget\", function( active, eventData ) {\n\n\t\tvar target = eventData.target,\n\t\t\tprops, step = eventData.stepData,\n\t\t\tsettings = eventData.settings,\n\t\t\tzoomin = target.perspectiveScale * 1.3 < eventData.current.perspectiveScale,\n\t\t\tzoomout = target.perspectiveScale > eventData.current.perspectiveScale * 1.3;\n\n\t\t// extract first scale from transform\n\t\tvar lastScale = -1;\n\t\t$.each(target.transform, function(idx, item) {\n\t\t\tif(item.length <= 1) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(item[0] === \"rotate\" &&\n\t\t\t\titem[1] % 360 === 0  &&\n\t\t\t\titem[2] % 360 === 0  &&\n\t\t\t\titem[3] % 360 === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(item[0] === \"scale\") {\n\t\t\t\tlastScale = idx;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\n\t\tif(lastScale !== eventData.current.oldLastScale) {\n\t\t\tzoomin = zoomout = false;\n\t\t\teventData.current.oldLastScale = lastScale;\n\t\t}\n\n\t\tvar extracted = [];\n\t\tif(lastScale !== -1) {\n\t\t\twhile(lastScale >= 0) {\n\t\t\t\tif(target.transform[lastScale][0] === \"scale\") {\n\t\t\t\t\textracted.push(target.transform[lastScale]);\n\t\t\t\t\ttarget.transform[lastScale] = [\"scale\"];\n\t\t\t\t}\n\t\t\t\tlastScale--;\n\t\t\t}\n\t\t}\n\n\t\tvar animation = settings.animation;\n\t\tif(settings.reasonableAnimation[eventData.reason]) {\n\t\t\tanimation = $.extend({},\n\t\t\t\tanimation,\n\t\t\t\tsettings.reasonableAnimation[eventData.reason]);\n\t\t}\n\n\t\tprops = {\n\t\t\t// to keep the perspective look similar for different scales\n\t\t\t// we need to 'scale' the perspective, too\n\t\t\tperspective: Math.round(target.perspectiveScale * 1000) + \"px\"\n\t\t};\n\t\tprops = $.extend({}, animation, props);\n\t\tif (!zoomin) {\n\t\t\tprops.transitionDelay = '0s';\n\t\t}\n\t\tif (!eventData.beforeActive) {\n\t\t\tprops.transitionDuration = '0s';\n\t\t\tprops.transitionDelay = '0s';\n\t\t}\n\t\t$.jmpress(\"css\", eventData.area, props);\n\t\tengine.transform(eventData.area, extracted);\n\n\t\tprops = $.extend({}, animation);\n\t\tif (!zoomout) {\n\t\t\tprops.transitionDelay = '0s';\n\t\t}\n\t\tif (!eventData.beforeActive) {\n\t\t\tprops.transitionDuration = '0s';\n\t\t\tprops.transitionDelay = '0s';\n\t\t}\n\n\t\teventData.current.perspectiveScale = target.perspectiveScale;\n\n\t\t$.jmpress(\"css\", eventData.canvas, props);\n\t\tengine.transform(eventData.canvas, target.transform);\n\t});\n\n}(jQuery, document, window));\n/*\n * active.js\n * Set the active classes on steps\n */\n(function( $, document, window, undefined ) {\n\n\t'use strict';\n\tvar $jmpress = $.jmpress;\n\n\t/* DEFINES */\n\tvar activeClass = 'activeClass',\n\t\tnestedActiveClass = 'nestedActiveClass';\n\n\t/* DEFAULTS */\n\tvar defaults = $jmpress( 'defaults' );\n\tdefaults[nestedActiveClass] = \"nested-active\";\n\tdefaults[activeClass]       = \"active\";\n\n\t/* HOOKS */\n\t$jmpress( 'setInactive', function( step, eventData ) {\n\t\tvar settings = eventData.settings,\n\t\t\tactiveClassSetting = settings[activeClass],\n\t\t\tnestedActiveClassSettings = settings[nestedActiveClass];\n\t\tif(activeClassSetting) {\n\t\t\t$(step).removeClass( activeClassSetting );\n\t\t}\n\t\tif(nestedActiveClassSettings) {\n\t\t\t$.each(eventData.parents, function(idx, element) {\n\t\t\t\t$(element).removeClass(nestedActiveClassSettings);\n\t\t\t});\n\t\t}\n\t});\n\t$jmpress( 'setActive', function( step, eventData ) {\n\t\tvar settings = eventData.settings,\n\t\t\tactiveClassSetting = settings[activeClass],\n\t\t\tnestedActiveClassSettings = settings[nestedActiveClass];\n\t\tif(activeClassSetting) {\n\t\t\t$(step).addClass( activeClassSetting );\n\t\t}\n\t\tif(nestedActiveClassSettings) {\n\t\t\t$.each(eventData.parents, function(idx, element) {\n\t\t\t\t$(element).addClass(nestedActiveClassSettings);\n\t\t\t});\n\t\t}\n\t});\n\n}(jQuery, document, window));\n/*\n * circular.js\n * Repeat from start after end\n */\n(function( $, document, window, undefined ) {\n\n\t'use strict';\n\tvar $jmpress = $.jmpress;\n\n\t/* FUNCTIONS */\n\tfunction firstSlide( step, eventData ) {\n\t\treturn $(this).find(eventData.settings.stepSelector).first();\n\t}\n\tfunction prevOrNext( jmpress, step, eventData, prev) {\n\t\tif (!step) {\n\t\t\treturn false;\n\t\t}\n\t\tvar stepSelector = eventData.settings.stepSelector;\n\t\tstep = $(step);\n\t\tdo {\n\t\t\tvar item = step.near( stepSelector, prev );\n\t\t\tif (item.length === 0 || item.closest(jmpress).length === 0) {\n\t\t\t\titem = $(jmpress).find(stepSelector)[prev?\"last\":\"first\"]();\n\t\t\t}\n\t\t\tif (!item.length) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tstep = item;\n\t\t} while( step.data(\"stepData\").exclude );\n\t\treturn step;\n\t}\n\n\t/* HOOKS */\n\t$jmpress( 'initStep', function( step, eventData ) {\n\t\teventData.stepData.exclude = eventData.data.exclude && [\"false\", \"no\"].indexOf(eventData.data.exclude) === -1;\n\t});\n\t$jmpress( 'selectInitialStep', firstSlide);\n\t$jmpress( 'selectHome', firstSlide);\n\t$jmpress( 'selectEnd', function( step, eventData ) {\n\t\treturn $(this).find(eventData.settings.stepSelector).last();\n\t});\n\t$jmpress( 'selectPrev', function( step, eventData ) {\n\t\treturn prevOrNext(this, step, eventData, true);\n\t});\n\t$jmpress( 'selectNext', function( step, eventData ) {\n\t\treturn prevOrNext(this, step, eventData);\n\t});\n}(jQuery, document, window));\n/*\n * start.js\n * Set the first step to start on\n */\n(function( $, document, window, undefined ) {\n\n\t'use strict';\n\n\t/* HOOKS */\n\t$.jmpress( 'selectInitialStep', function( nil, eventData ) {\n\t\treturn eventData.settings.start;\n\t});\n\n}(jQuery, document, window));\n/*\n * ways.js\n * Control the flow of the steps\n */\n(function( $, document, window, undefined ) {\n\n\t'use strict';\n\tvar $jmpress = $.jmpress;\n\n\t/* FUNCTIONS */\n\tfunction routeFunc( jmpress, route, type ) {\n\t\tfor(var i = 0; i < route.length - 1; i++) {\n\t\t\tvar from = route[i];\n\t\t\tvar to = route[i+1];\n\t\t\tif($(jmpress).jmpress(\"initialized\")) {\n\t\t\t\t$(from, jmpress).data(\"stepData\")[type] = to;\n\t\t\t} else {\n\t\t\t\t$(from, jmpress).attr('data-' + type, to);\n\t\t\t}\n\t\t}\n\t}\n\tfunction selectPrevOrNext( step, eventData, attr, prev ) {\n\t\tvar stepData = eventData.stepData;\n\t\tif(stepData[attr]) {\n\t\t\tvar near = $(step).near(stepData[attr], prev);\n\t\t\tif(near && near.length) {\n\t\t\t\treturn near;\n\t\t\t}\n\t\t\tnear = $(stepData[attr], this)[prev?\"last\":\"first\"]();\n\t\t\tif(near && near.length) {\n\t\t\t\treturn near;\n\t\t\t}\n\t\t}\n\t}\n\n\t/* EXPORTED FUNCTIONS */\n\t$jmpress( 'register', 'route', function( route, unidirectional, reversedRoute ) {\n\t\tif( typeof route === \"string\" ) {\n\t\t\troute = [route, route];\n\t\t}\n\t\trouteFunc(this, route, reversedRoute ? \"prev\" : \"next\");\n\t\tif (!unidirectional) {\n\t\t\trouteFunc(this, route.reverse(), reversedRoute ? \"next\" : \"prev\");\n\t\t}\n\t});\n\n\t/* HOOKS */\n\t$jmpress( 'initStep', function( step, eventData ) {\n\t\tfor(var attr in {next:1,prev:1}) {\n\t\t\teventData.stepData[attr] = eventData.data[attr];\n\t\t}\n\t});\n\t$jmpress( 'selectNext', function( step, eventData ) {\n\t\treturn selectPrevOrNext.call(this, step, eventData, \"next\");\n\t});\n\t$jmpress( 'selectPrev', function( step, eventData ) {\n\t\treturn selectPrevOrNext.call(this, step, eventData, \"prev\", true);\n\t});\n\n}(jQuery, document, window));\n/*\n * ajax.js\n * Load steps via ajax\n */\n(function( $, document, window, undefined ) {\n\n\t'use strict';\n\tvar $jmpress = $.jmpress;\n\n\t/* DEFINES */\n\tvar afterStepLoaded = 'ajax:afterStepLoaded',\n\t\tloadStep = 'ajax:loadStep';\n\n\t/* REGISTER EVENTS */\n\t$jmpress('register', loadStep);\n\t$jmpress('register', afterStepLoaded);\n\n\t/* DEFAULTS */\n\t$jmpress('defaults').ajaxLoadedClass = \"loaded\";\n\n\t/* HOOKS */\n\t$jmpress('initStep', function( step, eventData ) {\n\t\teventData.stepData.src = $(step).attr('href') || eventData.data.src || false;\n\t\teventData.stepData.srcLoaded = false;\n\t});\n\t$jmpress(loadStep, function( step, eventData ) {\n\t\tvar stepData = eventData.stepData,\n\t\t\thref = stepData && stepData.src,\n\t\t\tsettings = eventData.settings;\n\t\tif ( href ) {\n\t\t\t$(step).addClass( settings.ajaxLoadedClass );\n\t\t\tstepData.srcLoaded = true;\n\t\t\t$(step).load(href, function(response, status, xhr) {\n\t\t\t\t$(eventData.jmpress).jmpress('fire', afterStepLoaded, step, $.extend({}, eventData, {\n\t\t\t\t\tresponse: response\n\t\t\t\t\t,status: status\n\t\t\t\t\t,xhr: xhr\n\t\t\t\t}));\n\t\t\t});\n\t\t}\n\t});\n\t$jmpress('idle', function( step, eventData ) {\n\t\tif (!step) {\n\t\t\treturn;\n\t\t}\n\t\tvar settings = eventData.settings,\n\t\t\tjmpress = $(this),\n\t\t\tstepData = eventData.stepData;\n\t\tvar siblings = $(step)\n\t\t\t.add( $(step).near( settings.stepSelector ) )\n\t\t\t.add( $(step).near( settings.stepSelector, true) )\n\t\t\t.add( jmpress.jmpress('fire', 'selectPrev', step, {\n\t\t\t\tstepData: $(step).data('stepData')\n\t\t\t}))\n\t\t\t.add( jmpress.jmpress('fire', 'selectNext', step, {\n\t\t\t\tstepData: $(step).data('stepData')\n\t\t\t}));\n\t\tsiblings.each(function() {\n\t\t\tvar step = this,\n\t\t\t\tstepData = $(step).data(\"stepData\");\n\t\t\tif(!stepData.src || stepData.srcLoaded) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tjmpress.jmpress('fire', loadStep, step, {\n\t\t\t\tstepData: $(step).data('stepData')\n\t\t\t});\n\t\t});\n\t});\n\t$jmpress(\"setActive\", function(step, eventData) {\n\t\tvar stepData = $(step).data(\"stepData\");\n\t\tif(!stepData.src || stepData.srcLoaded) {\n\t\t\treturn;\n\t\t}\n\t\t$(this).jmpress('fire', loadStep, step, {\n\t\t\tstepData: $(step).data('stepData')\n\t\t});\n\t});\n\n}(jQuery, document, window));\n/*\n * hash.js\n * Detect and set the URL hash\n */\n(function( $, document, window, undefined ) {\n\n\t'use strict';\n\tvar $jmpress = $.jmpress,\n\t\thashLink = \"a[href^='#']\";\n\n\t/* FUNCTIONS */\n\tfunction randomString() {\n\t\treturn \"\" + Math.round(Math.random() * 100000, 0);\n\t}\n\t/**\n\t * getElementFromUrl\n\t *\n\t * @return String or undefined\n\t */\n\tfunction getElementFromUrl(settings) {\n\t\t// get id from url # by removing `#` or `#/` from the beginning,\n\t\t// so both \"fallback\" `#slide-id` and \"enhanced\" `#/slide-id` will work\n\t\t// TODO SECURITY check user input to be valid!\n\t\ttry {\n\t\t\tvar el = $( '#' + window.location.hash.replace(/^#\\/?/,\"\") );\n\t\t\treturn el.length > 0 && el.is(settings.stepSelector) ? el : undefined;\n\t\t} catch(e) {}\n\t}\n\tfunction setHash(stepid) {\n\t\tvar shouldBeHash = \"#/\" + stepid;\n\t\tif(window.history && window.history.pushState) {\n\t\t\t// shouldBeHash = \"#\" + stepid;\n\t\t\t// consider this for future versions\n\t\t\t//  it has currently issues, when startup with a link with hash (webkit)\n\t\t\tif(window.location.hash !== shouldBeHash) {\n\t\t\t\twindow.history.pushState({}, '', shouldBeHash);\n\t\t\t}\n\t\t} else {\n\t\t\tif(window.location.hash !== shouldBeHash) {\n\t\t\t\twindow.location.hash = shouldBeHash;\n\t\t\t}\n\t\t}\n\t}\n\n\t/* DEFAULTS */\n\t$jmpress('defaults').hash = {\n\t\tuse: true\n\t\t,update: true\n\t\t,bindChange: true\n\t\t// NOTICE: {use: true, update: false, bindChange: true}\n\t\t// will cause a error after clicking on a link to the current step\n\t};\n\n\t/* HOOKS */\n\t$jmpress('selectInitialStep', function( step, eventData ) {\n\t\tvar settings = eventData.settings,\n\t\t\thashSettings = settings.hash,\n\t\t\tcurrent = eventData.current,\n\t\t\tjmpress = $(this);\n\t\teventData.current.hashNamespace = \".jmpress-\"+randomString();\n\t\t// HASH CHANGE EVENT\n\t\tif ( hashSettings.use ) {\n\t\t\tif ( hashSettings.bindChange ) {\n\t\t\t\t$(window).bind('hashchange'+current.hashNamespace, function(event) {\n\t\t\t\t\tvar urlItem = getElementFromUrl(settings);\n\t\t\t\t\tif ( jmpress.jmpress('initialized') ) {\n\t\t\t\t\t\tjmpress.jmpress(\"scrollFix\");\n\t\t\t\t\t}\n\t\t\t\t\tif(urlItem && urlItem.length) {\n\t\t\t\t\t\tif(urlItem.attr(\"id\") !== jmpress.jmpress(\"active\").attr(\"id\")) {\n\t\t\t\t\t\t\tjmpress.jmpress('select', urlItem);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsetHash(urlItem.attr(\"id\"));\n\t\t\t\t\t}\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t});\n\t\t\t\t$(hashLink).on(\"click\"+current.hashNamespace, function(event) {\n\t\t\t\t\tvar href = $(this).attr(\"href\");\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif($(href).is(settings.stepSelector)) {\n\t\t\t\t\t\t\tjmpress.jmpress(\"select\", href);\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch(e) {}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn getElementFromUrl(settings);\n\t\t}\n\t});\n\t$jmpress('afterDeinit', function( nil, eventData ) {\n\t\t$(hashLink).off(eventData.current.hashNamespace);\n\t\t$(window).unbind(eventData.current.hashNamespace);\n\t});\n\t$jmpress('setActive', function( step, eventData ) {\n\t\tvar settings = eventData.settings,\n\t\t\tcurrent = eventData.current;\n\t\t// `#/step-id` is used instead of `#step-id` to prevent default browser\n\t\t// scrolling to element in hash\n\t\tif ( settings.hash.use && settings.hash.update ) {\n\t\t\tclearTimeout(current.hashtimeout);\n\t\t\tcurrent.hashtimeout = setTimeout(function() {\n\t\t\t\tsetHash($(eventData.delegatedFrom).attr('id'));\n\t\t\t}, settings.transitionDuration + 200);\n\t\t}\n\t});\n\n}(jQuery, document, window));\n/*\n * keyboard.js\n * Keyboard event mapping and default keyboard actions\n */\n(function( $, document, window, undefined ) {\n\n\t'use strict';\n\tvar $jmpress = $.jmpress,\n\t\tjmpressNext = \"next\",\n\t\tjmpressPrev = \"prev\";\n\n\t/* FUNCTIONS */\n\tfunction randomString() {\n\t\treturn \"\" + Math.round(Math.random() * 100000, 0);\n\t}\n\tfunction stopEvent(event) {\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t}\n\n\t/* DEFAULTS */\n\t$jmpress('defaults').keyboard = {\n\t\tuse: true\n\t\t,keys: {\n\t\t\t33: jmpressPrev // pg up\n\t\t\t,37: jmpressPrev // left\n\t\t\t,38: jmpressPrev // up\n\n\t\t\t,9: jmpressNext+\":\"+jmpressPrev // tab\n\t\t\t,32: jmpressNext // space\n\t\t\t,34: jmpressNext // pg down\n\t\t\t,39: jmpressNext // right\n\t\t\t,40: jmpressNext // down\n\n\t\t\t,36: \"home\" // home\n\n\t\t\t,35: \"end\" // end\n\t\t}\n\t\t,ignore: {\n\t\t\t\"INPUT\": [\n\t\t\t\t32 // space\n\t\t\t\t,37 // left\n\t\t\t\t,38 // up\n\t\t\t\t,39 // right\n\t\t\t\t,40 // down\n\t\t\t]\n\t\t\t,\"TEXTAREA\": [\n\t\t\t\t32 // space\n\t\t\t\t,37 // left\n\t\t\t\t,38 // up\n\t\t\t\t,39 // right\n\t\t\t\t,40 // down\n\t\t\t]\n\t\t\t,\"SELECT\": [\n\t\t\t\t38 // up\n\t\t\t\t,40 // down\n\t\t\t]\n\t\t}\n\t\t,tabSelector: \"a[href]:visible, :input:visible\"\n\t};\n\n\t/* HOOKS */\n\t$jmpress('afterInit', function( nil, eventData ) {\n\t\tvar settings = eventData.settings,\n\t\t\tkeyboardSettings = settings.keyboard,\n\t\t\tignoreKeyboardSettings = keyboardSettings.ignore,\n\t\t\tcurrent = eventData.current,\n\t\t\tjmpress = $(this);\n\n\t\t// tabindex make it focusable so that it can receive key events\n\t\tif(!settings.fullscreen) {\n\t\t\tjmpress.attr(\"tabindex\", 0);\n\t\t}\n\n\t\tcurrent.keyboardNamespace = \".jmpress-\"+randomString();\n\n\t\t// KEYPRESS EVENT: this fixes a Opera bug\n\t\t$(settings.fullscreen ? document : jmpress)\n\t\t\t.bind(\"keypress\"+current.keyboardNamespace, function( event ) {\n\n\t\t\tfor( var nodeName in ignoreKeyboardSettings ) {\n\t\t\t\tif ( event.target.nodeName === nodeName && ignoreKeyboardSettings[nodeName].indexOf(event.which) !== -1 ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(event.which >= 37 && event.which <= 40 || event.which === 32) {\n\t\t\t\tstopEvent(event);\n\t\t\t}\n\t\t});\n\t\t// KEYDOWN EVENT\n\t\t$(settings.fullscreen ? document : jmpress)\n\t\t\t.bind(\"keydown\"+current.keyboardNamespace, function( event ) {\n\t\t\tvar eventTarget = $(event.target);\n\n\t\t\tif ( !settings.fullscreen && !eventTarget.closest(jmpress).length || !keyboardSettings.use ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfor( var nodeName in ignoreKeyboardSettings ) {\n\t\t\t\tif ( eventTarget[0].nodeName === nodeName && ignoreKeyboardSettings[nodeName].indexOf(event.which) !== -1 ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar reverseSelect = false;\n\t\t\tvar nextFocus;\n\t\t\tif (event.which === 9) {\n\t\t\t\t// tab\n\t\t\t\tif ( !eventTarget.closest( jmpress.jmpress('active') ).length ) {\n\t\t\t\t\tif ( !event.shiftKey ) {\n\t\t\t\t\t\tnextFocus = jmpress.jmpress('active').find(\"a[href], :input\").filter(\":visible\").first();\n\t\t\t\t\t} else {\n\t\t\t\t\t\treverseSelect = true;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tnextFocus = eventTarget.near( keyboardSettings.tabSelector, event.shiftKey );\n\t\t\t\t\tif( !$(nextFocus)\n\t\t\t\t\t\t.closest( settings.stepSelector )\n\t\t\t\t\t\t.is(jmpress.jmpress('active') ) ) {\n\t\t\t\t\t\tnextFocus = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif( nextFocus && nextFocus.length > 0 ) {\n\t\t\t\t\tnextFocus.focus();\n\t\t\t\t\tjmpress.jmpress(\"scrollFix\");\n\t\t\t\t\tstopEvent(event);\n\t\t\t\t\treturn;\n\t\t\t\t} else {\n\t\t\t\t\tif(event.shiftKey) {\n\t\t\t\t\t\treverseSelect = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar action = keyboardSettings.keys[ event.which ];\n\t\t\tif ( typeof action === \"string\" ) {\n\t\t\t\tif (action.indexOf(\":\") !== -1) {\n\t\t\t\t\taction = action.split(\":\");\n\t\t\t\t\taction = event.shiftKey ? action[1] : action[0];\n\t\t\t\t}\n\t\t\t\tjmpress.jmpress( action );\n\t\t\t\tstopEvent(event);\n\t\t\t} else if ( $.isFunction(action) ) {\n\t\t\t\taction.call(jmpress, event);\n\t\t\t} else if ( action ) {\n\t\t\t\tjmpress.jmpress.apply( jmpress, action );\n\t\t\t\tstopEvent(event);\n\t\t\t}\n\n\t\t\tif (reverseSelect) {\n\t\t\t\t// tab\n\t\t\t\tnextFocus = jmpress.jmpress('active').find(\"a[href], :input\").filter(\":visible\").last();\n\t\t\t\tnextFocus.focus();\n\t\t\t\tjmpress.jmpress(\"scrollFix\");\n\t\t\t}\n\t\t});\n\t});\n\t$jmpress('afterDeinit', function( nil, eventData ) {\n\t\t$(document).unbind(eventData.current.keyboardNamespace);\n\t});\n\n\n}(jQuery, document, window));\n/*\n * viewport.js\n * Scale to fit a given viewport\n */\n(function( $, document, window, undefined ) {\n\n\t'use strict';\n\n\tfunction randomString() {\n\t\treturn \"\" + Math.round(Math.random() * 100000, 0);\n\t}\n\n\tvar browser = (function() {\n\t\tvar ua = navigator.userAgent.toLowerCase();\n\t\tvar match = /(chrome)[ \\/]([\\w.]+)/.exec(ua) ||\n\t\t\t/(webkit)[ \\/]([\\w.]+)/.exec(ua) ||\n\t\t\t/(opera)(?:.*version|)[ \\/]([\\w.]+)/.exec(ua) ||\n\t\t\t/(msie) ([\\w.]+)/.exec(ua) ||\n\t\t\tua.indexOf(\"compatible\") < 0 && /(mozilla)(?:.*? rv:([\\w.]+)|)/.exec(ua) ||\n\t\t\t[];\n\t\treturn match[1] || \"\";\n\t}());\n\n\tvar defaults = $.jmpress(\"defaults\");\n\tdefaults.viewPort = {\n\t\twidth: false\n\t\t,height: false\n\t\t,maxScale: 0\n\t\t,minScale: 0\n\t\t,zoomable: 0\n\t\t,zoomBindMove: true\n\t\t,zoomBindWheel: true\n\t};\n\tvar keys = defaults.keyboard.keys;\n\tkeys[browser === 'mozilla' ? 107 : 187] = \"zoomIn\";  // +\n\tkeys[browser === 'mozilla' ? 109 : 189] = \"zoomOut\"; // -\n\tdefaults.reasonableAnimation.resize = {\n\t\ttransitionDuration: '0s'\n\t\t,transitionDelay: '0ms'\n\t};\n\tdefaults.reasonableAnimation.zoom = {\n\t\ttransitionDuration: '0s'\n\t\t,transitionDelay: '0ms'\n\t};\n\t$.jmpress(\"initStep\", function( step, eventData ) {\n\t\tfor(var variable in {\"viewPortHeight\":1, \"viewPortWidth\":1, \"viewPortMinScale\":1, \"viewPortMaxScale\":1, \"viewPortZoomable\":1}) {\n\t\t\teventData.stepData[variable] = eventData.data[variable] && parseFloat(eventData.data[variable]);\n\t\t}\n\t});\n\t$.jmpress(\"afterInit\", function( nil, eventData ) {\n\t\tvar jmpress = this;\n\t\teventData.current.viewPortNamespace = \".jmpress-\"+randomString();\n\t\t$(window).bind(\"resize\"+eventData.current.viewPortNamespace, function (event) {\n\t\t\t$(jmpress).jmpress(\"reselect\", \"resize\");\n\t\t});\n\t\teventData.current.userZoom = 0;\n\t\teventData.current.userTranslateX = 0;\n\t\teventData.current.userTranslateY = 0;\n\t\tif(eventData.settings.viewPort.zoomBindWheel) {\n\t\t\t$(eventData.settings.fullscreen ? document : this)\n\t\t\t\t.bind(\"mousewheel\"+eventData.current.viewPortNamespace+\" DOMMouseScroll\"+eventData.current.viewPortNamespace, function( event, delta ) {\n\t\t\t\tdelta = delta || event.originalEvent.wheelDelta || -event.originalEvent.detail /* mozilla */;\n\t\t\t\tvar direction = (delta / Math.abs(delta));\n\t\t\t\tif(direction < 0) {\n\t\t\t\t\t$(eventData.jmpress).jmpress(\"zoomOut\", event.originalEvent.x, event.originalEvent.y);\n\t\t\t\t} else if(direction > 0) {\n\t\t\t\t\t$(eventData.jmpress).jmpress(\"zoomIn\", event.originalEvent.x, event.originalEvent.y);\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\t\t}\n\t\tif(eventData.settings.viewPort.zoomBindMove) {\n\t\t\t$(eventData.settings.fullscreen ? document : this).bind(\"mousedown\"+eventData.current.viewPortNamespace, function (event) {\n\t\t\t\tif(eventData.current.userZoom) {\n\t\t\t\t\teventData.current.userTranslating = { x: event.clientX, y: event.clientY };\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopImmediatePropagation();\n\t\t\t\t}\n\t\t\t}).bind(\"mousemove\"+eventData.current.viewPortNamespace, function (event) {\n\t\t\t\tvar userTranslating = eventData.current.userTranslating;\n\t\t\t\tif(userTranslating) {\n\t\t\t\t\t$(jmpress).jmpress(\"zoomTranslate\", event.clientX - userTranslating.x, event.clientY - userTranslating.y);\n\t\t\t\t\tuserTranslating.x = event.clientX;\n\t\t\t\t\tuserTranslating.y = event.clientY;\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopImmediatePropagation();\n\t\t\t\t}\n\t\t\t}).bind(\"mouseup\"+eventData.current.viewPortNamespace, function (event) {\n\t\t\t\tif(eventData.current.userTranslating) {\n\t\t\t\t\teventData.current.userTranslating = undefined;\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopImmediatePropagation();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t});\n\tfunction maxAbs(value, range) {\n\t\treturn Math.max(Math.min(value, range), -range);\n\t}\n\tfunction zoom(x, y, direction) {\n\t\tvar current = $(this).jmpress(\"current\"),\n\t\t\tsettings = $(this).jmpress(\"settings\"),\n\t\t\tstepData = $(this).jmpress(\"active\").data(\"stepData\"),\n\t\t\tcontainer = $(this).jmpress(\"container\");\n\t\tif(current.userZoom === 0 && direction < 0) {\n\t\t\treturn;\n\t\t}\n\t\tvar zoomableSteps = stepData.viewPortZoomable || settings.viewPort.zoomable;\n\t\tif(current.userZoom === zoomableSteps && direction > 0) {\n\t\t\treturn;\n\t\t}\n\t\tcurrent.userZoom += direction;\n\n\t\tvar halfWidth = $(container).innerWidth()/2,\n\t\t\thalfHeight = $(container).innerHeight()/2;\n\n\t\tx = x ? x - halfWidth : x;\n\t\ty = y ? y - halfHeight : y;\n\n\t\t// TODO this is not perfect... too much math... :(\n\t\tcurrent.userTranslateX =\n\t\t\tmaxAbs(current.userTranslateX - direction * x / current.zoomOriginWindowScale / zoomableSteps,\n\t\t\thalfWidth * current.userZoom * current.userZoom / zoomableSteps);\n\t\tcurrent.userTranslateY =\n\t\t\tmaxAbs(current.userTranslateY - direction * y / current.zoomOriginWindowScale / zoomableSteps,\n\t\t\thalfHeight * current.userZoom * current.userZoom / zoomableSteps);\n\n\t\t$(this).jmpress(\"reselect\", \"zoom\");\n\t}\n\t$.jmpress(\"register\", \"zoomIn\", function(x, y) {\n\t\tzoom.call(this, x||0, y||0, 1);\n\t});\n\t$.jmpress(\"register\", \"zoomOut\", function(x, y) {\n\t\tzoom.call(this, x||0, y||0, -1);\n\t});\n\t$.jmpress(\"register\", \"zoomTranslate\", function(x, y) {\n\t\tvar current = $(this).jmpress(\"current\"),\n\t\t\tsettings = $(this).jmpress(\"settings\"),\n\t\t\tstepData = $(this).jmpress(\"active\").data(\"stepData\"),\n\t\t\tcontainer = $(this).jmpress(\"container\");\n\t\tvar zoomableSteps = stepData.viewPortZoomable || settings.viewPort.zoomable;\n\t\tvar halfWidth = $(container).innerWidth(),\n\t\t\thalfHeight = $(container).innerHeight();\n\t\tcurrent.userTranslateX =\n\t\t\tmaxAbs(current.userTranslateX + x / current.zoomOriginWindowScale,\n\t\t\thalfWidth * current.userZoom * current.userZoom / zoomableSteps);\n\t\tcurrent.userTranslateY =\n\t\t\tmaxAbs(current.userTranslateY + y / current.zoomOriginWindowScale,\n\t\t\thalfHeight * current.userZoom * current.userZoom / zoomableSteps);\n\t\t$(this).jmpress(\"reselect\", \"zoom\");\n\t});\n\t$.jmpress('afterDeinit', function( nil, eventData ) {\n\t\t$(eventData.settings.fullscreen ? document : this).unbind(eventData.current.viewPortNamespace);\n\t\t$(window).unbind(eventData.current.viewPortNamespace);\n\t});\n\t$.jmpress(\"setActive\", function( step, eventData ) {\n\t\tvar viewPort = eventData.settings.viewPort;\n\t\tvar viewPortHeight = eventData.stepData.viewPortHeight || viewPort.height;\n\t\tvar viewPortWidth = eventData.stepData.viewPortWidth || viewPort.width;\n\t\tvar viewPortMaxScale = eventData.stepData.viewPortMaxScale || viewPort.maxScale;\n\t\tvar viewPortMinScale = eventData.stepData.viewPortMinScale || viewPort.minScale;\n\t\t// Correct the scale based on the window's size\n\t\tvar windowScaleY = viewPortHeight && $(eventData.container).innerHeight()/viewPortHeight;\n\t\tvar windowScaleX = viewPortWidth && $(eventData.container).innerWidth()/viewPortWidth;\n\t\tvar windowScale = (windowScaleX || windowScaleY) && Math.min( windowScaleX || windowScaleY, windowScaleY || windowScaleX );\n\n\t\tif(windowScale) {\n\t\t\twindowScale = windowScale || 1;\n\t\t\tif(viewPortMaxScale) {\n\t\t\t\twindowScale = Math.min(windowScale, viewPortMaxScale);\n\t\t\t}\n\t\t\tif(viewPortMinScale) {\n\t\t\t\twindowScale = Math.max(windowScale, viewPortMinScale);\n\t\t\t}\n\n\t\t\tvar zoomableSteps = eventData.stepData.viewPortZoomable || eventData.settings.viewPort.zoomable;\n\t\t\tif(zoomableSteps) {\n\t\t\t\tvar diff = (1/windowScale) - (1/viewPortMaxScale);\n\t\t\t\tdiff /= zoomableSteps;\n\t\t\t\twindowScale = 1/((1/windowScale) - diff * eventData.current.userZoom);\n\t\t\t}\n\n\t\t\teventData.target.transform.reverse();\n\t\t\tif(eventData.current.userTranslateX && eventData.current.userTranslateY) {\n\t\t\t\teventData.target.transform.push([\"translate\", eventData.current.userTranslateX, eventData.current.userTranslateY, 0]);\n\t\t\t} else {\n\t\t\t\teventData.target.transform.push([\"translate\"]);\n\t\t\t}\n\t\t\teventData.target.transform.push([\"scale\",\n\t\t\t\twindowScale,\n\t\t\t\twindowScale,\n\t\t\t\t1]);\n\t\t\teventData.target.transform.reverse();\n\t\t\teventData.target.perspectiveScale /= windowScale;\n\t\t}\n\t\teventData.current.zoomOriginWindowScale = windowScale;\n\t});\n\t$.jmpress(\"setInactive\", function( step, eventData ) {\n\t\tif(!eventData.nextStep || !step || $(eventData.nextStep).attr(\"id\") !== $(step).attr(\"id\")) {\n\t\t\teventData.current.userZoom = 0;\n\t\t\teventData.current.userTranslateX = 0;\n\t\t\teventData.current.userTranslateY = 0;\n\t\t}\n\t});\n\n}(jQuery, document, window));\n\n/*\n * mouse.js\n * Clicking to select a step\n */\n(function( $, document, window, undefined ) {\n\n\t'use strict';\n\tvar $jmpress = $.jmpress;\n\n\t/* FUNCTIONS */\n\tfunction randomString() {\n\t\treturn \"\" + Math.round(Math.random() * 100000, 0);\n\t}\n\n\t/* DEFAULTS */\n\t$jmpress(\"defaults\").mouse = {\n\t\tclickSelects: true\n\t};\n\n\t/* HOOKS */\n\t$jmpress(\"afterInit\", function( nil, eventData ) {\n\t\tvar settings = eventData.settings,\n\t\t\tstepSelector = settings.stepSelector,\n\t\t\tcurrent = eventData.current,\n\t\t\tjmpress = $(this);\n\t\tcurrent.clickableStepsNamespace = \".jmpress-\"+randomString();\n\t\tjmpress.bind(\"click\"+current.clickableStepsNamespace, function(event) {\n\t\t\tif (!settings.mouse.clickSelects || current.userZoom) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// get clicked step\n\t\t\tvar clickedStep = $(event.target).closest(stepSelector);\n\n\t\t\t// clicks on the active step do default\n\t\t\tif ( clickedStep.is( jmpress.jmpress(\"active\") ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (clickedStep.length) {\n\t\t\t\t// select the clicked step\n\t\t\t\tjmpress.jmpress(\"select\", clickedStep[0], \"click\");\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t});\n\t});\n\t$jmpress('afterDeinit', function( nil, eventData ) {\n\t\t$(this).unbind(eventData.current.clickableStepsNamespace);\n\t});\n\n}(jQuery, document, window));\n/*\n * mobile.js\n * Adds support for swipe on touch supported browsers\n */\n(function( $, document, window, undefined ) {\n\n\t'use strict';\n\tvar $jmpress = $.jmpress;\n\n\t/* FUNCTIONS */\n\tfunction randomString() {\n\t\treturn \"\" + Math.round(Math.random() * 100000, 0);\n\t}\n\n\t/* HOOKS */\n\t$jmpress( 'afterInit', function( step, eventData ) {\n\t\tvar settings = eventData.settings,\n\t\t\tcurrent = eventData.current,\n\t\t\tjmpress = eventData.jmpress;\n\t\tcurrent.mobileNamespace = \".jmpress-\"+randomString();\n\t\tvar data, start = [0,0];\n\t\t$(settings.fullscreen ? document : jmpress)\n\t\t\t.bind(\"touchstart\"+current.mobileNamespace, function( event ) {\n\n\t\t\tdata = event.originalEvent.touches[0];\n\t\t\tstart = [ data.pageX, data.pageY ];\n\n\t\t}).bind(\"touchmove\"+current.mobileNamespace, function( event ) {\n\t\t\tdata = event.originalEvent.touches[0];\n\t\t\tevent.preventDefault();\n\t\t\treturn false;\n\t\t}).bind(\"touchend\"+current.mobileNamespace, function( event ) {\n\t\t\tvar end = [ data.pageX, data.pageY ],\n\t\t\t\tdiff = [ end[0]-start[0], end[1]-start[1] ];\n\n\t\t\tif(Math.max(Math.abs(diff[0]), Math.abs(diff[1])) > 50) {\n\t\t\t\tdiff = Math.abs(diff[0]) > Math.abs(diff[1]) ? diff[0] : diff[1];\n\t\t\t\t$(jmpress).jmpress(diff > 0 ? \"prev\" : \"next\");\n\t\t\t\tevent.preventDefault();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t});\n\t$jmpress('afterDeinit', function( nil, eventData ) {\n\t\tvar settings = eventData.settings,\n\t\t\tcurrent = eventData.current,\n\t\t\tjmpress = eventData.jmpress;\n\t\t$(settings.fullscreen ? document : jmpress).unbind(current.mobileNamespace);\n\t});\n\n}(jQuery, document, window));\n/*\n * templates.js\n * The amazing template engine\n */\n(function( $, document, window, undefined ) {\n\n\t'use strict';\n\tvar $jmpress = $.jmpress,\n\t\ttemplateFromParentIdent = \"_template_\",\n\t\ttemplateFromApplyIdent = \"_applied_template_\";\n\n\t/* STATIC VARS */\n\tvar templates = {};\n\n\t/* FUNCTIONS */\n\tfunction addUndefined( target, values, prefix ) {\n\t\tfor( var name in values ) {\n\t\t\tvar targetName = name;\n\t\t\tif ( prefix ) {\n\t\t\t\ttargetName = prefix + targetName.substr(0, 1).toUpperCase() + targetName.substr(1);\n\t\t\t}\n\t\t\tif ( $.isPlainObject(values[name]) ) {\n\t\t\t\taddUndefined( target, values[name], targetName );\n\t\t\t} else if( target[targetName] === undefined ) {\n\t\t\t\ttarget[targetName] = values[name];\n\t\t\t}\n\t\t}\n\t}\n\tfunction applyChildrenTemplates( children, templateChildren ) {\n\t\tif ($.isArray(templateChildren)) {\n\t\t\tif (templateChildren.length < children.length) {\n\t\t\t\t$.error(\"more nested steps than children in template\");\n\t\t\t} else {\n\t\t\t\tchildren.each(function(idx, child) {\n\t\t\t\t\tchild = $(child);\n\t\t\t\t\tvar tmpl = child.data(templateFromParentIdent) || {};\n\t\t\t\t\taddUndefined(tmpl, templateChildren[idx]);\n\t\t\t\t\tchild.data(templateFromParentIdent, tmpl);\n\t\t\t\t});\n\t\t\t}\n\t\t} else if($.isFunction(templateChildren)) {\n\t\t\tchildren.each(function(idx, child) {\n\t\t\t\tchild = $(child);\n\t\t\t\tvar tmpl = child.data(templateFromParentIdent) || {};\n\t\t\t\taddUndefined(tmpl, templateChildren(idx, child, children));\n\t\t\t\tchild.data(templateFromParentIdent, tmpl);\n\t\t\t});\n\t\t} // TODO: else if(object)\n\t}\n\tfunction applyTemplate( data, element, template, eventData ) {\n\t\tif (template.children) {\n\t\t\tvar children = element.children( eventData.settings.stepSelector );\n\t\t\tapplyChildrenTemplates( children, template.children );\n\t\t}\n\t\tapplyTemplateData( data, template );\n\t}\n\tfunction applyTemplateData( data, template ) {\n\t\taddUndefined(data, template);\n\t}\n\n\t/* HOOKS */\n\t$jmpress(\"beforeInitStep\", function( step, eventData ) {\n\t\tstep = $(step);\n\t\tvar data = eventData.data,\n\t\t\ttemplateFromAttr = data.template,\n\t\t\ttemplateFromApply = step.data(templateFromApplyIdent),\n\t\t\ttemplateFromParent = step.data(templateFromParentIdent);\n\t\tif(templateFromAttr) {\n\t\t\t$.each(templateFromAttr.split(\" \"), function(idx, tmpl) {\n\t\t\t\tvar template = templates[tmpl];\n\t\t\t\tapplyTemplate( data, step, template, eventData );\n\t\t\t});\n\t\t}\n\t\tif (templateFromApply) {\n\t\t\tapplyTemplate( data, step, templateFromApply, eventData );\n\t\t}\n\t\tif (templateFromParent) {\n\t\t\tapplyTemplate( data, step, templateFromParent, eventData );\n\t\t\tstep.data(templateFromParentIdent, null);\n\t\t\tif(templateFromParent.template) {\n\t\t\t\t$.each(templateFromParent.template.split(\" \"), function(idx, tmpl) {\n\t\t\t\t\tvar template = templates[tmpl];\n\t\t\t\t\tapplyTemplate( data, step, template, eventData );\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n\t$jmpress(\"beforeInit\", function( nil, eventData ) {\n\t\tvar data = $jmpress(\"dataset\", this),\n\t\t\tdataTemplate = data.template,\n\t\t\tstepSelector = eventData.settings.stepSelector;\n\t\tif (dataTemplate) {\n\t\t\tvar template = templates[dataTemplate];\n\t\t\tapplyChildrenTemplates( $(this).find(stepSelector).filter(function() {\n\t\t\t\treturn !$(this).parent().is(stepSelector);\n\t\t\t}), template.children );\n\t\t}\n\t});\n\n\t/* EXPORTED FUNCTIONS */\n\t$jmpress(\"register\", \"template\", function( name, tmpl ) {\n\t\tif (templates[name]) {\n\t\t\ttemplates[name] = $.extend(true, {}, templates[name], tmpl);\n\t\t} else {\n\t\t\ttemplates[name] = $.extend(true, {}, tmpl);\n\t\t}\n\t});\n\t$jmpress(\"register\", \"apply\", function( selector, tmpl ) {\n\t\tif( !tmpl ) {\n\t\t\t// TODO ERROR because settings not found\n\t\t\tvar stepSelector = $(this).jmpress(\"settings\").stepSelector;\n\t\t\tapplyChildrenTemplates( $(this).find(stepSelector).filter(function() {\n\t\t\t\treturn !$(this).parent().is(stepSelector);\n\t\t\t}), selector );\n\t\t} else if($.isArray(tmpl)) {\n\t\t\tapplyChildrenTemplates( $(selector), tmpl );\n\t\t} else {\n\t\t\tvar template;\n\t\t\tif(typeof tmpl === \"string\") {\n\t\t\t\ttemplate = templates[tmpl];\n\t\t\t} else {\n\t\t\t\ttemplate = $.extend(true, {}, tmpl);\n\t\t\t}\n\t\t\t$(selector).each(function(idx, element) {\n\t\t\t\telement = $(element);\n\t\t\t\tvar tmpl = element.data(templateFromApplyIdent) || {};\n\t\t\t\taddUndefined(tmpl, template);\n\t\t\t\telement.data(templateFromApplyIdent, tmpl);\n\t\t\t});\n\t\t}\n\t});\n\n}(jQuery, document, window));\n/*\n * jqevents.js\n * Fires jQuery events\n */\n(function( $, document, window, undefined ) {\n\n\t'use strict';\n\n\t/* HOOKS */\n\t// the events should not bubble up the tree\n\t// elsewise nested jmpress would cause buggy behavior\n\t$.jmpress(\"setActive\", function( step, eventData ) {\n\t\tif(eventData.prevStep !== step) {\n\t\t\t$(step).triggerHandler(\"enterStep\");\n\t\t}\n\t});\n\t$.jmpress(\"setInactive\", function( step, eventData ) {\n\t\tif(eventData.nextStep !== step) {\n\t\t\t$(step).triggerHandler(\"leaveStep\");\n\t\t}\n\t});\n\n}(jQuery, document, window));\n/*\n * animation.js\n * Apply custom animations to steps\n */\n(function( $, document, window, undefined ) {\n\n\t'use strict';\n\n\tfunction parseSubstepInfo(str) {\n\t\tvar arr = str.split(\" \");\n\t\tvar className = arr[0];\n\t\tvar config = { willClass: \"will-\"+className, doClass: \"do-\"+className, hasClass: \"has-\"+className };\n\t\tvar state = \"\";\n\t\tfor(var i = 1; i < arr.length; i++) {\n\t\t\tvar s = arr[i];\n\t\t\tswitch(state) {\n\t\t\tcase \"\":\n\t\t\t\tif(s === \"after\") {\n\t\t\t\t\tstate = \"after\";\n\t\t\t\t} else {\n\t\t\t\t\t$.warn(\"unknown keyword in '\"+str+\"'. '\"+s+\"' unknown.\");\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"after\":\n\t\t\t\tif(s.match(/^[1-9][0-9]*m?s?/)) {\n\t\t\t\t\tvar value = parseFloat(s);\n\t\t\t\t\tif(s.indexOf(\"ms\") !== -1) {\n\t\t\t\t\t\tvalue *= 1;\n\t\t\t\t\t} else if(s.indexOf(\"s\") !== -1) {\n\t\t\t\t\t\tvalue *= 1000;\n\t\t\t\t\t} else if(s.indexOf(\"m\") !== -1) {\n\t\t\t\t\t\tvalue *= 60000;\n\t\t\t\t\t}\n\t\t\t\t\tconfig.delay = value;\n\t\t\t\t} else {\n\t\t\t\t\tconfig.after = Array.prototype.slice.call(arr, i).join(\" \");\n\t\t\t\t\ti = arr.length;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn config;\n\t}\n\tfunction find(array, selector, start, end) {\n\t\tend = end || (array.length - 1);\n\t\tstart = start || 0;\n\t\tfor(var i = start; i < end + 1; i++) {\n\t\t\tif($(array[i].element).is(selector)) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t}\n\tfunction addOn(list, substep, delay) {\n\t\t$.each(substep._on, function(idx, child) {\n\t\t\tlist.push({substep: child.substep, delay: child.delay + delay});\n\t\t\taddOn(list, child.substep, child.delay + delay);\n\t\t});\n\t}\n\t$.jmpress(\"defaults\").customAnimationDataAttribute = \"jmpress\";\n\t$.jmpress(\"afterInit\", function( nil, eventData ) {\n\t\teventData.current.animationTimeouts = [];\n\t\teventData.current.animationCleanupWaiting = [];\n\t});\n\t$.jmpress(\"applyStep\", function( step, eventData ) {\n\t\t// read custom animation from elements\n\t\tvar substepsData = {};\n\t\tvar listOfSubsteps = [];\n\t\t$(step).find(\"[data-\"+eventData.settings.customAnimationDataAttribute+\"]\")\n\t\t\t\t.each(function(idx, element) {\n\t\t\tif($(element).closest(eventData.settings.stepSelector).is(step)) {\n\t\t\t\tlistOfSubsteps.push({element: element});\n\t\t\t}\n\t\t});\n\t\tif(listOfSubsteps.length === 0) {\n\t\t\treturn;\n\t\t}\n\t\t$.each(listOfSubsteps, function(idx, substep) {\n\t\t\tsubstep.info = parseSubstepInfo(\n\t\t\t\t$(substep.element).data(eventData.settings.customAnimationDataAttribute));\n\t\t\t$(substep.element).addClass(substep.info.willClass);\n\t\t\tsubstep._on = [];\n\t\t\tsubstep._after = null;\n\t\t});\n\t\tvar current = {_after: undefined, _on: [], info: {}}; // virtual zero step\n\t\t$.each(listOfSubsteps, function(idx, substep) {\n\t\t\tvar other = substep.info.after;\n\t\t\tif(other) {\n\t\t\t\tif(other === \"step\") {\n\t\t\t\t\tother = current;\n\t\t\t\t} else if(other === \"prev\") {\n\t\t\t\t\tother = listOfSubsteps[idx-1];\n\t\t\t\t} else {\n\t\t\t\t\tvar index = find(listOfSubsteps, other, 0, idx - 1);\n\t\t\t\t\tif(index === undefined) {\n\t\t\t\t\t\tindex = find(listOfSubsteps, other);\n\t\t\t\t\t}\n\t\t\t\t\tother = (index === undefined || index === idx) ? listOfSubsteps[idx-1] : listOfSubsteps[index];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tother = listOfSubsteps[idx-1];\n\t\t\t}\n\t\t\tif(other) {\n\t\t\t\tif(!substep.info.delay) {\n\t\t\t\t\tif(!other._after) {\n\t\t\t\t\t\tother._after = substep;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tother = other._after;\n\t\t\t\t}\n\t\t\t\tother._on.push({substep: substep, delay: substep.info.delay || 0});\n\t\t\t}\n\t\t});\n\t\tif(current._after === undefined && current._on.length === 0) {\n\t\t\tvar startStep = find(listOfSubsteps, eventData.stepData.startSubstep) || 0;\n\t\t\tcurrent._after = listOfSubsteps[startStep];\n\t\t}\n\t\tvar substepsInOrder = [];\n\t\tfunction findNextFunc(idx, item) {\n\t\t\tif(item.substep._after) {\n\t\t\t\tcurrent = item.substep._after;\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\tdo {\n\t\t\tvar substepList = [{substep: current, delay: 0}];\n\t\t\taddOn(substepList, current, 0);\n\t\t\tsubstepsInOrder.push(substepList);\n\t\t\tcurrent = null;\n\t\t\t$.each(substepList, findNextFunc);\n\t\t} while(current);\n\t\tsubstepsData.list = substepsInOrder;\n\t\t$(step).data(\"substepsData\", substepsData);\n\t});\n\t$.jmpress(\"unapplyStep\", function( step, eventData ) {\n\t\tvar substepsData = $(step).data(\"substepsData\");\n\t\tif(substepsData) {\n\t\t\t$.each(substepsData.list, function(idx, activeSubsteps) {\n\t\t\t\t$.each(activeSubsteps, function(idx, substep) {\n\t\t\t\t\tif(substep.substep.info.willClass) {\n\t\t\t\t\t\t$(substep.substep.element).removeClass(substep.substep.info.willClass);\n\t\t\t\t\t}\n\t\t\t\t\tif(substep.substep.info.hasClass) {\n\t\t\t\t\t\t$(substep.substep.element).removeClass(substep.substep.info.hasClass);\n\t\t\t\t\t}\n\t\t\t\t\tif(substep.substep.info.doClass) {\n\t\t\t\t\t\t$(substep.substep.element).removeClass(substep.substep.info.doClass);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t});\n\t$.jmpress(\"setActive\", function(step, eventData) {\n\t\tvar substepsData = $(step).data(\"substepsData\");\n\t\tif(!substepsData) {\n\t\t\treturn;\n\t\t}\n\t\tif(eventData.substep === undefined) {\n\t\t\teventData.substep =\n\t\t\t\t(eventData.reason === \"prev\" ?\n\t\t\t\t\tsubstepsData.list.length-1 :\n\t\t\t\t\t0\n\t\t\t\t);\n\t\t}\n\t\tvar substep = eventData.substep;\n\t\t$.each(eventData.current.animationTimeouts, function(idx, timeout) {\n\t\t\tclearTimeout(timeout);\n\t\t});\n\t\teventData.current.animationTimeouts = [];\n\t\t$.each(substepsData.list, function(idx, activeSubsteps) {\n\t\t\tvar applyHas = idx < substep;\n\t\t\tvar applyDo = idx <= substep;\n\t\t\t$.each(activeSubsteps, function(idx, substep) {\n\t\t\t\tif(substep.substep.info.hasClass) {\n\t\t\t\t\t$(substep.substep.element)[(applyHas?\"add\":\"remove\")+\"Class\"](substep.substep.info.hasClass);\n\t\t\t\t}\n\t\t\t\tfunction applyIt() {\n\t\t\t\t\t$(substep.substep.element).addClass(substep.substep.info.doClass);\n\t\t\t\t}\n\t\t\t\tif(applyDo && !applyHas && substep.delay && eventData.reason !== \"prev\") {\n\t\t\t\t\tif(substep.substep.info.doClass) {\n\t\t\t\t\t\t$(substep.substep.element).removeClass(substep.substep.info.doClass);\n\t\t\t\t\t\teventData.current.animationTimeouts.push(setTimeout(applyIt, substep.delay));\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif(substep.substep.info.doClass) {\n\t\t\t\t\t\t$(substep.substep.element)[(applyDo?\"add\":\"remove\")+\"Class\"](substep.substep.info.doClass);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t});\n\t$.jmpress(\"setInactive\", function(step, eventData) {\n\t\tif(eventData.nextStep === step) {\n\t\t\treturn;\n\t\t}\n\t\tfunction cleanupAnimation( substepsData ) {\n\t\t\t$.each(substepsData.list, function(idx, activeSubsteps) {\n\t\t\t\t$.each(activeSubsteps, function(idx, substep) {\n\t\t\t\t\tif(substep.substep.info.hasClass) {\n\t\t\t\t\t\t$(substep.substep.element).removeClass(substep.substep.info.hasClass);\n\t\t\t\t\t}\n\t\t\t\t\tif(substep.substep.info.doClass) {\n\t\t\t\t\t\t$(substep.substep.element).removeClass(substep.substep.info.doClass);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\t$.each(eventData.current.animationCleanupWaiting, function(idx, item) {\n\t\t\tcleanupAnimation(item);\n\t\t});\n\t\teventData.current.animationCleanupWaiting = [];\n\t\tvar substepsData = $(step).data(\"substepsData\");\n\t\tif(substepsData) {\n\t\t\teventData.current.animationCleanupWaiting.push( substepsData );\n\t\t}\n\t});\n\t$.jmpress(\"selectNext\", function( step, eventData ) {\n\t\tif(eventData.substep === undefined) {\n\t\t\treturn;\n\t\t}\n\t\tvar substepsData = $(step).data(\"substepsData\");\n\t\tif(!substepsData) {\n\t\t\treturn;\n\t\t}\n\t\tif(eventData.substep < substepsData.list.length-1) {\n\t\t\treturn {step: step, substep: eventData.substep+1};\n\t\t}\n\t});\n\t$.jmpress(\"selectPrev\", function( step, eventData ) {\n\t\tif(eventData.substep === undefined) {\n\t\t\treturn;\n\t\t}\n\t\tvar substepsData = $(step).data(\"substepsData\");\n\t\tif(!substepsData) {\n\t\t\treturn;\n\t\t}\n\t\tif(eventData.substep > 0) {\n\t\t\treturn {step: step, substep: eventData.substep-1};\n\t\t}\n\t});\n\n}(jQuery, document, window));\n/*!\n * plugin for jmpress.js v0.4.5\n *\n * Copyright 2013 Kyle Robinson Young @shama & Tobias Koppers @sokra\n * Licensed MIT\n * http://www.opensource.org/licenses/mit-license.php\n *//*\n * jmpress.toggle plugin\n * For binding a key to toggle de/initialization of jmpress.js.\n */\n(function( $, document, window, undefined ) {\n\t'use strict';\n\t$.jmpress(\"register\", \"toggle\", function( key, config, initial ) {\n\t\tvar jmpress = this;\n\t\t$(document).bind(\"keydown\", function( event ) {\n\t\t\tif ( event.keyCode === key ) {\n\t\t\t\tif ($(jmpress).jmpress(\"initialized\")) {\n\t\t\t\t\t$(jmpress).jmpress(\"deinit\");\n\t\t\t\t} else {\n\t\t\t\t\t$(jmpress).jmpress(config);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tif ( initial ) {\n\t\t\t$(jmpress).jmpress(config);\n\t\t}\n\t});\n}(jQuery, document, window));\n\n/*\n * jmpress.secondary plugin\n * Apply a secondary animation when step is selected.\n */\n(function( $, document, window, undefined ) {\n\t'use strict';\n\t$.jmpress(\"initStep\", function( step, eventData ) {\n\t\tfor(var name in eventData.data) {\n\t\t\tif(name.indexOf(\"secondary\") === 0) {\n\t\t\t\teventData.stepData[name] = eventData.data[name];\n\t\t\t}\n\t\t}\n\t});\n\tfunction exchangeIf(childStepData, condition, step) {\n\t\tif(childStepData.secondary &&\n\t\t\tchildStepData.secondary.split(\" \").indexOf(condition) !== -1) {\n\t\t\tfor(var name in childStepData) {\n\t\t\t\tif(name.length > 9 && name.indexOf(\"secondary\") === 0) {\n\t\t\t\t\tvar tmp = childStepData[name];\n\t\t\t\t\tvar normal = name.substr(9);\n\t\t\t\t\tnormal = normal.substr(0, 1).toLowerCase() + normal.substr(1);\n\t\t\t\t\tchildStepData[name] = childStepData[normal];\n\t\t\t\t\tchildStepData[normal] = tmp;\n\t\t\t\t}\n\t\t\t}\n\t\t\t$(this).jmpress(\"reapply\", $(step));\n\t\t}\n\t}\n\t$.jmpress(\"beforeActive\", function( step, eventData ) {\n\t\texchangeIf.call(eventData.jmpress, $(step).data(\"stepData\"), \"self\", step);\n\t\tvar parent = $(step).parent();\n\t\t$(parent)\n\t\t\t.children(eventData.settings.stepSelector)\n\t\t\t.each(function(idx, child) {\n\t\t\t\tvar childStepData = $(child).data(\"stepData\");\n\t\t\t\texchangeIf.call(eventData.jmpress, childStepData, \"siblings\", child);\n\t\t\t});\n\t\tfunction grandchildrenFunc(idx, child) {\n\t\t\tvar childStepData = $(child).data(\"stepData\");\n\t\t\texchangeIf.call(eventData.jmpress, childStepData, \"grandchildren\", child);\n\t\t}\n\t\tfor(var i = 1; i < eventData.parents.length; i++) {\n\t\t\t$(eventData.parents[i])\n\t\t\t\t.children(eventData.settings.stepSelector)\n\t\t\t\t.each();\n\t\t}\n\t});\n\t$.jmpress(\"setInactive\", function( step, eventData ) {\n\t\texchangeIf.call(eventData.jmpress, $(step).data(\"stepData\"), \"self\", step);\n\t\tvar parent = $(step).parent();\n\t\t$(parent)\n\t\t\t.children(eventData.settings.stepSelector)\n\t\t\t.each(function(idx, child) {\n\t\t\t\tvar childStepData = $(child).data(\"stepData\");\n\t\t\t\texchangeIf.call(eventData.jmpress, childStepData, \"siblings\", child);\n\t\t\t});\n\t\tfunction grandchildrenFunc(idx, child) {\n\t\t\tvar childStepData = $(child).data(\"stepData\");\n\t\t\texchangeIf.call(eventData.jmpress, childStepData, \"grandchildren\", child);\n\t\t}\n\t\tfor(var i = 1; i < eventData.parents.length; i++) {\n\t\t\t$(eventData.parents[i])\n\t\t\t\t.children(eventData.settings.stepSelector)\n\t\t\t\t.each(grandchildrenFunc);\n\t\t}\n\t});\n}(jQuery, document, window));\n\n/*\n * jmpress.duration plugin\n * For auto advancing steps after a given duration and optionally displaying a\n * progress bar.\n */\n(function( $, document, window, undefined ) {\n\t'use strict';\n\n\t$.jmpress(\"defaults\").duration = {\n\t\tdefaultValue: -1\n\t\t,defaultAction: \"next\"\n\t\t,barSelector: undefined\n\t\t,barProperty: \"width\"\n\t\t,barPropertyStart: \"0\"\n\t\t,barPropertyEnd: \"100%\"\n\t};\n\t$.jmpress(\"initStep\", function( step, eventData ) {\n\t\teventData.stepData.duration = eventData.data.duration && parseInt(eventData.data.duration, 10);\n\t\teventData.stepData.durationAction = eventData.data.durationAction;\n\t});\n\t$.jmpress(\"setInactive\", function( step, eventData ) {\n\t\tvar settings = eventData.settings,\n\t\t\tdurationSettings = settings.duration,\n\t\t\tcurrent = eventData.current;\n\t\tvar dur = eventData.stepData.duration || durationSettings.defaultValue;\n\t\tif( current.durationTimeout ) {\n\t\t\tif( durationSettings.barSelector ) {\n\t\t\t\tvar css = {\n\t\t\t\t\ttransitionProperty: durationSettings.barProperty\n\t\t\t\t\t,transitionDuration: '0'\n\t\t\t\t\t,transitionDelay: '0'\n\t\t\t\t\t,transitionTimingFunction: 'linear'\n\t\t\t\t};\n\t\t\t\tcss[durationSettings.barProperty] = durationSettings.barPropertyStart;\n\t\t\t\tvar bars = $(durationSettings.barSelector);\n\t\t\t\t$.jmpress(\"css\", bars, css);\n\t\t\t\tbars.each(function(idx, element) {\n\t\t\t\t\tvar next = $(element).next();\n\t\t\t\t\tvar parent = $(element).parent();\n\t\t\t\t\t$(element).detach();\n\t\t\t\t\tif(next.length) {\n\t\t\t\t\t\tnext.insertBefore(element);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tparent.append(element);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tclearTimeout(current.durationTimeout);\n\t\t\tdelete current.durationTimeout;\n\t\t}\n\t});\n\t$.jmpress(\"setActive\", function( step, eventData ) {\n\t\tvar settings = eventData.settings,\n\t\t\tdurationSettings = settings.duration,\n\t\t\tcurrent = eventData.current;\n\t\tvar dur = eventData.stepData.duration || durationSettings.defaultValue;\n\t\tif( dur && dur > 0 ) {\n\t\t\tif( durationSettings.barSelector ) {\n\t\t\t\tvar css = {\n\t\t\t\t\ttransitionProperty: durationSettings.barProperty\n\t\t\t\t\t,transitionDuration: (dur-settings.transitionDuration*2/3-100)+\"ms\"\n\t\t\t\t\t,transitionDelay: (settings.transitionDuration*2/3)+'ms'\n\t\t\t\t\t,transitionTimingFunction: 'linear'\n\t\t\t\t};\n\t\t\t\tcss[durationSettings.barProperty] = durationSettings.barPropertyEnd;\n\t\t\t\t$.jmpress(\"css\", $(durationSettings.barSelector), css);\n\t\t\t}\n\t\t\tvar jmpress = this;\n\t\t\tif(current.durationTimeout) {\n\t\t\t\tclearTimeout(current.durationTimeout);\n\t\t\t\tcurrent.durationTimeout = undefined;\n\t\t\t}\n\t\t\tcurrent.durationTimeout = setTimeout(function() {\n\t\t\t\tvar action = eventData.stepData.durationAction || durationSettings.defaultAction;\n\t\t\t\t$(jmpress).jmpress(action);\n\t\t\t}, dur);\n\t\t}\n\t});\n}(jQuery, document, window));\n\n/*\n * jmpress.presentation-mode plugin\n * Display a window for the presenter with notes and a control and view of the\n * presentation\n */\n(function( $, document, window, undefined ) {\n\n\t'use strict';\n\tvar $jmpress = $.jmpress;\n\n\tvar PREFIX = \"jmpress-presentation-\";\n\n\t/* FUNCTIONS */\n\tfunction randomString() {\n\t\treturn \"\" + Math.round(Math.random() * 100000, 0);\n\t}\n\n\t/* DEFAULTS */\n\t$jmpress(\"defaults\").presentationMode = {\n\t\tuse: true,\n\t\turl: \"presentation-screen.html\",\n\t\tnotesUrl: false,\n\t\ttransferredValues: [\"userZoom\", \"userTranslateX\", \"userTranslateY\"]\n\t};\n\t$jmpress(\"defaults\").keyboard.keys[80] = \"presentationPopup\"; // p key\n\n\t/* HOOKS */\n\t$jmpress(\"afterInit\", function( nil, eventData) {\n\t\tvar current = eventData.current;\n\n\t\tcurrent.selectMessageListeners = [];\n\n\t\tif(eventData.settings.presentationMode.use) {\n\n\t\t\twindow.addEventListener(\"message\", function(event) {\n\t\t\t\t// We do not test orgin, because we want to accept messages\n\t\t\t\t// from all orgins\n\t\t\t\ttry {\n\t\t\t\t\tif(typeof event.data !== \"string\" || event.data.indexOf(PREFIX) !== 0) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar json = JSON.parse(event.data.slice(PREFIX.length));\n\t\t\t\t\tswitch(json.type) {\n\t\t\t\t\tcase \"select\":\n\t\t\t\t\t\t$.each(eventData.settings.presentationMode.transferredValues, function(idx, name) {\n\t\t\t\t\t\t\teventData.current[name] = json[name];\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif(/[a-z0-9\\-]+/i.test(json.targetId) && typeof json.substep in {number:1,undefined:1}) {\n\t\t\t\t\t\t\t$(eventData.jmpress).jmpress(\"select\", {step: \"#\"+json.targetId, substep: json.substep}, json.reason);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$.error(\"For security reasons the targetId must match /[a-z0-9\\\\-]+/i and substep must be a number.\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"listen\":\n\t\t\t\t\t\tcurrent.selectMessageListeners.push(event.source);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"ok\":\n\t\t\t\t\t\tclearTimeout(current.presentationPopupTimeout);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"read\":\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tevent.source.postMessage(PREFIX + JSON.stringify({type: \"url\", url: window.location.href, notesUrl: eventData.settings.presentationMode.notesUrl}), \"*\");\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\t$.error(\"Cannot post message to source: \" + e);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthrow \"Unknown message type: \" + json.type;\n\t\t\t\t\t}\n\t\t\t\t} catch(e) {\n\t\t\t\t\t$.error(\"Received message is malformed: \" + e);\n\t\t\t\t}\n\t\t\t});\n\t\t\ttry {\n\t\t\t\tif(window.parent && window.parent !== window) {\n\t\t\t\t\twindow.parent.postMessage(PREFIX + JSON.stringify({\n\t\t\t\t\t\t\"type\": \"afterInit\"\n\t\t\t\t\t}), \"*\");\n\t\t\t\t}\n\t\t\t} catch(e) {\n\t\t\t\t$.error(\"Cannot post message to parent: \" + e);\n\t\t\t}\n\t\t}\n\t});\n\t$jmpress(\"afterDeinit\", function( nil, eventData) {\n\t\tif(eventData.settings.presentationMode.use) {\n\t\t\ttry {\n\t\t\t\tif(window.parent && window.parent !== window) {\n\t\t\t\t\twindow.parent.postMessage(PREFIX + JSON.stringify({\n\t\t\t\t\t\t\"type\": \"afterDeinit\"\n\t\t\t\t\t}), \"*\");\n\t\t\t\t}\n\t\t\t} catch(e) {\n\t\t\t\t$.error(\"Cannot post message to parent: \" + e);\n\t\t\t}\n\t\t}\n\t});\n\t$jmpress(\"setActive\", function( step, eventData) {\n\t\tvar stepId = $(eventData.delegatedFrom).attr(\"id\"),\n\t\t\tsubstep = eventData.substep,\n\t\t\treason = eventData.reason;\n\t\t$.each(eventData.current.selectMessageListeners, function(idx, listener) {\n\t\t\ttry {\n\t\t\t\tvar msg = {\n\t\t\t\t\t\"type\": \"select\",\n\t\t\t\t\t\"targetId\": stepId,\n\t\t\t\t\t\"substep\": substep,\n\t\t\t\t\t\"reason\": reason\n\t\t\t\t};\n\t\t\t\t$.each(eventData.settings.presentationMode.transferredValues, function(idx, name) {\n\t\t\t\t\tmsg[name] = eventData.current[name];\n\t\t\t\t});\n\t\t\t\tlistener.postMessage(PREFIX + JSON.stringify(msg), \"*\");\n\t\t\t} catch(e) {\n\t\t\t\t$.error(\"Cannot post message to listener: \" + e);\n\t\t\t}\n\t\t});\n\t});\n\t$jmpress(\"register\", \"presentationPopup\", function() {\n\t\tfunction trySend() {\n\t\t\tjmpress.jmpress(\"current\").presentationPopupTimeout = setTimeout(trySend, 100);\n\t\t\ttry {\n\t\t\t\tpopup.postMessage(PREFIX + JSON.stringify({type: \"url\", url: window.location.href, notesUrl: jmpress.jmpress(\"settings\").presentationMode.notesUrl}), \"*\");\n\t\t\t} catch(e) {\n\t\t\t}\n\t\t}\n\t\tvar jmpress = $(this),\n\t\t\tpopup;\n\t\tif(jmpress.jmpress(\"settings\").presentationMode.use) {\n\t\t\tpopup = window.open($(this).jmpress(\"settings\").presentationMode.url);\n\t\t\tjmpress.jmpress(\"current\").presentationPopupTimeout = setTimeout(trySend, 100);\n\t\t}\n\t});\n}(jQuery, document, window));\n"]}