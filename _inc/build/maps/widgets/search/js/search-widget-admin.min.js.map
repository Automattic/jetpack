{"version":3,"sources":["widgets/search/js/search-widget-admin.js"],"names":["$","args","generateFilterTitlePlaceholder","container","placeholder","isModified","isMonth","type","find","val","text","trim","i18n","indexOf","monthUpdated","month","yearUpdated","year","prop","trackAndBumpMCStats","eventName","extraProps","length","analytics","tracks","mc","replace","recordEvent","bumpStat","defaultFilterCount","document","ready","setListeners","window","JetpackSearch","addFilter","tracksUserData","initialize","userid","username","filtersContainer","template","_","closest","html","append","widget","getContainer","el","on","select","this","selectVal","eventArgs","is_customizer","tracksEventData","attr","addClass","checkbox","checkboxVal","is","filterParent","sortControl","toggleClass","removeAttr","e","preventDefault","stopPropagation","t","post_type","wp","customize","state","set","order","taxonomy","field","interval","count","name_placeholder","name","change","filter","dateField","dateInterval","filterCount","remove","sortable","axis","revert","cancel","update","ui","item","disableSelection","id","off","jQuery","jetpack_search_filter_admin"],"mappings":"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","file":"../../../../widgets/search/js/search-widget-admin.min.js","sourcesContent":["/* Do not modify this file directly. It is compiled from other files. */\n/* globals jetpack_search_filter_admin, jQuery, analytics */\n\n( function( $, args ) {\n\tvar defaultFilterCount = ( 'undefined' !== typeof args && args.defaultFilterCount ) ?\n\t\targs.defaultFilterCount :\n\t\t5; // Just in case we couldn't find the defaultFiltercount arg\n\n\t$( document ).ready( function() {\n\t\tsetListeners();\n\n\t\twindow.JetpackSearch = window.JetpackSearch || {};\n\t\twindow.JetpackSearch.addFilter = addFilter;\n\n\t\t// Initialize Tracks\n\t\tif ( 'undefined' !== typeof analytics && args.tracksUserData ) {\n\t\t\tanalytics.initialize( args.tracksUserData.userid, args.tracksUserData.username );\n\t\t}\n\t} );\n\n\tfunction generateFilterTitlePlaceholder( container ) {\n\t\tvar placeholder = null,\n\t\t\tisModified = null,\n\t\t\tisMonth = null,\n\t\t\ttype = container.find( '.filter-select' ).val();\n\n\t\tif ( 'taxonomy' === type ) {\n\t\t\tplaceholder = container.find('.taxonomy-select option:selected').text().trim();\n\t\t} else if ( 'date_histogram' === type && args && args.i18n ) {\n\t\t\tisModified = ( -1 !== container.find( '.date-field-select' ).val().indexOf( 'modified' ) );\n\t\t\tisMonth = ( 'month' === container.find( '.date-interval-select' ).val() );\n\n\t\t\tif ( isMonth ) {\n\t\t\t\tplaceholder = isModified ?\n\t\t\t\t\targs.i18n.monthUpdated :\n\t\t\t\t\targs.i18n.month;\n\t\t\t} else {\n\t\t\t\tplaceholder = isModified ?\n\t\t\t\t\targs.i18n.yearUpdated :\n\t\t\t\t\targs.i18n.year;\n\t\t\t}\n\t\t} else {\n\t\t\tplaceholder = container.find('.filter-select option:selected').text().trim();\n\t\t}\n\n\t\t$( container ).find('.jetpack-search-filters-widget__title input').prop( 'placeholder', placeholder );\n\t}\n\n\tvar addFilter = function( filtersContainer, args ) {\n\t\tvar template = _.template(\n\t\t\tfiltersContainer\n\t\t\t\t.closest( '.jetpack-search-filters-widget' )\n\t\t\t\t.find( '.jetpack-search-filters-widget__filter-template' )\n\t\t\t\t.html()\n\t\t);\n\t\tgenerateFilterTitlePlaceholder( filtersContainer.append( template( args ) ) );\n\t};\n\n\tvar setListeners = function( widget ) {\n\t\twidget = ( 'undefined' === typeof widget ) ?\n\t\t\t$( '.jetpack-search-filters-widget' ):\n\t\t\twidget;\n\n\t\tvar getContainer = function( el ) {\n\t\t\treturn $( el ).closest('.jetpack-search-filters-widget__filter');\n\t\t};\n\n\t\twidget.on( 'change', '.filter-select', function() {\n\t\t\tvar select = $( this ),\n\t\t\t\tselectVal = select.val(),\n\t\t\t\teventArgs = {\n\t\t\t\t\tis_customizer: args.tracksEventData.is_customizer\n\t\t\t\t};\n\n\t\t\teventArgs.type = selectVal;\n\n\t\t\tselect\n\t\t\t\t.closest( '.jetpack-search-filters-widget__filter' )\n\t\t\t\t.attr( 'class', 'jetpack-search-filters-widget__filter' )\n\t\t\t\t.addClass( 'is-' + selectVal );\n\n\t\t\tgenerateFilterTitlePlaceholder( getContainer( this ) );\n\n\t\t\ttrackAndBumpMCStats( 'changed_filter_type', eventArgs );\n\t\t} );\n\n\t\t// enable showing sort controls only if showing search box is enabled\n\t\twidget.on( 'change', '.jetpack-search-filters-widget__search-box-enabled', function() {\n\t\t\tvar checkbox = $( this ),\n\t\t\t\tcheckboxVal = checkbox.is(':checked'),\n\t\t\t\tfilterParent = checkbox.closest( '.jetpack-search-filters-widget' ),\n\t\t\t\tsortControl = filterParent.find( '.jetpack-search-filters-widget__sort-controls-enabled' );\n\n\t\t\tfilterParent.toggleClass( 'hide-post-types' );\n\n\t\t\tif ( checkboxVal ) {\n\t\t\t\tsortControl.removeAttr( 'disabled' );\n\t\t\t\ttrackAndBumpMCStats( 'enabled_search_box', args.tracksEventData );\n\t\t\t} else {\n\t\t\t\tsortControl.prop( 'checked', false );\n\t\t\t\tsortControl.prop( 'disabled', true );\n\t\t\t\ttrackAndBumpMCStats( 'disabled_search_box', args.tracksEventData );\n\t\t\t}\n\t\t} );\n\n\t\twidget.on( 'change', '.jetpack-search-filters-widget__sort-controls-enabled', function() {\n\t\t\tif ( $( this ).is( ':checked' ) ) {\n\t\t\t\ttrackAndBumpMCStats( 'enabled_sort_controls', args.tracksEventData );\n\t\t\t} else {\n\t\t\t\ttrackAndBumpMCStats( 'disabled_sort_controls', args.tracksEventData );\n\t\t\t}\n\t\t} );\n\n\t\twidget.on( 'click', '.jetpack-search-filters-widget__post-types-select input[type=\"checkbox\"]', function( e ) {\n\t\t\tvar t = $( this );\n\t\t\tvar siblingsChecked = t.closest( '.jetpack-search-filters-widget' )\n\t\t\t\t.find( '.jetpack-search-filters-widget__post-types-select input[type=\"checkbox\"]:checked' );\n\n\t\t\tif ( 0 === siblingsChecked.length ) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\n\t\t\t\ttrackAndBumpMCStats( 'attempted_no_post_types', args.tracksEventData );\n\t\t\t}\n\t\t} );\n\n\t\twidget.on( 'change', '.jetpack-search-filters-widget__post-types-select input[type=\"checkbox\"]', function() {\n\t\t\tvar t = $( this );\n\t\t\tvar eventArgs = {\n\t\t\t\tis_customizer: args.tracksEventData.is_customizer,\n\t\t\t\tpost_type:  t.val()\n\t\t\t};\n\n\t\t\tif ( wp && wp.customize ) {\n\t\t\t\twp.customize.state( 'saved' ).set( false );\n\t\t\t}\n\n\t\t\tif ( t.is( ':checked' ) ) {\n\t\t\t\ttrackAndBumpMCStats( 'added_post_type', eventArgs );\n\t\t\t} else {\n\t\t\t\ttrackAndBumpMCStats( 'removed_post_type', eventArgs );\n\t\t\t}\n\t\t} );\n\n\t\twidget.on( 'change', '.jetpack-search-filters-widget__sort-order', function() {\n\t\t\tvar eventArgs = {\n\t\t\t\tis_customizer: args.tracksEventData.is_customizer\n\t\t\t};\n\n\t\t\teventArgs.order = $( this ).val();\n\n\t\t\tif ( wp && wp.customize ) {\n\t\t\t\twp.customize.state( 'saved' ).set( false );\n\t\t\t}\n\n\t\t\ttrackAndBumpMCStats( 'changed_sort_order', eventArgs );\n\t\t} );\n\n\t\twidget.on( 'change', '.jetpack-search-filters-widget__taxonomy-select select', function() {\n\t\t\tvar eventArgs = {\n\t\t\t\tis_customizer: args.tracksEventData.is_customizer\n\t\t\t};\n\n\t\t\teventArgs.taxonomy = $( this ).val();\n\n\t\t\tgenerateFilterTitlePlaceholder( getContainer( this ) );\n\n\t\t\tif ( wp && wp.customize ) {\n\t\t\t\twp.customize.state( 'saved' ).set( false );\n\t\t\t}\n\n\t\t\ttrackAndBumpMCStats( 'changed_taxonomy', eventArgs );\n\t\t} );\n\n\t\twidget.on( 'change', 'select.date-field-select', function() {\n\t\t\tvar eventArgs = {\n\t\t\t\tis_customizer: args.tracksEventData.is_customizer\n\t\t\t};\n\n\t\t\teventArgs.field = $( this ).val();\n\n\t\t\tgenerateFilterTitlePlaceholder( getContainer( this ) );\n\n\t\t\tif ( wp && wp.customize ) {\n\t\t\t\twp.customize.state( 'saved' ).set( false );\n\t\t\t}\n\n\t\t\ttrackAndBumpMCStats( 'changed_date_field', eventArgs );\n\t\t} );\n\n\t\twidget.on( 'change', 'select.date-interval-select', function() {\n\t\t\tvar eventArgs = {\n\t\t\t\tis_customizer: args.tracksEventData.is_customizer\n\t\t\t};\n\n\t\t\teventArgs.interval = $( this ).val();\n\n\t\t\tgenerateFilterTitlePlaceholder( getContainer( this ) );\n\n\t\t\tif ( wp && wp.customize ) {\n\t\t\t\twp.customize.state( 'saved' ).set( false );\n\t\t\t}\n\n\t\t\ttrackAndBumpMCStats( 'changed_date_interval', eventArgs );\n\t\t} );\n\n\t\twidget.on( 'change', 'input.filter-count', function() {\n\t\t\tvar eventArgs = {\n\t\t\t\tis_customizer: args.tracksEventData.is_customizer\n\t\t\t};\n\n\t\t\teventArgs.count = $( this ).val();\n\n\t\t\tif ( wp && wp.customize ) {\n\t\t\t\twp.customize.state( 'saved' ).set( false );\n\t\t\t}\n\n\t\t\ttrackAndBumpMCStats( 'changed_filter_count', eventArgs );\n\t\t} );\n\n\t\t// add filter button\n\t\twidget.on( 'click', '.jetpack-search-filters-widget__add-filter', function( e ) {\n\t\t\te.preventDefault();\n\n\t\t\tvar filtersContainer = $( this )\n\t\t\t\t.closest( '.jetpack-search-filters-widget' )\n\t\t\t\t.find( '.jetpack-search-filters-widget__filters' );\n\n\t\t\taddFilter( filtersContainer, {\n\t\t\t\ttype: 'taxonomy',\n\t\t\t\ttaxonomy: '',\n\t\t\t\tpost_type: '',\n\t\t\t\tfield: '',\n\t\t\t\tinterval: '',\n\t\t\t\tcount: defaultFilterCount,\n\t\t\t\tname_placeholder: '',\n\t\t\t\tname: ''\n\t\t\t} );\n\n\t\t\tif ( wp && wp.customize ) {\n\t\t\t\twp.customize.state( 'saved' ).set( false );\n\t\t\t}\n\n\t\t\t// Trigger change event to let legacy widget admin know the widget state is \"dirty\"\n\t\t\tfiltersContainer\n\t\t\t\t.find( '.jetpack-search-filters-widget__filter' )\n\t\t\t\t.find( 'input, textarea, select' )\n\t\t\t\t.change();\n\n\t\t\ttrackAndBumpMCStats( 'added_filter', args.tracksEventData );\n\t\t} );\n\n\t\twidget.on( 'click', '.jetpack-search-filters-widget__controls .delete', function( e ) {\n\t\t\te.preventDefault();\n\t\t\tvar filter = $( this ).closest( '.jetpack-search-filters-widget__filter' ),\n\t\t\t\teventArgs = {\n\t\t\t\t\tis_customizer: args.tracksEventData.is_customizer\n\t\t\t\t};\n\n\t\t\teventArgs.type = filter.find( '.filter-select' ).val();\n\n\t\t\tswitch ( eventArgs.type ) {\n\t\t\t\tcase 'taxonomy':\n\t\t\t\t\teventArgs.taxonomy = filter.find( '.jetpack-search-filters-widget__taxonomy-select select' ).val();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'date_histogram':\n\t\t\t\t\teventArgs.dateField = filter.find( '.jetpack-search-filters-widget__date-histogram-select:first select' ).val();\n\t\t\t\t\teventArgs.dateInterval = filter.find( '.jetpack-search-filters-widget__date-histogram-select:nth-child( 2 ) select' ).val();\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\teventArgs.filterCount = filter.find( '.filter-count' ).val();\n\n\t\t\ttrackAndBumpMCStats( 'deleted_filter', eventArgs );\n\n\t\t\tfilter.find( 'input, textarea, select' ).change();\n\t\t\tfilter.remove();\n\n\t\t\tif ( wp && wp.customize ) {\n\t\t\t\twp.customize.state( 'saved' ).set( false );\n\t\t\t}\n\t\t} );\n\n\t\t// make the filters sortable\n\t\t$( '.jetpack-search-filters-widget__filters' ).sortable( {\n\t\t\tplaceholder: 'jetpack-search-filters-widget__filter-placeholder',\n\t\t\taxis: 'y',\n\t\t\trevert: true,\n\t\t\tcancel: 'input,textarea,button,select,option,.jetpack-search-filters-widget__controls a',\n\t\t\tchange: function() {\n\t\t\t\tif ( wp && wp.customize ) {\n\t\t\t\t\twp.customize.state( 'saved' ).set( false );\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate: function( e, ui ) {\n\t\t\t\t$( ui.item ).find( 'input, textarea, select' ).change();\n\t\t\t}\n\t\t} )\n\t\t.disableSelection();\n\t};\n\n\t// When widgets are updated, remove and re-add listeners\n\t$( document ).on( 'widget-updated widget-added', function( e, widget ) {\n\t\twidget = $( widget );\n\n\t\tvar id = widget.attr( 'id' ),\n\t\t\tisJetpackSearch = ( id && ( -1 !== id.indexOf( 'jetpack-search-filters' ) ) );\n\n\t\tif ( ! isJetpackSearch ) {\n\t\t\t return;\n\t\t}\n\n\t\t// Intentionally not tracking widget additions and updates here as these events\n\t\t// seem noisy in the customizer. We'll track those via PHP.\n\n\t\twidget.off( 'change', '.filter-select' );\n\t\twidget.off( 'click', '.jetpack-search-filters-widget__controls .delete' );\n\t\twidget.off( 'change', '.jetpack-search-filters-widget__use-filters' );\n\t\twidget.off( 'change', '.jetpack-search-filters-widget__search-box-enabled' );\n\t\twidget.off( 'change', '.jetpack-search-filters-widget__sort-controls-enabled' );\n\t\twidget.off( 'change', '.jetpack-search-filters-widget__sort-controls-enabled' );\n\t\twidget.off( 'change', '.jetpack-search-filters-widget__post-type-selector' );\n\t\twidget.off( 'change', '.jetpack-search-filters-widget__sort-order' );\n\t\twidget.off( 'change', '.jetpack-search-filters-widget__taxonomy-select' );\n\t\twidget.off( 'change', '.jetpack-search-filters-widget__date-histogram-select:first select' );\n\t\twidget.off( 'change', '.jetpack-search-filters-widget__date-histogram-select:eq(1) select' );\n\t\twidget.off( 'click', '.jetpack-search-filters-widget__post-types-select input[type=\"checkbox\"]' );\n\t\twidget.off( 'click', '.jetpack-search-filters-widget__add-filter');\n\n\t\tsetListeners( widget );\n\t} );\n\n\t/**\n\t * This function will fire both a Tracks and MC stat.\n\t *\n\t * Tracks: Will be prefixed by 'jetpack_widget_search_' and use underscores.\n\t * MC: Will not be prefixed, and will use dashes.\n\t *\n\t * Logic borrowed from `idc-notice.js`.\n\t *\n\t * @param eventName string\n\t * @param extraProps object\n\t */\n\tfunction trackAndBumpMCStats( eventName, extraProps ) {\n\t\tif ( 'undefined' === typeof extraProps || 'object' !== typeof extraProps ) {\n\t\t\textraProps = {};\n\t\t}\n\n\t\tif ( eventName && eventName.length && 'undefined' !== typeof analytics && analytics.tracks && analytics.mc ) {\n\t\t\t// Format for Tracks\n\t\t\teventName = eventName.replace( /-/g, '_' );\n\t\t\teventName = eventName.indexOf( 'jetpack_widget_search_' ) !== 0 ? 'jetpack_widget_search_' + eventName : eventName;\n\t\t\tanalytics.tracks.recordEvent( eventName, extraProps );\n\n\t\t\t// Now format for MC stats\n\t\t\teventName = eventName.replace( 'jetpack_widget_search_', '' );\n\t\t\teventName = eventName.replace( /_/g, '-' );\n\t\t\tanalytics.mc.bumpStat( 'jetpack-search-widget', eventName );\n\t\t}\n\t}\n} )( jQuery, jetpack_search_filter_admin );\n"]}