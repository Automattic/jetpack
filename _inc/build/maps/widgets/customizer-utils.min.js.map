{"version":3,"sources":["widgets/customizer-utils.js"],"names":["wp","customizerHasPartialWidgetRefresh","customize","selectiveRefresh","widgetsPreview","WidgetPartial","isJetpackWidgetPlaced","placement","widgetName","partial","widgetId","indexOf","$","document","ready","bind","container","gapi","person","go","FB","XFBML","parse","$fbContainer","find","fbWidth","data","fbHeight","css","width","height","setTimeout","position","twttr","widgets","load","hasClass","addClass","removeClass","fadeIn","buttonId","attr","replace","PaypalExpressCheckout","renderButton","e","length","refresh","jQuery"],"mappings":";;AAWAA,GAAGC,kCAAoC,WACtC,MAAO,gBAAoBD,KAAM,kBAAsBA,IAAGE,WAAa,gBAAoBF,IAAGE,UAAUC,kBAAoB,gBAAoBH,IAAGE,UAAUE,gBAAkB,kBAAsBJ,IAAGE,UAAUE,eAAeC,eASlOL,GAAGM,sBAAwB,SAAUC,EAAWC,GAC/C,MAAOD,GAAUE,QAAQC,UAAY,IAAMH,EAAUE,QAAQC,SAASC,QAASH,IAMhF,SAAUI,GAETA,EAAGC,UAAWC,MAAO,WAEfd,IAAMA,GAAGE,WAAaF,GAAGC,sCAG7BD,GAAGE,UAAUC,iBAAiBY,KAAM,2BAA4B,SAAWR,GAC1E,GAAKA,EAAUS,UAGd,GAAKhB,GAAGM,sBAAuBC,EAAW,qBAAwB,gBAAoBU,OAAQA,KAAKC,QAAU,kBAAsBD,MAAKC,OAAOC,GAC9IF,KAAKC,OAAOC,GAAIZ,EAAUS,UAAU,QAIhC,IAAKhB,GAAGM,sBAAuBC,EAAW,qBAAwB,gBAAoBa,KAAM,gBAAoBA,IAAGC,OAAS,kBAAsBD,IAAGC,MAAMC,MAC/JF,GAAGC,MAAMC,MAAOf,EAAUS,UAAU,GAAI,WACvC,GAAIO,GAAeX,EAAGL,EAAUS,UAAU,IAAKQ,KAAM,qBACpDC,EAAUF,EAAaG,KAAM,SAC7BC,EAAWJ,EAAaG,KAAM,SAC/BH,GAAaC,KAAM,QAASI,KAAOC,MAASJ,EAASK,OAAUH,IAC/DI,WAAY,WACXR,EAAaC,KAAM,UAAWI,KAAOC,MAASJ,EAASK,OAAUH,EAAUK,SAAY,cACrF,SAKA,IAAKhC,GAAGM,sBAAuBC,EAAW,qBAAwB,gBAAoB0B,QAAS,gBAAoBA,OAAMC,SAAW,kBAAsBD,OAAMC,QAAQC,KAC5KF,MAAMC,QAAQC,KAAM5B,EAAUS,UAAU,QAClC,IAAKhB,GAAGM,sBAAuBC,EAAW,wBAE3CK,EAAG,kBAAmBwB,SAAU,OACpCxB,EAAG,gCAAiCyB,SAAU,OAE9CzB,EAAG,gCAAiC0B,YAAa,OAElD/B,EAAUS,UAAUuB,aACd,IAAKvC,GAAGM,sBAAuBC,EAAW,kCAEhD,IACC,GAAIiC,GAAW5B,EAAG,kCAAmCL,EAAUS,WAAYyB,KAAM,MAAOC,QAAS,UAAW,GAC5GC,uBAAsBC,aAAc,KAAM,KAAMJ,EAAU,MACzD,MAAQK,OAUb7C,GAAGE,UAAUC,iBAAiBY,KAAM,wBAAyB,SAAUR,GACjEA,EAAUS,YAEThB,GAAGM,sBAAuBC,EAAW,qBAAwBA,EAAUS,UAAUQ,KAAM,4CAA6CsB,OACxIvC,EAAUE,QAAQsC,UACP/C,GAAGM,sBAAuBC,EAAW,mCAEhDA,EAAUE,QAAQsC,iBAMnBC","file":"../../widgets/customizer-utils.min.js","sourcesContent":["/* Do not modify this file directly. It is compiled from other files. */\n/* global wp, gapi, FB, twttr, PaypalExpressCheckout */\n\n/**\n * Utilities to work with widgets in Customizer.\n */\n\n/**\n * Checks whether this Customizer supports partial widget refresh.\n * @returns {boolean}\n */\nwp.customizerHasPartialWidgetRefresh = function() {\n\treturn 'object' === typeof wp && 'function' === typeof wp.customize\t&& 'object' === typeof wp.customize.selectiveRefresh && 'object' === typeof wp.customize.widgetsPreview && 'function' === typeof wp.customize.widgetsPreview.WidgetPartial;\n};\n\n/**\n * Verifies that the placed widget ID contains the widget name.\n * @param {object} placement\n * @param {string} widgetName\n * @returns {*|boolean}\n */\nwp.isJetpackWidgetPlaced = function( placement, widgetName ) {\n\treturn placement.partial.widgetId && 0 === placement.partial.widgetId.indexOf( widgetName );\n};\n\n/**\n * Bind events for selective refresh in Customizer.\n */\n(function($){\n\n\t$( document ).ready( function() {\n\n\t\tif ( wp && wp.customize && wp.customizerHasPartialWidgetRefresh() ) {\n\n\t\t\t// Refresh widget contents when a partial is rendered.\n\t\t\twp.customize.selectiveRefresh.bind( 'partial-content-rendered', function ( placement ) {\n\t\t\t\tif ( placement.container ) {\n\n\t\t\t\t\t// Refresh Google+\n\t\t\t\t\tif ( wp.isJetpackWidgetPlaced( placement, 'googleplus-badge' ) && 'object' === typeof gapi && gapi.person && 'function' === typeof gapi.person.go ) {\n\t\t\t\t\t\tgapi.person.go( placement.container[0] );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Refresh Facebook XFBML\n\t\t\t\t\telse if ( wp.isJetpackWidgetPlaced( placement, 'facebook-likebox' ) && 'object' === typeof FB && 'object' === typeof FB.XFBML && 'function' === typeof FB.XFBML.parse ) {\n\t\t\t\t\t\tFB.XFBML.parse( placement.container[0], function() {\n\t\t\t\t\t\t\tvar $fbContainer = $( placement.container[0] ).find( '.fb_iframe_widget' ),\n\t\t\t\t\t\t\t\tfbWidth = $fbContainer.data( 'width' ),\n\t\t\t\t\t\t\t\tfbHeight = $fbContainer.data( 'height' );\n\t\t\t\t\t\t\t$fbContainer.find( 'span' ).css( { 'width': fbWidth, 'height': fbHeight } );\n\t\t\t\t\t\t\tsetTimeout( function() {\n\t\t\t\t\t\t\t\t$fbContainer.find( 'iframe' ).css( { 'width': fbWidth, 'height': fbHeight, 'position': 'relative' } );\n\t\t\t\t\t\t\t}, 1 );\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Refresh Twitter\n\t\t\t\t\telse if ( wp.isJetpackWidgetPlaced( placement, 'twitter_timeline' ) && 'object' === typeof twttr && 'object' === typeof twttr.widgets && 'function' === typeof twttr.widgets.load ) {\n\t\t\t\t\t\ttwttr.widgets.load( placement.container[0] );\n\t\t\t\t\t} else if ( wp.isJetpackWidgetPlaced( placement, 'eu_cookie_law_widget' ) ) {\n\t\t\t\t\t\t// Refresh EU Cookie Law\n\t\t\t\t\t\tif ( $( '#eu-cookie-law' ).hasClass( 'top' ) ) {\n\t\t\t\t\t\t\t$( '.widget_eu_cookie_law_widget' ).addClass( 'top' );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$( '.widget_eu_cookie_law_widget' ).removeClass( 'top' );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tplacement.container.fadeIn();\n\t\t\t\t\t} else if ( wp.isJetpackWidgetPlaced( placement, 'jetpack_simple_payments_widget' ) ) {\n\t\t\t\t\t\t// Refresh Simple Payments Widget\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tvar buttonId = $( '.jetpack-simple-payments-button', placement.container ).attr( 'id' ).replace( '_button', '' );\n\t\t\t\t\t\t\tPaypalExpressCheckout.renderButton( null, null, buttonId, null );\n\t\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\t\t// PaypalExpressCheckout may fail.\n\t\t\t\t\t\t\t// For the same usage, see also:\n\t\t\t\t\t\t\t// https://github.com/Automattic/jetpack/blob/6c1971e6bed7d3df793392a7a58ffe0afaeeb5fe/modules/simple-payments/simple-payments.php#L111\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t// Refresh widgets when they're moved.\n\t\t\twp.customize.selectiveRefresh.bind( 'partial-content-moved', function( placement ) {\n\t\t\t\tif ( placement.container ) {\n\t\t\t\t\t// Refresh Twitter timeline iframe, since it has to be re-built.\n\t\t\t\t\tif ( wp.isJetpackWidgetPlaced( placement, 'twitter_timeline' ) && placement.container.find( 'iframe.twitter-timeline:not([src]):first' ).length ) {\n\t\t\t\t\t\tplacement.partial.refresh();\n\t\t\t\t\t} else if ( wp.isJetpackWidgetPlaced( placement, 'jetpack_simple_payments_widget' ) ) {\n\t\t\t\t\t\t// Refresh Simple Payments Widget\n\t\t\t\t\t\tplacement.partial.refresh();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t} );\n} )( jQuery );\n"]}