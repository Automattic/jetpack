/**
 * External dependencies
 */
import React, { Component } from 'react';
import forEach from 'lodash/forEach';
import get from 'lodash/get';
import Card from 'components/card';
import Chart from 'components/chart';
import { connect } from 'react-redux';
import DashSectionHeader from 'components/dash-section-header';
import Button from 'components/button';
import Spinner from 'components/spinner';
import { numberFormat, moment, translate as __ } from 'i18n-calypso';
import analytics from 'lib/analytics';
import includes from 'lodash/includes';

/**
 * Internal dependencies
 */
import { imagePath } from 'constants';
import { isDevMode, isCurrentUserLinked, getConnectUrl } from 'state/connection';
import {
	getInitialStateStatsData
} from 'state/initial-state';
import QueryStatsData from 'components/data/query-stats-data';
import DashStatsBottom from './dash-stats-bottom';
import {
	getStatsData,
	statsSwitchTab,
	fetchStatsData,
	getActiveStatsTab as _getActiveStatsTab
} from 'state/at-a-glance';
import { getModules } from 'state/modules';
import { emptyStatsCardDismissed } from 'state/settings';

class DashStats extends Component {
	constructor( props ) {
		super( props );
		this.state = {
			emptyStatsDismissed: props.isEmptyStatsCardDismissed,
		};
	}

	barClick( bar ) {
		if ( bar.data.link ) {
			analytics.tracks.recordJetpackClick( 'stats_bar' );
			window.open(
				bar.data.link,
				'_blank'
			);
		}
	}

	statsChart( unit ) {
		const props = this.props,
			s = [];

		let totalViews = 0;

		if ( 'object' !== typeof props.statsData[ unit ] ) {
			return { chartData: s, totalViews: false };
		}

		forEach( props.statsData[ unit ].data, function( v ) {
			const views = v[ 1 ];
			let date = v[ 0 ],
				chartLabel = '',
				tooltipLabel = '';

			// Increment total views for the period
			totalViews += views;

			if ( 'day' === unit ) {
				chartLabel = moment( date ).format( 'MMM D' );
				tooltipLabel = moment( date ).format( 'MMMM Do' );
			} else if ( 'week' === unit ) {
				date = date.replace( /W/g, '-' );
				chartLabel = moment( date ).format( 'MMM D' );
				tooltipLabel = __( 'Week of %(date)s', { args: { date: moment( date ).format( 'MMMM Do' ) } } );
			} else if ( 'month' ) {
				chartLabel = moment( date ).format( 'MMM' );
				tooltipLabel = moment( date ).format( 'MMMM, YYYY' );
			}

			s.push( {
				label: chartLabel,
				value: views,
				nestedValue: null,
				className: 'statsChartbar',
				data: {
					link: `https://wordpress.com/stats/${ unit }/${ props.siteRawUrl }?startDate=${ date }`
				},
				tooltipData: [ {
					label: tooltipLabel,
					value: __( 'Views: %(numberOfViews)s', { args: { numberOfViews: numberFormat( views ) } } ),
					className: 'tooltip class'
				}, { label: __( 'Click to view detailed stats.' ) } ]
			} );
		} );

		return { chartData: s, totalViews: totalViews };
	}

	/**
	 * Checks that the stats fetching didn't return errors.
	 *
	 * @returns {object|bool} Returns statsData.general.errors or false if it is not an object
	 */
	statsErrors() {
		return get( this.props.statsData, [ 'general', 'errors' ], false );
	}

	renderStatsChart( chartData ) {
		return (
			<div>
				<div className="jp-at-a-glance__stats-chart">
					<Chart data={ chartData } barClick={ this.barClick } />
					{
						0 < chartData.length ? '' : <Spinner />
					}
				</div>
				<div id="stats-bottom" className="jp-at-a-glance__stats-bottom">
					<DashStatsBottom
						statsData={ this.props.statsData }
						siteRawUrl={ this.props.siteRawUrl }
						siteAdminUrl={ this.props.siteAdminUrl }
						isLinked={ this.props.isLinked }
						connectUrl={ this.props.connectUrl }
					/>
				</div>
			</div>
		);
	}

	renderEmptyStatsCard() {
		const dismissCard = () => {
			this.setState( { emptyStatsDismissed: true } );
			this.props.updateOptions( { dismiss_empty_stats_card: true } );
		};
		return (
			<Card className="jp-at-a-glance__stats-empty">
				<svg xmlns="http://www.w3.org/2000/svg" className="jp-at-a-glance__stats-icon" width="272" height="144" viewBox="0 0 272 144">
					<path fill="#C8D7E2" d="M148.4598 117.4002C149.0598 117.1002 149.6598 116.7992 150.3598 116.7992L152.5598 116.7992 148.9598 118.2992C145.9598 119.5002 143.0598 120.9002 140.1598 122.2002 138.6598 122.7992 137.3598 123.6002 135.8598 124.2992 134.3598 125.0002 132.9598 125.7002 131.5598 126.5002 128.6598 127.9002 125.8598 129.5002 123.1598 131.1002L123.0598 131.1002C122.9598 131.1002 123.0598 131.0002 123.0598 131.0002 125.6598 129.2002 128.4598 127.6002 131.2598 126.0002 132.6598 125.2002 134.0598 124.4002 135.4598 123.7002 136.8598 123.0002 138.3598 122.2002 139.7598 121.5002 142.6598 120.1002 145.5598 118.7002 148.4598 117.4002zM269.8602 90.4002L260.2592 90.7992 255.4602 91.0002C253.8602 91.0002 252.2592 91.2002 250.6602 91.4002 244.2592 92.1002 237.8602 92.5002 231.5592 93.6002 228.3602 94.1002 225.2592 94.5002 222.0592 95.1002L212.6602 97.0002C209.4602 97.6002 206.3602 98.2992 203.2592 99.1002L198.6602 100.2002 198.6602 101.2002 198.8602 101.1002 203.5592 100.0002C206.6602 99.2992 209.7592 98.5002 212.9602 97.9002L222.3602 96.1002C225.4602 95.5002 228.6602 95.1002 231.8602 94.6002 238.1602 93.5002 244.4602 92.9002 250.8602 92.2002 254.0592 91.7992 257.2592 91.7002 260.4602 91.5002L270.0592 90.7992C270.1602 90.7992 270.2592 90.7002 270.2592 90.6002 270.0592 90.5002 269.9602 90.4002 269.8602 90.4002"/>
					<path fill="#E9EFF4" d="M10.9598 13.8001C13.0598 13.7001 15.2598 13.6001 17.4598 13.6001 19.5598 13.6001 21.7598 13.5001 23.9598 13.5001L23.4598 13.7001C24.0598 11.6001 25.0598 9.6001 26.1598 7.7001 27.2598 5.8001 28.9598 4.2001 30.9598 3.2001 35.3598 1.2001 40.7598 4.2001 41.7598 8.8001 41.8598 9.4001 41.8598 10.0001 41.7598 10.6001 41.6598 11.3001 41.2598 11.9001 40.6598 12.3001 40.0598 12.7001 39.4598 12.8001 38.7598 12.8001 38.0598 12.8001 37.3598 12.6001 36.8598 12.0001 36.4598 11.4001 36.3598 10.7001 36.5598 10.0001 36.7598 9.4001 37.0598 8.9001 37.4598 8.4001 38.2598 7.5001 39.2598 6.9001 40.3598 6.5001 41.4598 6.1001 42.6598 6.0001 43.7598 6.1001 44.9598 6.2001 46.0598 6.6001 46.9598 7.4001 47.8598 8.2001 48.4598 9.2001 48.6598 10.4001 48.9598 11.5001 48.9598 12.7001 48.8598 13.8001L48.4598 13.3001C53.1598 13.3001 57.8598 13.4001 62.5598 13.5001 62.6598 13.5001 62.7598 13.6001 62.7598 13.7001 62.7598 13.8001 62.6598 13.9001 62.5598 13.9001 57.8598 14.0001 53.1598 14.1001 48.4598 14.1001 48.2598 14.1001 48.0598 13.9001 48.0598 13.7001L48.0598 13.6001C48.2598 11.6001 47.8598 9.3001 46.4598 8.1001 45.6598 7.5001 44.7598 7.1001 43.7598 7.1001 42.7598 7.0001 41.7598 7.1001 40.7598 7.4001 39.8598 7.7001 38.9598 8.3001 38.3598 9.0001 38.0598 9.3001 37.7598 9.7001 37.6598 10.2001 37.5598 10.5001 37.5598 10.9001 37.7598 11.2001 38.4598 11.7001 39.3598 11.7001 39.9598 11.2001 40.5598 10.6001 40.8598 9.7001 40.5598 8.8001 40.0598 6.8001 38.7598 5.2001 36.9598 4.3001 36.0598 3.9001 35.1598 3.6001 34.1598 3.5001 33.1598 3.4001 32.1598 3.6001 31.2598 4.0001 29.3598 4.9001 27.8598 6.3001 26.7598 8.1001 25.5598 9.9001 24.6598 11.8001 24.0598 13.8001 23.9598 14.0001 23.8598 14.1001 23.6598 14.1001 21.5598 14.1001 19.3598 14.0001 17.1598 14.0001 14.9598 14.0001 12.8598 13.9001 10.6598 13.8001L10.5598 13.7001 10.9598 13.8001zM9.9598 141.4998C30.7598 140.9998 51.6598 140.8998 72.4598 140.7998L134.9598 140.6998 197.4598 140.7998 228.6598 140.9998 244.2598 141.1008 259.8598 141.2998C260.0598 141.2998 260.1598 141.4998 260.1598 141.6998 260.1598 141.8998 260.0598 141.9998 259.8598 141.9998L244.2598 142.1998 228.6598 142.2998 197.4598 142.4998 134.9598 142.6998 72.4598 142.6008C51.6598 142.4998 30.7598 142.3998 9.9598 141.8998 9.8598 141.8998 9.7598 141.7998 9.7598 141.6998 9.7598 141.6008 9.8598 141.4998 9.9598 141.4998"/>
					<path fill="#FFF" d="M123.0599 130.9998C123.0599 130.9998 180.3599 93.6008 269.8599 90.6998M123.16 116.4002C131.86 119.7992 137.16 122.4002 137.16 122.4002M.0599 104.7996C18.7599 97.4006 40.3599 96.9996 60.8599 99.6996"/>
					<path fill="#C8D7E2" d="M0.0599,104.7 C4.7599,102.6 9.7599,101 14.7599,99.9 C19.8599,98.8 24.9599,98.2 30.1599,97.8 C40.4599,97.2 50.8599,97.7 61.0599,99.4 C61.1599,99.4 61.2599,99.5 61.2599,99.6 C61.2599,99.7 61.1599,99.8 61.0599,99.8 C50.8599,98.6 40.5599,98.4 30.3599,98.9 C25.2599,99.2 20.1599,99.8 15.1599,100.8 C10.1599,101.8 5.1599,103.1 0.3599,104.8 C0.2599,104.8 0.2599,104.8 0.2599,104.7 C-0.0401,104.8 -0.0401,104.8 0.0599,104.7"/>
					<path fill="#FFF" d="M62.0599,117.6004 L61.8599,16.2004"/>
					<path fill="#C8D7E2" d="M61.8597 117.6004C61.0597 109.2004 61.0597 100.7004 61.0597 92.2994L60.8597 66.9994 60.9597 41.7004C60.9597 33.2004 60.9597 24.8004 61.7597 16.4004L62.2597 16.4004C62.9597 24.7004 62.9597 33.1004 62.9597 41.6004L63.1597 66.9004 63.0597 92.2004C63.0597 100.6004 63.0597 109.1004 62.2597 117.6004L61.8597 117.6004zM198.7596 21.2C199.0596 29.2 199.1596 37.1 199.2596 45 199.3606 52.9 199.3606 60.9 199.4596 68.8L199.5596 116.5 199.5596 117.6 198.4596 117.6 169.0596 117.7 139.6596 117.6 110.2596 117.5C100.4596 117.4 90.6596 117.3 80.8596 116.7L80.8596 116.2C90.6596 115.6 100.4596 115.6 110.2596 115.4L139.6596 115.3 169.0596 115.2 198.4596 115.3 197.3606 116.4 197.4596 68.7C197.5596 60.8 197.5596 52.8 197.6596 44.9 197.7596 37 197.9596 29 198.1596 21.1L198.7596 21.2z"/>
					<path fill="#74DCFC" d="M60.8597,21.2 L60.8597,8.2 C60.8597,3.7 64.5597,0 69.0597,0 L190.2597,0 C194.7597,0 198.4597,3.7 198.4597,8.2 L198.4597,21.2 L60.8597,21.2 Z"/>
					<path fill="#004F81" d="M205.3602,21.4998 C192.7592,22.2998 180.1602,22.2998 167.5592,22.2998 L129.7592,22.3998 L91.9602,22.2998 C79.3602,22.2998 66.7592,22.2998 54.1602,21.4998 L54.1602,20.9998 C66.7592,20.1998 79.3602,20.1998 91.9602,20.1998 L129.7592,20.0998 L167.5592,20.1998 C180.1602,20.1998 192.7592,20.1998 205.3602,20.9998 L205.3602,21.4998 Z"/>
					<path fill="#C8D7E2" d="M227.16,48.4998 L226.16,45.0998 C223.36,45.4998 222.16,43.8998 221.059,41.3998 C220.76,40.6998 219.36,40.7998 219.26,39.9998 C219.16,38.8998 220.76,38.1998 220.66,35.9998 C220.66,34.7998 220.86,33.1998 222.059,32.9998 C222.059,32.9998 227.46,35.2998 230.16,38.1998 C231.36,41.4998 232.059,43.0998 232.059,43.0998 L233.46,46.4998 L227.16,48.4998 Z"/>
					<path fill="#FFF" d="M71.2596,136.7996 C71.2596,136.7996 68.4596,116.2996 65.4596,113.2996 C70.5596,117.6996 76.2596,129.7996 76.2596,136.7996"/>
					<path fill="#C8D7E2" d="M71.16,136.7996 C70.36,132.7996 69.56,128.7996 68.66,124.9006 C68.26,122.9006 67.76,120.9996 67.26,118.9996 C66.96,117.9996 66.66,117.1006 66.36,116.1006 C66.06,115.1996 65.66,114.4006 65.06,113.6006 C64.86,113.4006 64.86,112.9996 65.16,112.7996 C65.36,112.6006 65.66,112.6006 65.86,112.7996 C67.46,114.2996 68.96,116.1006 70.16,117.9996 C71.36,119.9006 72.46,121.7996 73.36,123.9006 C74.26,125.9006 75.06,127.9996 75.66,130.1006 C76.36,132.1996 76.66,134.4996 76.66,136.6996 C76.66,136.7996 76.56,136.9006 76.46,136.9006 C76.36,136.9006 76.26,136.7996 76.26,136.6996 C76.06,134.4996 75.66,132.4006 74.96,130.2996 C74.26,128.1996 73.46,126.1996 72.56,124.1996 C71.66,122.1996 70.56,120.2996 69.36,118.4996 C68.26,116.6996 66.86,114.9996 65.26,113.6006 L66.06,112.7996 C66.76,113.6006 67.26,114.6006 67.66,115.6996 C68.06,116.6996 68.36,117.6996 68.56,118.6006 C69.06,120.6006 69.56,122.6006 69.96,124.6006 C70.36,126.6006 70.66,128.6006 70.96,130.6006 C71.26,132.6006 71.46,134.6006 71.66,136.6996 C71.36,136.9006 71.36,136.9006 71.16,136.7996 C71.26,136.9006 71.26,136.9006 71.16,136.7996"/>
					<path fill="#FFF" d="M76.3597,136.4998 C76.3597,136.4998 77.0597,120.3998 74.0597,117.6008 C79.1597,121.6998 82.3597,130.9998 81.6597,136.8998"/>
					<path fill="#C8D7E2" d="M76.2596,136.4998 C76.0596,133.2998 76.0596,130.1008 75.7596,126.8998 C75.6596,125.2998 75.4596,123.6998 75.2596,122.1998 C75.1596,121.3998 74.9596,120.6998 74.7596,119.8998 C74.5596,119.1998 74.2596,118.6008 73.7596,117.9998 C73.5596,117.7998 73.5596,117.3998 73.8596,117.1998 C74.0596,116.9998 74.3596,116.9998 74.5596,117.1998 C75.9596,118.3998 77.1596,119.7998 78.1596,121.3998 C79.1596,122.8998 79.9596,124.6008 80.5596,126.2998 C81.1596,127.9998 81.6596,129.7998 81.9596,131.6008 C82.2596,133.3998 82.2596,135.1998 82.0596,136.9998 C82.0596,137.1008 81.9596,137.1998 81.8596,137.1998 C81.7596,137.1998 81.6596,137.1008 81.6596,136.9998 C81.7596,135.1998 81.5596,133.4998 81.1596,131.7998 C80.7596,130.1008 80.2596,128.3998 79.6596,126.7998 C78.4596,123.4998 76.4596,120.6008 73.8596,118.1998 L74.6596,117.2998 C75.2596,117.9998 75.6596,118.7998 75.8596,119.6998 C76.0596,120.4998 76.2596,121.2998 76.3596,122.1008 C76.6596,123.6998 76.7596,125.2998 76.8596,126.9998 C76.9596,128.6008 76.9596,130.1998 76.8596,131.8998 C76.7596,133.6008 76.6596,135.1008 76.5596,136.6998 C76.5596,136.7998 76.4596,136.7998 76.4596,136.7998 C76.2596,136.6998 76.2596,136.6008 76.2596,136.4998"/>
					<g transform="translate(46 93.7)">
						<path fill="#FFF" d="M1.3597,0.9004 C5.7597,9.2994 6.4597,12.7004 5.7597,17.5004 L0.3597,28.5994"/>
						<path stroke="#74DCFC" stroke-linecap="round" stroke-linejoin="round" d="M1.3597,0.9004 C5.7597,9.2994 6.4597,12.7004 5.7597,17.5004 L0.3597,28.5994"/>
					</g>
					<path fill="#74DCFC" d="M34.3597,60.4998 C33.1597,67.6998 32.8597,81.2998 32.8597,81.2998 L46.2597,81.8998 C46.2597,81.8998 48.8597,66.2998 47.3597,63.3998"/>
					<path fill="#FFF" d="M49.0599,52.3001 C50.2599,62.1001 45.7599,65.4001 44.2599,63.5001"/>
					<path fill="#74DCFC" d="M48.5599,52.3001 C48.6599,53.4001 48.7599,54.4001 48.7599,55.3001 C48.7599,58.2001 48.1599,60.3001 47.4599,61.6001 C47.0599,62.3001 46.6599,62.7001 46.2599,63.0001 C45.8599,63.3001 45.5599,63.4001 45.2599,63.4001 C44.9599,63.4001 44.7599,63.3001 44.5599,63.1001 C44.3599,62.9001 44.0599,62.8001 43.8599,63.0001 C43.6599,63.2001 43.5599,63.5001 43.7599,63.7001 C44.1599,64.2001 44.6599,64.4001 45.1599,64.4001 C45.7599,64.4001 46.2599,64.2001 46.7599,63.8001 C48.2599,62.6001 49.5599,59.8001 49.6599,55.3001 C49.6599,54.3001 49.5599,53.3001 49.4599,52.2001 C49.4599,51.9001 49.1599,51.7001 48.8599,51.8001 C48.7599,51.8001 48.5599,52.1001 48.5599,52.3001"/>
					<path fill="#FFF" d="M49.9598,38.8001 C51.0598,39.4001 51.7598,40.5001 51.9598,41.8001 C52.2598,44.1001 54.1598,44.7001 54.1598,45.8001 C54.1598,46.7001 52.6598,46.8001 52.3598,47.6001 C51.7598,50.5001 49.1598,52.5001 46.2598,52.5001"/>
					<path fill="#004F82" d="M49.66,39.2 C50.66,39.8 51.26,40.7 51.46,41.8 L51.96,41.7 L51.46,41.8 C51.66,43.1 52.26,43.9 52.76,44.5 L53.46,45.2 C53.66,45.4 53.66,45.5 53.66,45.7 C53.66,45.8 53.66,45.8 53.56,45.9 C53.46,46 53.16,46.2 52.76,46.4 C52.56,46.5 52.46,46.6 52.26,46.8 C52.06,47 51.96,47.2 51.86,47.4 C51.26,50 48.96,51.9 46.26,51.9 C45.96,51.9 45.76,52.1 45.76,52.4 C45.76,52.7 45.96,52.9 46.26,52.9 C49.46,52.9 52.16,50.7 52.86,47.6 L52.36,47.5 L52.86,47.6 C52.86,47.6 52.96,47.5 53.06,47.4 C53.26,47.2 53.56,47.1 53.96,46.9 C54.16,46.8 54.26,46.7 54.46,46.5 C54.56,46.3 54.66,46.1 54.66,45.8 C54.66,45.4 54.46,45 54.26,44.7 C53.56,43.8 52.66,43.3 52.46,41.7 C52.26,40.3 51.46,39.1 50.26,38.3 C50.06,38.2 49.76,38.2 49.56,38.5 C49.36,38.8 49.46,39.1 49.66,39.2"/>
					<path fill="#004F82" d="M49.8597 48.4002C50.1597 49.1002 50.7597 49.7002 51.4597 50.0002 51.6597 50.1002 51.9597 50.0002 52.1597 49.8002 52.2597 49.6002 52.1597 49.3002 51.9597 49.1002 51.4597 48.9002 51.0597 48.5002 50.8597 48.0002 50.7597 47.7002 50.4597 47.6002 50.1597 47.7002 49.8597 47.8002 49.7597 48.1002 49.8597 48.4002M50.8597 43.7L50.8597 43.7C51.0597 43.7 51.2597 43.9 51.2597 44.1L51.2597 44.8C51.2597 45 51.0597 45.2 50.8597 45.2 50.6597 45.2 50.4597 45 50.4597 44.8L50.4597 44.1C50.4597 43.9 50.6597 43.7 50.8597 43.7M37.0599 56.9002C40.8599 55.4002 48.6599 69.7002 48.6599 69.7002L56.5599 56.9002 60.9599 58.7002C60.9599 58.7002 56.9599 76.7992 49.1599 77.5002L35.2599 66.7002C35.2599 66.7002 32.1599 58.9002 37.0599 56.9002"/>
					<path fill="#FFF" d="M33.5599,80.6004 C29.9599,89.4004 34.1599,139.9004 34.1599,139.9004 L44.3599,139.9004 C44.3599,139.9004 49.4599,91.4004 45.9599,81.2004"/>
					<path fill="#74DCFC" d="M33.0599,80.4002 C32.4599,81.7992 32.1599,84.1002 31.8599,87.0002 C31.6599,89.9002 31.5599,93.5002 31.5599,97.2992 C31.5599,115.2002 33.5599,139.7992 33.5599,139.7992 C33.5599,140.1002 33.7599,140.2992 34.0599,140.2992 L44.2599,140.2992 C44.5599,140.2992 44.7599,140.1002 44.7599,139.9002 C44.7599,139.9002 47.5599,113.2002 47.5599,95.2002 C47.5599,92.1002 47.4599,89.2002 47.2599,86.7992 C47.0599,84.4002 46.7599,82.4002 46.2599,81.0002 C46.2599,80.7002 45.9599,80.6002 45.7599,80.7002 C45.4599,80.7992 45.3599,81.1002 45.4599,81.2992 C45.8599,82.5002 46.1599,84.5002 46.3599,86.9002 C46.5599,89.2992 46.6599,92.1002 46.6599,95.2002 C46.6599,104.1002 45.9599,115.2992 45.2599,124.2002 C44.8599,128.7002 44.5599,132.6002 44.2599,135.2992 C43.9599,138.1002 43.8599,139.7002 43.8599,139.7002 L44.3599,139.7992 L44.3599,139.2992 L34.0599,139.2992 L34.0599,139.7992 L34.5599,139.7992 C34.5599,139.7992 34.4599,138.2992 34.2599,135.7002 C33.6599,127.9002 32.5599,110.7002 32.5599,97.4002 C32.5599,93.6002 32.6599,90.0002 32.8599,87.2002 C33.0599,84.2992 33.4599,82.1002 33.9599,80.9002 C34.0599,80.6002 33.9599,80.4002 33.6599,80.2002 C33.4599,80.0002 33.1599,80.1002 33.0599,80.4002"/>
					<path fill="#74DCFC" d="M32.16,121.7996 L25.46,130.7996 C25.36,130.9996 25.36,131.2996 25.46,131.4006 L33.66,140.1996 C33.86,140.4006 34.16,140.4006 34.36,140.1996 C34.56,139.9996 34.56,139.6996 34.36,139.4996 L26.36,130.9996 L32.76,122.4006 C32.96,122.1996 32.86,121.9006 32.66,121.6996 C32.46,121.4996 32.26,121.6006 32.16,121.7996"/>
					<g transform="translate(56 45.7)">
						<path fill="#FFF" d="M0.8597,11.7998 C1.0597,8.7998 2.4597,0.0998 3.8597,0.5998 C5.2597,1.0998 4.1597,5.3998 4.5597,6.8998 C5.3597,8.7998 5.2597,10.9998 4.4597,12.8998"/>
						<path stroke="#004F82" stroke-linecap="round" stroke-linejoin="round" d="M0.8597,11.7998 C1.0597,8.7998 2.4597,0.0998 3.8597,0.5998 C5.2597,1.0998 4.1597,5.3998 4.5597,6.8998 C5.3597,8.7998 5.2597,10.9998 4.4597,12.8998"/>
					</g>
					<path stroke="#004F82" stroke-linecap="round" stroke-linejoin="round" d="M60.8597,52.8001 C60.8597,52.8001 61.5597,51.3001 61.8597,51.6001 L61.0597,53.8001"/>
					<path fill="#74DCFC" d="M34.9598 87.4002L37.8598 92.7992C37.9598 93.0002 38.2598 93.1002 38.5598 93.0002 38.7598 92.9002 38.8598 92.6002 38.7598 92.2992L35.8598 86.9002C35.7598 86.7002 35.4598 86.6002 35.1598 86.7002 34.8598 86.7992 34.7598 87.1002 34.9598 87.4002M49.16 38.0999C47.76 39.2999 47.06 41.1999 46.66 43.0999 46.26 44.9999 46.06 46.8999 45.76 47.9999 45.46 49.3999 45.06 50.7999 45.06 51.9999 45.06 52.5999 45.16 53.1999 45.56 53.5999 45.96 54.0999 46.56 54.2999 47.26 54.3999 47.56 54.3999 47.76 54.1999 47.76 53.8999 47.76 53.5999 47.56 53.3999 47.26 53.3999 46.66 53.3999 46.46 53.1999 46.26 52.9999 46.06 52.7999 45.96 52.4999 45.96 51.9999 45.96 51.0999 46.36 49.6999 46.66 48.1999 46.86 46.9999 47.06 45.0999 47.46 43.2999 47.86 41.4999 48.56 39.6999 49.66 38.7999 49.86 38.5999 49.86 38.2999 49.76 38.0999 49.76 37.9999 49.46 37.8999 49.16 38.0999"/>
					<path fill="#FFF" d="M36.3597,52.4002 C33.6597,46.6002 36.5597,36.9002 42.8597,35.6002 C44.9597,35.2002 47.4597,36.2002 48.6597,36.6002"/>
					<path fill="#74DCFC" d="M36.8597,52.2 C36.2597,50.8 35.8597,49.2 35.8597,47.5 C35.8597,45 36.5597,42.3 37.7597,40.2 C38.9597,38.1 40.7597,36.6 42.9597,36.1 C43.2597,36 43.5597,36 43.9597,36 C45.6597,36 47.5597,36.7 48.5597,37.1 C48.8597,37.2 49.0597,37.1 49.1597,36.8 C49.2597,36.5 49.1597,36.3 48.8597,36.2 C47.8597,35.9 45.8597,35.1 43.9597,35.1 C43.5597,35.1 43.1597,35.1 42.7597,35.2 C40.2597,35.7 38.2597,37.5 36.9597,39.7 C35.6597,42 34.8597,44.8 34.8597,47.5 C34.8597,49.3 35.1597,51.1 35.8597,52.7 C35.9597,53 36.2597,53.1 36.5597,52.9 C36.8597,52.7 36.9597,52.5 36.8597,52.2"/>
					<path fill="#FFF" d="M41.2596,47.4002 C41.2596,50.1002 42.3596,52.4002 43.5596,52.9002"/>
					<path fill="#74DCFC" d="M40.7596,47.4002 C40.7596,48.8002 41.0596,50.1002 41.4596,51.2002 C41.9596,52.2002 42.5596,53.0002 43.3596,53.4002 C43.6596,53.5002 43.8596,53.4002 44.0596,53.1002 C44.1596,52.8002 44.0596,52.6002 43.7596,52.4002 C43.3596,52.2002 42.8596,51.6002 42.4596,50.7002 C42.0596,49.8002 41.8596,48.6002 41.8596,47.3002 C41.8596,47.0002 41.6596,46.8002 41.3596,46.8002 C41.0596,46.9002 40.7596,47.2002 40.7596,47.4002"/>
					<path fill="#FFF" d="M37.5599,46.9002 C35.7599,53.4002 36.9599,62.6002 43.8599,61.5002"/>
					<path fill="#74DCFC" d="M37.0599,46.7 C36.5599,48.5 36.2599,50.5 36.2599,52.4 C36.2599,54.8 36.6599,57.2 37.7599,59 C38.2599,59.9 38.9599,60.7 39.7599,61.2 C40.5599,61.7 41.6599,62 42.7599,62 C43.1599,62 43.5599,62 43.9599,61.9 C44.2599,61.9 44.4599,61.6 44.3599,61.3 C44.3599,61 44.0599,60.8 43.7599,60.9 C43.3599,61 43.0599,61 42.7599,61 C41.7599,61 40.9599,60.8 40.2599,60.3 C39.2599,59.7 38.4599,58.6 37.9599,57.2 C37.4599,55.8 37.2599,54.1 37.2599,52.4 C37.2599,50.6 37.5599,48.7 37.9599,47 C38.0599,46.7 37.8599,46.5 37.5599,46.4 C37.3599,46.3 37.1599,46.5 37.0599,46.7"/>
					<path fill="#FFF" d="M206.66,76.7 L207.559,86 C207.559,86 212.66,99.2 208.46,94.2 C214.059,100.8 220.66,92.6 220.86,84.9 C221.059,76.4 218.16,70.6 214.76,68.9 C212.96,68 210.26,68.8 208.86,70.2 C207.26,72 206.46,74.3 206.66,76.7"/>
					<path stroke="#00A9DE" stroke-linecap="round" stroke-linejoin="round" d="M206.66,76.7 L207.559,86 C207.559,86 212.66,99.2 208.46,94.2 C214.059,100.8 220.66,92.6 220.86,84.9 C221.059,76.4 218.16,70.6 214.76,68.9 C212.96,68 210.26,68.8 208.86,70.2 C207.26,72 206.46,74.3 206.66,76.7 Z"/>
					<path fill="#74DCFC" d="M211.2596,67.4002 C212.5596,66.5002 213.9596,65.9002 215.1596,65.9002 C215.8606,65.9002 216.5596,66.1002 217.0596,66.6002 C217.1596,66.7002 217.2596,67.0002 217.2596,67.4002 C217.2596,68.1002 216.8606,69.0002 216.0596,69.6002 C215.8606,69.7992 215.7596,70.1002 215.9596,70.2992 C216.1596,70.5002 216.4596,70.6002 216.6596,70.4002 C217.8606,69.6002 218.3606,68.4002 218.3606,67.4002 C218.3606,66.7992 218.1596,66.2992 217.8606,65.9002 C217.1596,65.2002 216.1596,64.9002 215.2596,64.9002 C213.7596,64.9002 212.2596,65.6002 210.8606,66.6002 C210.6596,66.7992 210.5596,67.1002 210.7596,67.2992 C210.6596,67.5002 211.0596,67.5002 211.2596,67.4002 M210.2596,68.5002 C209.7596,68.4002 209.2596,68.4002 208.5596,68.4002 C207.6596,68.4002 206.5596,68.5002 205.6596,68.7992 C205.1596,69.0002 204.7596,69.2002 204.4596,69.5002 C204.0596,69.7992 203.8606,70.2992 203.7596,70.7992 L203.7596,71.4002 C203.7596,72.4002 204.2596,73.4002 205.0596,74.1002 C205.2596,74.2992 205.5596,74.2002 205.7596,74.0002 C205.9596,73.7992 205.8606,73.5002 205.6596,73.2992 C205.0596,72.7992 204.7596,72.1002 204.7596,71.4002 L204.7596,71.0002 L204.2596,70.9002 L204.7596,71.0002 C204.8606,70.7002 204.9596,70.5002 205.1596,70.2002 C205.4596,69.9002 206.0596,69.6002 206.6596,69.5002 C207.2596,69.4002 207.9596,69.2992 208.6596,69.2992 C209.2596,69.2992 209.7596,69.2992 210.1596,69.4002 C210.4596,69.4002 210.6596,69.2002 210.7596,69.0002 C210.7596,68.7992 210.5596,68.6002 210.2596,68.5002 M212.3606,64.0002 C212.0596,63.9002 211.6596,63.9002 211.3606,63.9002 C210.3606,63.9002 209.5596,64.2002 208.8606,64.6002 C207.8606,65.2992 207.1596,66.2002 206.7596,67.0002 C206.3606,67.7992 206.1596,68.4002 206.1596,68.4002 C206.0596,68.7002 206.2596,68.9002 206.4596,69.0002 C206.7596,69.1002 206.9596,68.9002 207.0596,68.7002 C207.1596,68.5002 207.4596,67.5002 208.1596,66.6002 C208.8606,65.7002 209.8606,64.9002 211.3606,64.9002 C211.6596,64.9002 211.8606,64.9002 212.1596,65.0002 C212.4596,65.0002 212.6596,64.9002 212.7596,64.6002 C212.8606,64.3002 212.6596,64.0002 212.3606,64.0002"/>
					<path fill="#004F82" d="M223.16,106.7996 L216.86,139.4996 C216.86,139.6006 216.86,139.7996 216.96,139.9006 C217.059,139.9996 217.16,140.1006 217.26,140.1006 L227.66,141.2996 C227.86,141.2996 228.16,141.1996 228.16,140.9006 L238.059,102.2996 C238.16,101.9996 237.96,101.7996 237.66,101.6996 C237.36,101.6006 237.16,101.7996 237.059,102.1006 L227.26,140.2996 L217.86,139.1996 L224.059,106.9996 C224.16,106.6996 223.96,106.4996 223.66,106.4006 C223.46,106.2996 223.26,106.4996 223.16,106.7996 M243.26,95.9996 C243.16,96.4006 243.16,96.7996 243.16,97.1996 C243.16,99.6006 244.059,102.7996 245.26,106.1996 C249.059,116.4996 256.66,128.9996 256.66,128.9996 L257.059,128.6996 L256.66,128.4006 L249.96,138.1996 L250.36,138.4996 L250.76,138.1996 C250.76,138.1996 250.559,137.9006 250.16,137.4006 C248.96,135.6006 245.76,130.9006 242.66,125.9006 C239.559,120.9006 236.46,115.4996 235.36,112.1996 C235.26,111.9006 234.96,111.7996 234.76,111.9006 C234.559,111.9996 234.36,112.2996 234.46,112.4996 C235.76,116.4006 239.66,122.9006 243.16,128.4996 C246.66,134.1006 249.96,138.6996 249.96,138.6996 C250.059,138.7996 250.16,138.9006 250.36,138.9006 C250.559,138.9006 250.66,138.7996 250.76,138.6996 L257.46,128.9006 C257.559,128.6996 257.559,128.4996 257.46,128.4006 C257.46,128.4006 257.26,128.1006 256.86,127.4006 C255.559,125.1996 252.36,119.6006 249.46,113.4996 C248.059,110.4996 246.66,107.2996 245.66,104.4006 C244.66,101.4996 244.059,98.9006 244.059,96.9996 C244.059,96.6006 244.059,96.2996 244.16,95.9006 C244.16,95.6006 244.059,95.4006 243.76,95.2996 C243.559,95.4996 243.26,95.6996 243.26,95.9996"/>
					<path fill="#00A9DE" d="M231.4598,51.0999 C224.0598,54.8999 224.6598,66.3999 223.8598,71.5999 L221.7598,106.5999 L249.3598,105.4999 C249.3598,105.4999 250.1598,41.4999 231.4598,51.0999"/>
					<path fill="#74DCFC" d="M212.9598,112.1004 L228.0598,135.2004 C228.4598,135.9004 228.4598,136.7994 227.9598,137.4004 C227.0598,138.4994 225.9598,140.4004 227.1598,141.6004 C227.4598,141.9004 230.1598,139.6004 232.2598,137.7004 C233.6598,136.4994 233.9598,134.4994 233.1598,132.9004 L220.9598,107.9004 M206.7598,108.7994 L201.8598,135.9994 C201.7598,136.7994 201.0598,137.4004 200.2598,137.4994 C198.8598,137.7004 196.7598,138.2994 196.7598,139.9994 C196.7598,140.4004 200.3598,140.6004 203.1598,140.7004 C204.9598,140.7004 206.6598,139.6004 207.1598,137.7994 L215.4598,111.2004"/>
					<path fill="#004F84" d="M204.2596,53.2 L206.4596,59.8 C207.0596,61.5 208.7596,62.6 210.5596,62.3 L216.0596,61.4 C216.1596,61.5 213.1596,50.2 204.2596,53.2"/>
					<polygon fill="#FFF" points="207.559 86 201.959 125.5 233.959 121.601 220.759 84.9"/>
					<path fill="#00A9DE" d="M207.5594,85.9998 L207.0594,85.8998 L201.3604,125.3998 C201.3604,125.6008 201.3604,125.6998 201.4594,125.7998 C201.5594,125.8998 201.7594,125.9998 201.8604,125.8998 L233.8604,121.9998 C234.0594,121.9998 234.1604,121.8998 234.2594,121.7998 C234.3604,121.6998 234.3604,121.4998 234.2594,121.3998 L221.2594,84.6998 C221.1604,84.4998 220.9594,84.3998 220.7594,84.3998 L207.5594,85.4998 C207.3604,85.4998 207.1604,85.6998 207.0594,85.8998 L207.5594,85.9998 L207.5594,86.4998 L220.3604,85.3998 L233.1604,121.1998 L202.3604,124.8998 L207.9594,86.1008 L207.5594,85.9998 L207.5594,86.4998 L207.5594,85.9998 Z"/>
					<path fill="#74DCFC" d="M211.7596,71.4002 C208.4596,72.6002 211.3606,87.6002 211.3606,87.6002 L208.3606,100.9002 L209.4596,101.1002 C211.8606,101.6002 214.2596,100.2002 214.8606,97.9002 L217.4596,88.7992 C217.3606,88.9002 217.3606,69.2992 211.7596,71.4002"/>
					<path fill="#004F82" d="M227.3602,74.2 L229.3602,75.1 C229.5592,75.2 229.8602,75.1 230.0592,74.9 C230.1602,74.7 230.0592,74.4 229.8602,74.2 L227.8602,73.3 C227.6602,73.2 227.3602,73.3 227.1602,73.5 C226.9602,73.8 227.0592,74.1 227.3602,74.2 M228.9602,72.7 L232.5592,72.2 C232.8602,72.2 233.0592,71.9 232.9602,71.6 C232.9602,71.3 232.6602,71.1 232.3602,71.2 L228.7592,71.7 C228.4602,71.7 228.2592,72 228.3602,72.3 C228.3602,72.6 228.6602,72.8 228.9602,72.7 M229.9602,63.3 L229.9602,67.4 L229.9602,70.1 C229.9602,70.4 230.1602,70.6 230.4602,70.6 C230.7592,70.6 230.9602,70.4 230.9602,70.1 L230.9602,67.4 L230.9602,63.3 C230.9602,63 230.7592,62.8 230.4602,62.8 C230.1602,62.8 229.9602,63 229.9602,63.3 M237.4602,58.8 C238.1602,63.7 238.6602,67.1 238.6602,69.9 C238.6602,73.5 237.8602,76.1 235.3602,80 L235.7592,80.3 L235.3602,80 C233.4602,82.8 231.3602,85.4 229.0592,87.8 C228.8602,88 228.8602,88.3 229.0592,88.5 C229.2592,88.7 229.5592,88.7 229.7592,88.5 C232.0592,86 234.2592,83.4 236.1602,80.6 C238.7592,76.6 239.6602,73.7 239.6602,69.9 C239.6602,67 239.1602,63.6 238.4602,58.7 C238.4602,58.4 238.1602,58.2 237.8602,58.3 C237.6602,58.3 237.4602,58.6 237.4602,58.8"/>
					<path fill="#FFF" d="M223.8602,82.4002 L232.0592,92.2992 C232.2592,92.5002 232.5592,92.5002 232.7592,92.4002 C232.9602,92.2002 232.9602,91.9002 232.8602,91.7002 L224.6602,81.7992 C224.4602,81.6002 224.1602,81.6002 223.9602,81.7002 C223.6602,81.9002 223.6602,82.2002 223.8602,82.4002"/>
					<path fill="#004F82" d="M225.16,31.4998 C225.46,31.0998 225.96,30.6998 226.66,30.3998 C227.36,30.0998 228.26,29.9998 229.16,29.9998 C230.36,29.9998 231.559,30.1998 232.66,30.6998 C233.76,31.1998 234.66,31.7998 235.16,32.6998 C235.86,33.8998 236.16,35.2998 236.16,36.7998 C236.16,38.4998 235.76,40.1998 235.36,41.3998 C235.16,41.9998 234.96,42.4998 234.86,42.8998 C234.76,43.0998 234.76,43.1998 234.66,43.2998 C234.66,43.3998 234.559,43.3998 234.559,43.3998 C234.46,43.5998 234.559,43.8998 234.76,44.0998 C234.96,44.1998 235.26,44.0998 235.46,43.8998 C235.46,43.8998 237.16,40.4998 237.16,36.7998 C237.16,35.2998 236.86,33.5998 235.96,32.1998 C235.26,31.0998 234.16,30.2998 232.96,29.7998 C231.76,29.2998 230.36,28.9998 229.16,28.9998 C228.16,28.9998 227.16,29.1998 226.36,29.4998 C225.559,29.7998 224.86,30.2998 224.36,30.8998 C224.16,31.0998 224.26,31.3998 224.46,31.5998 C224.66,31.7998 224.96,31.6998 225.16,31.4998 M222.059,31.1998 C222.059,32.1998 222.559,32.9998 223.26,33.6998 C224.26,34.6998 225.559,35.3998 226.86,36.1998 C228.16,36.8998 229.26,37.5998 229.86,38.3998 C230.559,39.2998 230.96,40.3998 230.96,41.4998 C230.96,41.7998 230.96,42.1998 230.86,42.4998 C230.76,42.7998 230.96,42.9998 231.26,43.0998 C231.559,43.1998 231.76,42.9998 231.86,42.6998 C231.96,42.2998 231.96,41.8998 231.96,41.4998 C231.96,40.0998 231.46,38.7998 230.66,37.7998 L230.26,38.0998 L230.66,37.7998 C230.16,37.0998 229.46,36.5998 228.559,35.9998 C227.36,35.1998 225.96,34.5998 224.86,33.7998 C224.36,33.3998 223.86,32.9998 223.559,32.5998 C223.26,32.1998 223.059,31.6998 223.059,31.1998 C223.059,30.8998 222.86,30.6998 222.559,30.6998 C222.26,30.6998 222.059,30.9998 222.059,31.1998 M218.26,33.8998 L217.66,37.4998 C217.66,37.7998 217.76,37.9998 218.059,38.0998 C218.36,38.0998 218.559,37.9998 218.66,37.6998 L219.26,34.0998 C219.26,33.7998 219.16,33.5998 218.86,33.4998 C218.559,33.4998 218.36,33.6998 218.26,33.8998 M228.46,37.6998 L218.559,35.1998 C218.26,35.0998 218.059,35.2998 217.96,35.5998 C217.86,35.8998 218.059,36.0998 218.36,36.1998 L228.26,38.6998 C228.559,38.7998 228.76,38.5998 228.86,38.2998 C228.96,38.0998 228.76,37.7998 228.46,37.6998 M227.059,75.3998 L223.76,81.8998 C223.66,82.1008 223.76,82.3998 223.96,82.6008 C224.16,82.6998 224.46,82.6008 224.66,82.3998 L227.96,75.8998 C228.059,75.6998 227.96,75.3998 227.76,75.1998 C227.559,74.9998 227.26,75.1008 227.059,75.3998"/>
					<path fill="#00A9DE" d="M235.3602,45.2 L225.0592,48.5 C224.7592,48.6 224.6602,48.9 224.7592,49.1 L225.6602,52.3 C225.7592,52.6 225.9602,52.7 226.2592,52.6 C226.5592,52.5 226.6602,52.3 226.5592,52 L225.7592,49.3 L235.5592,46.1 C235.8602,46 235.9602,45.7 235.8602,45.5 C235.8602,45.3 235.5592,45.1 235.3602,45.2"/>
					<path fill="#004F82" d="M222.4598,41.3001 C222.2598,41.7001 221.9598,42.1001 221.4598,42.3001 C221.2598,42.4001 221.0598,42.7001 221.2598,43.0001 C221.3598,43.2001 221.6598,43.4001 221.9598,43.2001 C222.5598,42.9001 223.0598,42.4001 223.3598,41.7001 C223.4598,41.4001 223.3598,41.2001 223.1598,41.0001 C222.9598,40.9001 222.6598,41.0001 222.4598,41.3001"/>
					<path fill="#004F82" d="M221.7596,32.5999 C220.7596,33.3999 220.2596,34.6999 220.2596,35.9999 L220.7596,35.9999 L220.2596,35.9999 C220.2596,36.8999 219.9596,37.4999 219.5596,38.0999 C219.3606,38.3999 219.1596,38.5999 219.0596,38.8999 C218.8606,39.1999 218.7596,39.4999 218.7596,39.8999 L218.7596,40.0999 C218.7596,40.4999 219.0596,40.6999 219.2596,40.8999 C219.5596,41.1999 219.9596,41.2999 220.2596,41.3999 C220.3606,41.4999 220.4596,41.4999 220.5596,41.5999 L220.6596,41.6999 L221.1596,41.4999 L220.6596,41.6999 C221.1596,42.7999 221.6596,43.7999 222.4596,44.5999 C223.1596,45.2999 224.1596,45.7999 225.4596,45.7999 C225.7596,45.7999 226.0596,45.7999 226.3606,45.6999 L226.2596,45.1999 L225.7596,45.2999 L226.7596,48.6999 C226.8606,48.9999 227.1596,49.0999 227.3606,48.9999 C227.6596,48.8999 227.7596,48.5999 227.6596,48.3999 L226.6596,44.9999 C226.5596,44.7999 226.3606,44.5999 226.1596,44.5999 C225.8606,44.5999 225.6596,44.6999 225.4596,44.6999 C224.4596,44.6999 223.7596,44.3999 223.1596,43.7999 C222.5596,43.1999 222.0596,42.3999 221.6596,41.2999 C221.5596,40.9999 221.2596,40.7999 221.0596,40.6999 C220.7596,40.4999 220.3606,40.3999 220.1596,40.2999 C220.0596,40.1999 219.9596,40.1999 219.9596,40.1999 L219.9596,40.0999 L219.9596,39.9999 C219.9596,39.8999 219.9596,39.6999 220.1596,39.4999 C220.4596,38.8999 221.4596,37.8999 221.4596,36.0999 C221.4596,35.0999 221.8606,34.1999 222.6596,33.4999 C222.8606,33.2999 222.8606,32.9999 222.7596,32.7999 C222.3606,32.3999 222.0596,32.3999 221.7596,32.5999"/>
					<path fill="#004F84" d="M214.0594,51.4998 C215.0594,51.4998 215.8604,52.2998 215.8604,53.2998 C215.8604,54.2998 215.0594,55.0998 214.0594,55.0998 L212.2594,55.0998 L212.2594,53.2998 C212.2594,52.2998 213.0594,51.4998 214.0594,51.4998"/>
					<path fill="#FFF" d="M204.4598,53.7 C203.3598,54.1 202.5598,55.2 202.5598,56.4 C202.2598,58.5 200.5598,59 200.5598,60.1 C200.5598,60.9 201.9598,61 202.1598,61.8 C202.6598,64.4 205.0598,66.3 207.6598,66.3"/>
					<path fill="#004F82" d="M204.3602,53.2 C203.0592,53.7 202.1602,54.9 202.1602,56.3 L202.6602,56.3 L202.1602,56.2 C202.0592,57.1 201.6602,57.7 201.1602,58.2 C200.9602,58.5 200.6602,58.7 200.4602,59 C200.2592,59.3 200.0592,59.6 200.0592,60 C200.0592,60.4 200.2592,60.7 200.4602,60.9 C200.7592,61.2 201.0592,61.3 201.3602,61.5 C201.4602,61.6 201.5592,61.6 201.6602,61.7 L201.7592,61.8 L202.2592,61.7 L201.7592,61.8 C202.3602,64.7 204.8602,66.7 207.7592,66.7 C208.0592,66.7 208.2592,66.5 208.2592,66.2 C208.2592,65.9 208.0592,65.7 207.7592,65.7 C205.3602,65.7 203.1602,64 202.6602,61.6 C202.5592,61.3 202.3602,61 202.1602,60.9 C201.8602,60.7 201.5592,60.5 201.3602,60.4 C201.2592,60.3 201.1602,60.3 201.1602,60.2 L201.1602,60.1 C201.1602,60 201.1602,59.8 201.3602,59.7 C201.7592,59.1 202.9602,58.3 203.1602,56.5 C203.1602,55.5 203.8602,54.6 204.7592,54.3 C205.0592,54.2 205.1602,53.9 205.0592,53.7 C204.8602,53.3 204.5592,53.1 204.3602,53.2"/>
					<path fill="#004F82" d="M204.16,62.8001 C203.86,63.0001 203.559,63.1001 203.16,63.1001 C202.86,63.1001 202.66,63.4001 202.66,63.7001 C202.66,64.0001 202.96,64.2001 203.26,64.2001 C203.86,64.2001 204.36,64.0001 204.86,63.6001 C205.059,63.4001 205.16,63.1001 204.96,62.8001 C204.76,62.7001 204.46,62.7001 204.16,62.8001"/>
					<path fill="#004F84" d="M204.2596,53.2 C203.4596,54.5 202.5596,56.4 202.5596,56.4 L206.6596,56.9 L206.4596,54.5 L204.2596,53.2"/>
					<path fill="#004F82" d="M203.9598,60.0999 C204.1598,60.0999 204.3598,59.8999 204.3598,59.6999 L204.3598,58.9999 C204.3598,58.7999 204.1598,58.5999 203.9598,58.5999 C203.7598,58.5999 203.5598,58.7999 203.5598,58.9999 L203.5598,59.6999 C203.5598,59.8999 203.7598,60.0999 203.9598,60.0999"/>
					<path fill="#FFF" d="M76.16,8.3001 C77.32,8.3001 78.26,9.2401 78.26,10.4001 C78.26,11.5601 77.32,12.5001 76.16,12.5001 C75,12.5001 74.06,11.5601 74.06,10.4001 C74.06,9.2401 75,8.3001 76.16,8.3001"/>
					<path fill="#C2F4FF" d="M86.9598 8.3001C88.1198 8.3001 89.0598 9.2401 89.0598 10.4001 89.0598 11.5601 88.1198 12.5001 86.9598 12.5001 85.7998 12.5001 84.8598 11.5601 84.8598 10.4001 84.8598 9.2401 85.7998 8.3001 86.9598 8.3001M97.66 8.3001C98.82 8.3001 99.76 9.2401 99.76 10.4001 99.76 11.5601 98.82 12.5001 97.66 12.5001 96.5 12.5001 95.56 11.5601 95.56 10.4001 95.56 9.2401 96.5 8.3001 97.66 8.3001"/>
					<mask id="stats--b" fill="#fff">
						<polygon id="stats--a" points="0 142.7 270.26 142.7 270.26 0 0 0"/>
					</mask>
					<polygon fill="#C2F4FF" points="74.16 108.3 138.66 108.3 138.66 28.901 74.16 28.901" mask="url(#stats--b)"/>
					<polygon fill="#C2F4FF" points="150.059 62.7 185.259 62.7 185.259 28.9 150.059 28.9" mask="url(#stats--b)"/>
					<polygon fill="#74DCFC" points="150.059 90.799 185.259 90.799 185.259 73.1 150.059 73.1" mask="url(#stats--b)"/>
					<path fill="#74DCFC" d="M107.9598,81.4002 L89.4598,81.4002 C89.4598,91.5002 97.8598,99.9002 107.9598,99.9002 C118.0598,99.9002 126.4598,91.5002 126.4598,81.4002 C126.4598,71.2992 118.0598,62.9002 107.9598,62.9002 L107.5598,62.9002 L107.9598,81.4002 Z" mask="url(#stats--b)"/>
					<path fill="#C8D7E2" d="M102.66,76.7996 L102.66,58.2996 C92.56,58.2996 84.16,66.6996 84.16,76.7996 L102.66,76.7996 Z" mask="url(#stats--b)"/>
					<path fill="#FFF" d="M166.0594 56.9002L157.4594 56.9002 157.4594 48.8002C157.4594 48.5002 157.7594 48.3002 158.1604 48.3002L166.0594 48.3002 166.0594 56.9002zM178.5594 56.9002L169.9594 56.9002 169.9594 40.0002C169.9594 39.9002 170.0594 39.8002 170.1604 39.8002L178.5594 39.8002 178.5594 56.9002z" mask="url(#stats--b)"/>
					<path fill="#74DCFC" d="M83.0599,46.0999 L83.0599,37.4999 L127.5599,37.4999 C128.1599,37.4999 128.6599,37.9999 128.6599,38.5999 L128.6599,46.0999 L83.0599,46.0999 Z" mask="url(#stats--b)"/>
				</svg>

				<p>
					{ __( 'Hello there! Your stats have been activated.' ) }
					<br />
					{ __( 'Just give us a little time to collect data so we can display it for you here.' ) }
				</p>
				<Button
					onClick={ dismissCard }
					primary={ true }
				>
					{ __( 'Okay, got it!' ) }
				</Button>
			</Card>
		);
	}

	renderStatsArea() {
		const activateStats = () => this.props.updateOptions( { stats: true } );

		if ( this.props.getOptionValue( 'stats' ) ) {
			const statsErrors = this.statsErrors();
			if ( statsErrors ) {
				return (
					<div className="jp-at-a-glance__stats-inactive">
						<span>
							{
								__( 'Something happened while loading stats. Please try again later or {{a}}view your stats now on WordPress.com{{/a}}', {
									components: {
										a: <a href={ 'https://wordpress.com/stats/insights/' + this.props.siteRawUrl } />
									}
								} )
							}
						</span>
					</div>
				);
			}

			const statsChart = this.statsChart( this.props.activeTab() ),
				chartData = statsChart.chartData,
				totalViews = statsChart.totalViews,
				showEmptyStats = chartData.length > 0 && totalViews <= 0 && ! this.props.isEmptyStatsCardDismissed && ! this.state.emptyStatsDismissed;

			return (
				<div className="jp-at-a-glance__stats-container">
					{ ! showEmptyStats ? this.renderStatsChart( chartData ) : this.renderEmptyStatsCard() }
				</div>
			);
		}

		return (
			<div className="jp-at-a-glance__stats-inactive">
				<div className="jp-at-a-glance__stats-inactive-icon">
					<img src={ imagePath + 'stats.svg' } width="60" height="60" alt={ __( 'Jetpack Stats Icon' ) } className="jp-at-a-glance__stats-icon" />
				</div>
				<div className="jp-at-a-glance__stats-inactive-text">
					{
						this.props.isDevMode ? __( 'Unavailable in Dev Mode' )
							: __( '{{a}}Activate Site Stats{{/a}} to see detailed stats, likes, followers, subscribers, and more! {{a1}}Learn More{{/a1}}', {
								components: {
									a: <a href="javascript:void(0)" onClick={ activateStats } />,
									a1: <a href="https://jetpack.com/support/wordpress-com-stats/" target="_blank" rel="noopener noreferrer" />
								}
							} )
					}
				</div>
				{
					this.props.isDevMode ? '' : (
						<div className="jp-at-a-glance__stats-inactive-button">
							<Button
								onClick={ activateStats }
								primary={ true }
							>
								{ __( 'Activate Site Stats' ) }
							</Button>
						</div>
					)
				}
			</div>
		);
	}

	maybeShowStatsTabs() {
		const switchToDay = () => {
				analytics.tracks.recordJetpackClick( { target: 'stats_switch_view', view: 'day' } );
				this.props.switchView( 'day' );
				this.props.fetchStatsData( 'day' );
			},
			switchToWeek = () => {
				analytics.tracks.recordJetpackClick( { target: 'stats_switch_view', view: 'week' } );
				this.props.switchView( 'week' );
				this.props.fetchStatsData( 'week' );
			},
			switchToMonth = () => {
				analytics.tracks.recordJetpackClick( { target: 'stats_switch_view', view: 'month' } );
				this.props.switchView( 'month' );
				this.props.fetchStatsData( 'month' );
			};

		if ( this.props.getOptionValue( 'stats' ) && ! this.statsErrors() ) {
			return (
				<ul className="jp-at-a-glance__stats-views">
					<li tabIndex="0" className="jp-at-a-glance__stats-view">
						<a href="javascript:void(0)" onClick={ switchToDay }
							className={ this.getClass( 'day' ) }
						>{ __( 'Days' ) }</a>
					</li>
					<li tabIndex="0" className="jp-at-a-glance__stats-view">
						<a href="javascript:void(0)" onClick={ switchToWeek }
							className={ this.getClass( 'week' ) }
						>{ __( 'Weeks' ) }</a>
					</li>
					<li tabIndex="0" className="jp-at-a-glance__stats-view">
						<a href="javascript:void(0)" onClick={ switchToMonth }
							className={ this.getClass( 'month' ) }
						>{ __( 'Months' ) }</a>
					</li>
				</ul>
			);
		}
	}

	getClass( view ) {
		return this.props.activeTab() === view
			? 'jp-at-a-glance__stats-view-link is-current'
			: 'jp-at-a-glance__stats-view-link';
	}

	render() {
		const moduleList = Object.keys( this.props.moduleList );
		if ( ! includes( moduleList, 'stats' ) ) {
			return null;
		}

		const range = this.props.activeTab();
		return (
			<div>
				<QueryStatsData range={ range } />
				<DashSectionHeader label={ __( 'Site Stats' ) }>
					{ this.maybeShowStatsTabs() }
				</DashSectionHeader>
				<Card className={ 'jp-at-a-glance__stats-card ' + ( this.props.isDevMode ? 'is-inactive' : '' ) }>
					{ this.renderStatsArea() }
				</Card>
			</div>
		);
	}
}

DashStats.propTypes = {
	isDevMode: React.PropTypes.bool.isRequired,
	siteRawUrl: React.PropTypes.string.isRequired,
	siteAdminUrl: React.PropTypes.string.isRequired,
	statsData: React.PropTypes.any.isRequired
};

export default connect(
	( state ) => {
		return {
			moduleList: getModules( state ),
			activeTab: () => _getActiveStatsTab( state ),
			isDevMode: isDevMode( state ),
			isLinked: isCurrentUserLinked( state ),
			connectUrl: getConnectUrl( state ),
			statsData: getStatsData( state ) !== 'N/A' ? getStatsData( state ) : getInitialStateStatsData( state ),
			isEmptyStatsCardDismissed: emptyStatsCardDismissed( state ),
		};
	},
	( dispatch ) => {
		return {
			switchView: ( tab ) => {
				return dispatch( statsSwitchTab( tab ) );
			},
			fetchStatsData: ( range ) => {
				return dispatch( fetchStatsData( range ) );
			}
		};
	}
)( DashStats );
