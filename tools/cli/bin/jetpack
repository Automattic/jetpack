#!/usr/bin/env node

try {
	// eslint-disable-next-line no-global-assign
	require = require( 'esm' )( module /*, options*/ );
	const child_process = require( 'child_process' );
	child_process.execSync( 'jetpack-clicheck202012', { stdio: 'ignore' } );
	require( '../cli' ).cli();
} catch ( error ) {
	if ( error.code === "MODULE_NOT_FOUND" ) { // if yarn install hasn't been run, esm require will fail here.
		console.log( 'Something is missing from your install. Please run `yarn cli-init` and try again.' );
	} if ( error.status === 127 ) { // If the execSync command failes above, this is the result.
		console.log( 'A command has been added since the last time you initiated. Please run `yarn cli-init` and try again.' );
	} else {
		console.log( error );
		console.log( 'Something unexpected happened. See error above.' );
	}
	process.exit( 1 );
}
